(()=>{"use strict";var __webpack_modules__={396155:(e,t,s)=>{s.d(t,{Feed:()=>de});var o=s(659397),i=s(800921),n=s(977053),r=s(954314),a=s(15042),c=s(7278),l=s(430503),d=s(349776),u=s(45398),_=s(471828),h=s(379440),f=s(330),p=s(740685),g=s(30655),w=s(251087),m=s(994676),b=s(93367),v=s(255693),k=s(70689),y=s(907860),S=s(449147),C=s(488844),P=s(159663),E=s(585703),T=s(762003),L=s(636322),B=s(588386),x=s(585688),V=s(994850),F=s(869143),M=s(226059),R=s(902947),j=s(984457),I=s(666565),A=s(150265),H=s(447836),N=s(447785),O=s(646096),q=s(640009),D=s(656334),W=s(399565),U=s(349623),G=s(471474),z=s(398322),Y=s(969412),Q=s(193805),K=s(649809),$=s(19946),X=s(93538),J=s(184132),Z=s(618418),ee=s(199777),te=s(78839),se=s(521471),oe=s(414224),ie=s(105047),ne=s(105940),re=s(516411),ae=s(879692),ce=s(98962),le=s(374617);const de={sectionUpdateExceptions:["search","notifications","photos_search","mentions","articles","articles_search","likes","recommended","live","topics"],viewStats:(0,oe.feedViewStatsFactory)(),blockHideReason:function e(t,s){if(e.progress)return!1;e.progress=!0;let o="block_"+t,i=(0,k.ge)(o);delete cur.feedEntriesHTML[o],ajax.post("al_feed.php",{act:"a_block_hide_reason",block_id:t,reason:0|s,hash:(0,k.attr)(i,"data-hash"),ref:de.getModuleRef(),pos:(0,k.attr)(i,"data-pos")},{onDone:function(t){e.progress=!1,t?(0,k.val)(i,t):(0,k.hide)(i)},hideProgress:function(){e.progress=!1}})},blockRestore:function(e){let t="block_"+e,s=(0,k.ge)(t);cur.feedEntriesHTML[t]&&(0,k.val)(t,cur.feedEntriesHTML[t]),ajax.post("al_feed.php",{act:"a_block_restore",block_id:e,hash:(0,k.attr)(s,"data-hash"),ref:de.getModuleRef(),pos:(0,k.attr)(s,"data-pos")})},blockHide:function(e,t){if((0,C.actionsMenuItemLocked)(t))return;(0,C.lockActionsMenuItem)(t);let s="block_"+e,o=(0,k.ge)(s),i=(0,k.geByClass1)("ui_actions_menu_wrap",o);ajax.post("al_feed.php",{act:"a_block_hide",block_id:e,hash:(0,k.attr)(o,"data-hash"),ref:de.getModuleRef(),pos:(0,k.attr)(o,"data-pos")},{onDone:function(e){uiActionsMenu.toggle(i,!1),cur.feedEntriesHTML[s]=(0,k.val)(o),(0,k.val)(o,e)},hideProgress:C.unlockActionsMenuItem.pbind(t)})},videoRecomsBlockHideCancel:function(){ajax.post("/al_feed.php",{act:"a_video_recom_hide_cancel"}),de.restorePost("video_recoms")},videoRecomsBlockHideReason:function(e,t){(0,k.re)((0,k.geByClass1)("feed_rb_video_reason_wrap")),(0,k.show)((0,k.geByClass1)("feed_rb_video_reason_thankyou")),ajax.post("/al_feed.php",{act:"a_video_recom_hide_reason",reason:t,reason_hash:e})},expandVideosPost:function(e,t){let s=(0,k.geByClass1)("page_post_sized_thumbs",(0,k.domPN)(t)),o=0;(0,L.each)(s.children,(function(){if(!(0,k.isVisible)(this)&&((0,k.show)(this),o++,o>5))return!1})),(0,k.toggle)(t,!(0,k.isVisible)(s.children[s.children.length-1]))},update:function(e){if(cur.feedUpdateLoading)return;if(window.Notifier&&cur.add_queues&&cur.add_queues.length&&(cur.add_queues.forEach((function(e){Notifier.addKey(e,de.updated)})),"news"!=cur.section))return;if("feed"!==cur.module||"top"==cur.subsection||(0,L.inArray)(cur.section,de.sectionUpdateExceptions)||cur.isDisabledFeedAutoupdate)return;let t=Math.random();if("news"!=cur.section&&"comments"!=cur.section&&t>.3||"news"==cur.section&&(e||t>.05))return;cur.feedUpdateLoading=!0;let s=de.getSectionParams(cur.section);(0,L.extend)(s,cur.navParams),ajax.post("al_feed.php?au_"+cur.section,(0,L.extend)(s,{timestamp:cur.timestamp,posted:e?1:"",queue:cur.add_feed_queue?1:0}),{onDone:function(t,s,o){if(cur.feedUpdateLoading=!1,1==e&&(!s||-1==s.indexOf(vk.id+"")))return void setTimeout(de.update.pbind(2),2e3);if("feed"!==cur.module||t.section!=cur.section||t.timestamp<cur.timestamp||o<cur.timestamp)return;(0,T.statlogsValueEvent)("feed_check_update",!!s),t.count+=cur.count;let i,n,r,a,c=cur.rowsCont,l=(0,k.ce)("div"),d=0;if("news"==cur.section){if(a=(0,v.scrollGetY)(),s){for(l.innerHTML=s;l.lastChild;)i=l.lastChild,c.insertBefore(i,c.firstChild),de.onPostLoaded(i,!0);(0,L.each)((0,k.geByClass)("ts"+o,c),(function(e,t){d+=this.offsetHeight;const s=t?.querySelector?.(".post");s&&(0,I.highlightUpdatedPost)(s),cur.feedUnreadCount++}))}d&&a>100&&(0,v.scrollToY)(a+d,0,!1,!0)}else if(s)for(l.innerHTML=s;i=l.lastChild;)if("DIV"==i.tagName)if("podcasts_recommended_block"!==i.id)if(r=i.firstChild.id.substr(4),r&&cur.wallLayer==r)l.removeChild(i);else if(n=(0,k.ge)("post"+r)){if(!(0,k.hasClass)(n.parentNode,"feed_row"))return;const e=(0,k.ge)("replies"+r);let t=e.nextSibling,s=0;if((0,L.each)([].slice.call((0,k.geByClass)("reply",i,"div")),(function(){(0,k.ge)(this.id)||((0,k.addClass)(this,"new_reply"),e.appendChild(this),s++)})),s){let o=n.parentNode.offsetHeight,i=(0,k.geByClass)("new_reply",e,"div").length;t&&"replies_open"==t.className||(t=(0,k.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(r),role:"button",tabIndex:0}),e.parentNode.insertBefore(t,e.nextSibling)),t.innerHTML=_.getLang("wall_x_new_replies_more",Math.min(100,i)),t.newCnt=i;let a=(0,v.scrollGetY)(),l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,d=(0,k.getXY)(t)[1],u=n.parentNode.offsetHeight;o=u-o,(0,L.inArray)(r,cur.feedUnread)||cur.feedUnread.unshift(r),!cur.idleManager.isIdle&&d>a+100&&d<a+l+100?(c.insertBefore((0,k.ge)("post_ph"+r)||(0,k.ce)("div",{id:"post_ph"+r}),c.firstChild),(0,L.inArray)(r,cur.feedToSort)||cur.feedToSort.push(r)):((0,k.re)(n.parentNode),c.insertBefore(n.parentNode,c.firstChild),d>a+l+100&&(o=u),o&&(0,v.scrollToY)((0,v.scrollGetY)()+o,0,!1,!0)),cur.feedUnreadCount+=s}l.removeChild(i)}else a=(0,v.scrollGetY)(),c.insertBefore(i,c.firstChild),de.onPostLoaded(i,!0),d=i.offsetHeight,a>100&&(0,v.scrollToY)(a+d,0,!1,!0);else l.removeChild(i);else l.removeChild(i);de.applyOptions(t),de.updateTitle()},onFail:function(){return cur.feedUpdateLoading=!1,!1},showProgress:function(){cur.feedUpdateLoading=!0},hideProgress:function(){cur.feedUpdateLoading=!1}})},getNewQKey:function(e){let t={act:"a_get_key",only_update:cur.add_feed_queue?1:0,need_ignore:(0,R.isArray)(cur.ignore_owners)?0:1},s={onDone:function(s,i,n){if(cur.section!=o)return;if(cur.add_feed_queue=n,s)cur.add_queues=s,setTimeout(de.update.pbind(0),0);else if(!t.only_update){let t=i;return void(cur.timestamp=(t||(0,R.vkNow)()/1e3)-e)}(0,R.isArray)(i)&&(cur.ignore_owners=i)},local:1},o=cur.section;ajax.post("al_feed.php",{...de.getSectionParams(cur.section),...t,queue:1},s)},updated:function(e,t){cur.queueTO=cur.queueTO||(0,R.irand)(0,5e3),setTimeout(de.handleQueueEvent.pbind(e,t),cur.queueTO)},handleQueueEvent:function(e,t){if("search"!=cur.section&&"news"!=cur.section&&cur.section||!(0,R.isArray)(cur.add_queues))return;const s=cur.add_queues.find((t=>(0,B.subscriptionObjectStableId)(t)===e));if(!s)return;if(t.failed){cur.add_queues=!1,cur.add_feed_queue=null;let e=curNotifier.error_timeout||1;return clearTimeout(cur.lp_error_to),void(cur.lp_error_to=setTimeout(de.getNewQKey.bind(de).pbind(e),1e3*e))}if(!(0,R.isArray)(t.events)||!t.events.length)return;s.ts=t.ts,t.key&&(s.key=t.key);let o=(0,v.scrollGetY)(),i=0;(0,L.each)(t.events,(function(){if((0,R.isObject)(this))return Wall.processQueueEvent(this);i+=de.pushEvent(this.split("<!>"),o+(0,k.getSize)("page_header_cont")[1])}));let n=(0,v.scrollGetY)();i&&Math.abs(o-n)<100&&(cur.leftMenuDelta=i,(0,v.scrollToY)(n+i,0,!1,!0)),de.updateTitle(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()},needScrollPost:function(e,t){return e+80>(0,k.getXY)(t)[1]||cur.storyLayer||window.mvcur&&mvcur.mvShown||window.pvcur&&cur.pvShown},pushEvent:function(e,t){let s=e[0],o=e[1],i=e[2],n=(0,k.ge)("post"+i),a=cur.section,c="search"!=a?(0,L.intval)(e.pop()):0,l=0,d=function(e){return(0,L.intval)((0,k.getStyle)((0,k.domByClass)(e,"page_block"),"marginTop"))||(0,L.intval)((0,k.getStyle)((0,k.domByClass)((0,k.domNS)(e),"page_block"),"marginTop"))||15};if(!cur.options||s!=cur.options.qversion)return 0;switch((Wall.isArchiveWall()?"archive_post"===o:"reveal_post"===o)&&(o="res_post"),(Wall.isArchiveWall()?"reveal_post"===o:"archive_post"===o)&&(o="del_post"),o){case"new_post":{if(n)break;let s=Q.GroupAdminLevel.USER;if((0,L.intval)(e[11])&&(0,L.intval)(e[11])!=vk.id)return ajax.post("al_feed.php",{act:"a_need_own_reply",oid:(0,L.intval)(e[11])},{onDone:function(s){s&&(e[11]=0,de.pushEvent(e,t))}}),0;if("search"!=a){let t=i.split("_")[0];e[8]=(0,L.intval)(e[8])>0&&4==(4&c)?"1":"0",J.Ranges.isGroupId(t)&&(s=8&c?Q.GroupAdminLevel.EDITOR:2&c?Q.GroupAdminLevel.MODERATOR:Q.GroupAdminLevel.USER)}"search"==a&&(0,T.statlogsValueEvent)("feed_switch",0,"search_update",cur.options.q&&"#"==cur.options.q.charAt(0)?"hashtag":"");let o=cur.rowsCont,u=o.childNodes,h=Wall.getNewPostHTML(e,s,de.feedPostRepl);if(!h)break;let f,p,g,w,m,b,v=e[12],y="search"!=a&&(window._wf<=0||(0,k.hasClass)(cur.feedEls.wrap,"feed_has_new")||de.needScrollPost(t,o)),S=cur.storyLayer;S&&(y=!0);let C=!1,P=h;if(y&&(h=Wall.updatePostImages(h)),v){if(cur.ignore_owners.length&&(0,L.inArray)((0,L.intval)(v),cur.ignore_owners))break;if(p=(0,k.geByClass1)("feed_reposts_wrap"+v,o,"div"))g=(0,k.geByClass1)("feed_reposts_first",p,"div").firstChild,w=(0,k.geByClass1)("feed_reposts_group",p,"div"),m=(0,k.geByClass1)("feed_reposts_more_link",p),de.needScrollPost(t,g)&&(l-=g.offsetHeight+d(g)),g.parentNode.replaceChild(f=(0,k.se)(P),g),w.insertBefore(g,w.firstChild),(0,k.isVisible)(w)||M.FlatButton.setLabel(m,_.getLang("news_show_X_reposts",w.childNodes.length)),p=p.parentNode,o.firstChild!=p&&o.insertBefore(p,o.firstChild),de.needScrollPost(t,p)&&(l+=p.offsetHeight+d(p)),p.bits=0;else if((b=(0,k.geByClass)("feed_repost"+v,o,"div"))&&b.length){h=(0,k.rs)(cur.wallTpl.grouped_posts,{place:v,random:(0,R.irand)(1e8,2e8),first:h,other:"",label:_.getLang("news_show_X_reposts",b.length)});let e=(0,k.se)('<div class="feed_row'+(y?"_unshown":"")+'">'+h+"</div>");o.insertBefore(e,o.firstChild),!y&&de.needScrollPost(t,e)&&(l+=e.offsetHeight+d(e)),C=!0,p=e.firstChild,f=(0,k.geByClass1)("feed_reposts_first",p,"div"),w=(0,k.geByClass1)("feed_reposts_group",p,"div"),(0,L.each)((0,L.clone)(b),(function(){de.needScrollPost(t,this)&&(l-=this.offsetHeight+d(this)),(0,k.re)(this.parentNode),w.appendChild(this.firstChild)}))}else f=(0,k.se)('<div class="feed_row'+(y?"_unshown":"")+'"><div class="feed_repost'+v+'">'+h+"</div></div>"),o.insertBefore(f,o.firstChild),C=!0,!y&&de.needScrollPost(t,f)&&(l+=f.offsetHeight+d(f))}else f=(0,k.se)('<div class="feed_row'+(y?"_unshown":"")+'">'+h+"</div>"),o.insertBefore(f,o.firstChild),C=!0,!y&&de.needScrollPost(t,f)&&(l+=f.offsetHeight+d(f));const E=(0,k.geByClass1)("post",f);0==e[8]&&(0,k.addClass)(E,"closed_comments"),cur.deepRepliesActive&&(0,k.addClass)(E,"deep_active"),y&&C&&(cur.newPostsCount=cur.newPostsCount?cur.newPostsCount+1:1,cur.feedEls.newPosts.innerHTML=_.getLang("news_new_posts",cur.newPostsCount),(0,k.addClass)(cur.feedEls.wrap,"feed_has_new"),1==cur.newPostsCount&&de.needScrollPost(t,cur.feedEls.newPosts)&&!S&&(l+=(0,k.getSize)(cur.feedEls.newPosts)[1])),r.AudioUtils.updateQueueReceivedPost(f),(0,W.updateNarrativeSnippetsFromQueueByPost)(f),(0,U.updateArticleSnippetsFromQueueByPost)(f),cur.feedUnreadCount++,"search"!=a&&E&&(0,I.highlightUpdatedPost)(E),u.length>300?o.removeChild(u[300]):u.length<=1&&(0,k.removeClass)(cur.feedEls.wrap,"feed_is_empty"),Wall.updateMentionsIndex();break}case"new_post_reply":{if(n)break;const s=cur.rowsCont,o=s.childNodes,i=Wall.getNewPostHTML(e,!1,de.feedPostRepl);if(!i)break;const r=(0,k.se)('<div class="feed_row">'+i+"</div>");s.insertBefore(r,s.firstChild),de.needScrollPost(t,r)&&(l+=r.offsetHeight+d(r)),(0,W.updateNarrativeSnippetsFromQueueByPost)(r),(0,U.updateArticleSnippetsFromQueueByPost)(r),(0,Y.updateStickersFromQueue)(r),cur.feedUnreadCount++,o.length>300?s.removeChild(o[300]):o.length<=1&&(0,k.removeClass)(cur.feedEls.wrap,"feed_is_empty");break}case"edit_post":{const s=(0,k.ge)("wpt"+i);let o;if(!(0,k.isVisible)(n)||!s)break;let r=(0,k.geByClass1)("wall_post_more",s);r&&(r=(0,k.isVisible)((0,k.domNS)(r))),(o=de.needScrollPost(t,s))&&(l-=s.offsetHeight);let a=(0,k.rs)(e[3],{poll_hash:cur.wallTpl.poll_hash});const c=(0,k.ge)("post"+i);c&&!(0,k.isVisible)(c.parentNode)&&(a=Wall.updatePostImages(a)),(0,k.val)(s,a),r&&(r=(0,k.geByClass1)("wall_post_more",s),r&&r.onclick()),o&&(l+=s.offsetHeight),(0,W.updateNarrativeSnippetsFromQueueByPost)(s),(0,U.updateArticleSnippetsFromQueueByPost)(s),(0,I.highlightUpdatedPostContent)(s),window.Wall&&Wall.updatePostAuthorData(i);break}case"edit_reply":{let t=e[3];const s=(0,k.ge)("wpt"+t);if(!(0,k.isVisible)("post"+t)||!s)break;let o=(0,k.geByClass1)("wall_reply_more",s);o&&(o=(0,k.isVisible)((0,k.domNS)(o)));let i=e[4];(0,k.val)(s,i),o&&(o=(0,k.geByClass1)("wall_reply_more",s),o&&o.onclick()),(0,W.updateNarrativeSnippetsFromQueueByPost)(s),(0,U.updateArticleSnippetsFromQueueByPost)(s),(0,Y.updateStickersFromQueue)(s),(0,A.highlightUpdatedReplyContent)(s);break}case"post_parsed_link":{if(!n)break;let t=(0,k.geByClass1)("wall_postlink_preview_btn_disabled",n);if(!t)break;let s=e[3];if("1"===s)(0,k.removeClass)(t,"wall_postlink_preview_btn_disabled");else if("0"===s)(0,k.re)(t);else if(s){(0,k.removeClass)(t,"wall_postlink_preview_btn_disabled");let s=(0,k.geByClass1)("flat_button",t);s&&(s.setAttribute("href",e[3]),s.removeAttribute("onclick"))}break}case"del_post":if(n){let e=(0,k.domClosest)("feed_row",n)||(0,k.domClosest)("feed_row_unshown",n)||n;cur.wallMyDeleted[i]||(de.needScrollPost(t,n)&&(l-=n.offsetHeight+d(n)),(0,u.revertLastInlineVideo)(n),(0,k.re)(e)),cur.options.offset--,(0,k.hasClass)(cur.feedEls.wrap,"feed_has_new")&&!(0,k.isVisible)(e)&&(cur.newPostsCount--,cur.newPostsCount?cur.feedEls.newPosts.innerHTML=_.getLang("news_new_posts",cur.newPostsCount):(0,k.removeClass)(cur.feedEls.wrap,"feed_has_new"))}break;case"res_post":n&&cur.options.offset++;break;case"new_reply":{if(!n||cur.wallMyReplied[i]||(0,k.ge)("post"+e[3]))break;if((0,k.hasClass)((0,k.ge)("post"+i),"deep_active")){const t=Wall.addNewReply(e);l+=t[0];break}let s=(0,k.ge)("replies"+i),o=(0,k.ge)("replies_wrap"+i),r=n.offsetHeight;const a=i.split("_")[0],d=J.Ranges.isGroupId(a)?8&c?Q.GroupAdminLevel.EDITOR:2&c?Q.GroupAdminLevel.MODERATOR:Q.GroupAdminLevel.USER:Q.GroupAdminLevel.USER;let u=Wall.getNewReplyHTML(e,d);if(!u)break;let h,f=!1,p=!1;if((0,k.isVisible)(s)&&(0,k.isVisible)(o)&&!(0,k.isVisible)("reply_link"+i)){h=s.nextSibling;let e=(0,k.geByClass)("new_reply",s,"div").length+1;if(cur.wallMyOpened[i]){h&&"replies_open"==h.className&&(0,k.re)(h),p=!0;let e=(0,k.geByClass1)("wr_header",s,"a"),t=(0,k.geByClass)("reply",s,"div").length+1,o=t;e&&(o=(0,L.intval)(e.getAttribute("offs").split("/")[1])+1),(o>5||t<o)&&(e||s.insertBefore(e=(0,k.ce)("a",{className:"wr_header"}),s.firstChild),Wall.updateRepliesHeader(i,e,t,o))}else u=Wall.updatePostImages(u),f=(0,k.se)(u),(0,k.addClass)(f,"new_reply"),h&&"replies_open"==h.className||(h=(0,k.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(i),role:"button",tabIndex:0}),s.parentNode.insertBefore(h,s.nextSibling)),h.innerHTML=_.getLang("wall_x_new_replies_more",Math.min(100,e)),h.newCnt=e}else(0,k.re)("reply_link"+i),(0,k.show)(o,s),p=!0;i.split("_")[0]==vk.id&&cur.feedUnreadCount++,f||(f=(0,k.se)(u)),s.appendChild(f),de.needScrollPost(t,p?f:h)&&(l+=n.offsetHeight-r),f instanceof HTMLElement&&((0,W.updateNarrativeSnippetsFromQueueByPost)(f),(0,U.updateArticleSnippetsFromQueueByPost)(f),(0,Y.updateStickersFromQueue)(f)),p&&(0,A.highlightUpdatedReply)(f),Wall.repliesSideSetup(i),Wall.updateMentionsIndex(),Likes.update("wall"+i,{comment_num:e[13]});break}case"del_reply":if(!cur.wallMyDeleted[i]&&n){if((0,k.hasClass)((0,k.gpeByClass)("post",n),"deep_active")){const t=Wall.removeDeepReply(e);l+=t[0];break}de.needScrollPost(t,n)&&(l-=n.offsetHeight);let s=n.parentNode.id.match(/replies(-?\d+_\d+)/);(0,u.revertLastInlineVideo)(n),(0,k.re)(n),s&&Wall.repliesSideSetup(s[1])}break;case"view_post":Likes.update("wall"+i,{views_num:Wall.formatCount((0,L.intval)(e[3]))});break;case"like_post":case"like_reply":{if(!n)break;let t="like_reply"==o?"wall_reply"+i:i,s=n&&(0,k.domByClass)(n,"_like_wrap"),r=n&&(0,k.domByClass)(n,"_share_wrap");const a=(0,V.likeDataReactionsFields)(e);Wall.likeFullUpdate(s,t,{isQueueUpdate:!0,like_my:s&&(0,k.hasClass)(s,"my_like"),like_num:e[3],like_title:!1,share_my:r&&(0,k.hasClass)(r,"my_share"),share_num:e[4],share_title:!1,...a});break}}return l},feedPostRepl:function(e,t){e.replies=cur.wallTpl.post_replies;let s={full_id:t[2],item_id:"wall_"+t[2],sec_name:(0,R.stripHTML)(t[3]),date:Wall.getNowRelTime(),del:cur.wallTpl.spam};if("search"==cur.section&&cur.q){let o=e.text||"",i=cur.q.toLowerCase().split(/[\s.,:;!?()]/),n=[];o=o.replace(/<(.|\n)+?>/g,(function(e){return n.push(e),""}));let r,a,c,l=o.toLowerCase();for(r=i.length-1;r>=0;r--)if(c=i[r],(0,L.trim)(c))for(a=0;-1!=(a=l.indexOf(c,a));)o.charAt(a-1)!=String.fromCharCode(2)?(o=o.substr(0,a)+""+r+""+o.substr(a+c.length),l=l.substr(0,a)+""+r+""+l.substr(a+c.length)):a+=2;o=o.replace(/\x02(\d+)\x02/g,(function(e,t){return'<span class="highlight">'+i[t]+"</span>"})),o=o.replace(/\x01/g,(function(){return n.shift()||""})),s.text=o,"new_post_reply"==t[1]&&(s.date_postfix=t[7])}return s},reSortItems:function(){cur.feedToSort&&cur.feedToSort.length&&((0,L.each)(cur.feedToSort,(function(e,t){let s=(0,k.ge)("post_ph"+t),o=(0,k.ge)("post"+t).parentNode;s&&o&&(s.parentNode.insertBefore(o,s),(0,k.re)(s))})),cur.feedToSort=[],(0,v.scrollToY)(0,0))},showNewPosts:function(){(0,k.removeClass)(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0;let e=(0,k.ge)("feed_rows");Wall.loadPostImages(e),(0,L.each)((0,k.geByClass)("feed_row_unshown",e,"div"),(function(){(0,k.replaceClass)(this,"feed_row_unshown","feed_row")}))},updateTitle:function(){cur.idleManager&&(cur.idleManager.isIdle||(cur.feedUnreadCount=0),(0,k.setDocumentTitle)((cur.feedUnreadCount?"("+cur.feedUnreadCount+") ":"")+cur.feedInitialTitle))},toggleTabsMenuTab:function(e,t){let s=(0,k.geByClass1)("feed_section_"+e,cur.feedEls.rmenu);s&&(0,k.toggleClass)(s,"ui_rmenu_item_hidden",!t)},toggleTabsMenu:function(e,t){let s=(0,k.ge)("feed_add_list_icon");return void 0===t&&(t=!(0,k.hasClass)(s,"shown")),a.browser.mozilla&&(0,k.setStyle)("page_body",{overflow:t?"visible":""}),uiActionsMenu.toggle(s,t),t&&(0,b.addEvent)(document,"mousedown",(function e(t){de.toggleTabsMenu(!1,0),(0,b.removeEvent)(document,"mousedown",e)})),e&&(0,b.cancelEvent)(e)},checkTabsFilter:function(e,t){let s,o,i,n=t==cur.section,r=cur.my_feed_types.tabs;switch(t){case"news":return!1;case"newlist":return de.addList();default:if(i=t.match(/list(\d+)/))return de.editList(i[1])}s=-1!=(o=(0,L.indexOf)(r,t)),(0,k.toggleClass)(e,"checked",!s),s?(r.splice(o,1),n&&(cur.onSaveTabs=function(e,t){de.toggleTabsMenu(null,!1),de.switchSection("news")}.pbind(t,s))):r.push(t),cur.my_feed_types.tabs=r,de.toggleTabsMenuTab(t,!s||n),clearTimeout(cur.saveTabsTO),cur.saveTabsTO=setTimeout(de.saveTabs,500)},hasSearchParams:function(e){let t=!1;return(0,L.each)(e,(function(e,s){if((!e.indexOf("c[")&&"c[section]"!==e||"q"==e)&&s)return t=!0,!1})),t},getSectionParams:function(e){let t={section:e};switch(e){case"news":case"recommended":case"groups":case"friends":case"videos":case"photos":case"podcasts":case"articles":void 0===(t.subsection=cur.subsections[e])&&delete t.subsection;break;case"owner":(t.owner=cur.owner)||delete t.section;break;case"source":case"notifications":(t.source=cur.source)||delete t.source;break;case"list":void 0===(t.subsection=cur.subsections["list"+cur.list])&&delete t.subsection,(t.list=cur.list)||delete t.list;break;case"search":const s=(0,k.ge)("search_filters_form");if(s){let e=(0,L.serializeForm)(s)||{};for(let t in e)e[t]&&"0"!=e[t]||delete e[t];(0,L.extend)(t,e)}t["c[q]"]=(0,L.trim)((0,k.val)(cur.feedEls.search));break;case"photos_search":(t.q=(0,L.trim)((0,k.val)(cur.feedEls.search)))||delete t.section,(t.sort=(0,L.intval)(cur.search_sort_value))||delete t.sort;break;case"trends_search":window.nav.objLoc.trend_id&&(t.trend_id=window.nav.objLoc.trend_id),(t.q=(0,L.trim)((0,k.val)(cur.feedEls.search)))||delete t.section,(t.sort=(0,L.intval)(cur.search_sort_value))||delete t.sort;break;case"articles_search":(t.q=(0,L.trim)((0,k.val)(cur.feedEls.search)))||(t.section="articles");break;case"comments":cur.reposts&&(t.reposts=cur.reposts);break;case"mentions":const o=new URLSearchParams(location.search);o.delete("ref"),history.replaceState(null,"","?"+o+location.hash),cur.mentionObj&&cur.mentionObj!=vk.id&&(t.obj=cur.mentionObj)}return t},switchNotifyList:function(e,t){uiRightMenu.go((0,k.geByClass1)("feed_section_"+e),!1,!1),de.go(t)},switchSubSection:function(e,t,s){if(t&&(0,b.checkEvent)(t))return!0;let o=cur.section;"list"===cur.section&&(o="list"+cur.list),cur.subsection=cur.subsections[o]=e;let i=de.getSectionParams(cur.section);i.hash=s,delete cur.feedUpdateLoading,delete cur.isFeedLoading,nav.go((0,L.extend)(i||{},{0:"feed"})),uiRightMenu.showProgress(cur.feedEls.rmenu)},switchSection:function(e,t,s){if(t&&(0,b.checkEvent)(t))return!0;if((0,k.removeClass)(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0,"photos_search"==e&&!(0,L.trim)((0,k.val)(cur.feedEls.search))){if("photos_search"!=cur.section)return!1;e="photos"}"comments"==e&&(cur.reposts=cur.options.reposts=""),(0,T.statlogsValueEvent)("feed_switch",0,e),de.setSection(e,1);let o=de.getSectionParams(e||"news");delete cur.feedUpdateLoading,delete cur.isFeedLoading;let i=!s&&(0,L.extend)(o||{},{0:"feed"});return uiRightMenu.go((0,k.geByClass1)("feed_section_"+e),!1,i),!1},setSection:function(e,t,s){if(t=t||0,cur.prevSection=cur.section,!(e==cur.section&&t<2)&&e){if(uiRightMenu.hideProgress(cur.feedEls.rmenu),cur.feedEls.search&&uiSearch.hideProgress(cur.feedEls.search),t>1){Page.playVkFestBanner&&Page.playVkFestBanner(),(0,k.toggleClass)(cur.feedEls.wrap,"feed_submit_shown",(0,L.inArray)(e,cur.options.feed_types.tabs.concat(["list","likes"]))),(0,k.toggleClass)(cur.feedEls.wrap,"feed_submit_only_shown",~["recommended","search","updates","comments"].indexOf(e));let t=(0,L.inArray)(e,["articles_search","articles","search","photos_search","photos","trends","trends_search"]);(0,k.toggleClass)(cur.feedEls.wrap,"feed_search_shown",t),t&&(0,k.elfocus)(cur.feedEls.search),(0,ae.isApiForVKCOMViewerEnabled)()||("search"===e&&s.stories_block_show?(0,k.addClass)(cur.feedEls.wrap,"feed_submit_shown_stories"):(0,k.removeClass)(cur.feedEls.wrap,"feed_submit_shown_stories")),cur.section&&(0,k.val)(cur.feedEls.search,"")}2!=t||(0,ae.isApiForVKCOMViewerEnabled)()||window.Stories&&Stories.updateFeedStories(e,s),cur.my_feed_types&&(~(0,L.indexOf)(cur.my_feed_types.optional_tabs,cur.section)&&!~(0,L.indexOf)(cur.my_feed_types.tabs,cur.section)&&de.toggleTabsMenuTab(cur.section,!1),~(0,L.indexOf)(cur.my_feed_types.optional_tabs,e)&&!~(0,L.indexOf)(cur.my_feed_types.tabs,e)&&de.toggleTabsMenuTab(e,!0)),cur.section=e,4!=t?(cur.editingHide=("notifications"==e||"replies"==e)&&de.notifyCheckHideReply,cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()):de.searchUpdate()}},applyOptions:function(e,t){t=t||0,e.no_left_ads&&(cur.no_left_ads=!0),e.owner&&(cur.owner=e.owner),cur.subsection=e.subsection||"",de.setSection(e.section,t,e),cur.options||(cur.options={reply_names:{}}),(0,L.extend)(cur.options.reply_names,e.reply_names),delete e.reply_names,(0,L.extend)(cur,e);let s=cur.section;if("list"===cur.section&&(s="list"+e.list),cur.subsections[s]=cur.subsection,e.loc&&2==t&&nav.setLoc(e.loc),e.section&&"news"==e.section&&e.subsection&&"top"==e.subsection&&(0,T.statlogsValueEvent)("feed_switch",0,"top_news",t),e.filters){let t=(0,k.ge)("search_filters_minimized"),s=t&&(0,k.hasClass)(t,"ui_rmenu_item_expanded"),o=!!t;(0,k.val)("feed_filters",e.filters),window.searcher&&o&&F.searcher.toggleMinimizedFilters((0,k.ge)("search_filters_minimized"),s,!0)}if(e.script&&(0,y.evalWithLogging)(e.script),e.htitle&&(cur.feedInitialTitle=document.title=(0,R.replaceEntities)((0,R.stripHTML)(e.htitle))),void 0!==e.add_feed_queue&&null!==e.add_feed_queue?(cur.add_feed_queue=!1,e.add_feed_queue=!1,de.getNewQKey(0),!0!==e.add_queue&&(cur.add_queue=e.add_queue)&&setTimeout(de.update.pbind(0),0)):t&&"search"!=cur.section&&"news"!=cur.section&&cur.section&&(cur.add_feed_queue=!1,e.add_feed_queue=!1),e.add_queues&&(cur.add_queues=e.add_queues,setTimeout(de.update.pbind(0),0)),e.q){(0,k.val)(cur.feedEls.search,(0,R.replaceEntities)(e.q));let t=e.q;t.length>30&&(t=(0,L.trim)(t.substr(0,30))+"...")}e.last_view&&(cur.options.last_view=e.last_view),void 0!==e.feedback_list&&(cur.options.feedback_list=e.feedback_list),de.searchUpdate(),"comments"!=cur.section||cur.reposts||(0,k.toggle)("comments_filters",!cur.reposts),(0,R.isString)(cur.all_shown_text)&&(0,k.val)("all_shown",cur.all_shown_text),(0,R.isString)(cur.show_more_text)&&(0,k.val)("show_more_link",cur.show_more_text),cur.empty_text&&(0,k.val)("feed_empty",cur.empty_text),cur.count>=0&&(0,k.re)("feed_error_wrap");let o=!((0,k.geByClass1)("feed_row",cur.rowsCont,"div")||!1),i=(0,k.ge)("feed_rows_next");if(o?((0,k.toggleClass)(cur.feedEls.wrap,"feed_is_empty",!(0,k.isVisible)("feed_error_wrap")),(0,k.hide)("all_shown"),(0,k.toggle)("show_more_link",cur.count>0&&!cur.all_shown)):!cur.all_shown||i&&i.firstChild?((0,k.hide)("all_shown"),(0,k.show)("show_more_link"),(0,k.removeClass)(cur.feedEls.wrap,"feed_is_empty")):((0,k.hide)("show_more_link"),(0,k.show)("all_shown"),(0,k.removeClass)(cur.feedEls.wrap,"feed_is_empty"),(0,k.re)(i)),e.playlistsData&&(e.playlistsData=JSON.parse(e.playlistsData),cur.pageVideosList=(0,L.extend)(cur.pageVideosList||{},e.playlistsData)),("notifications"==cur.section||"replies"==cur.section)&&cur.notify){let e=(0,k.ge)("feedback_row"+cur.notify);e&&e.onclick&&(setTimeout((function(){e.onclick(),(0,v.scrollToY)((0,k.getXY)(e)[1],0)}),a.browser.msie?100:0),delete cur.notify)}cur.feedSection&&cur.feedSection(e.section,e.subsection)},showMore:function(){if(cur.isFeedLoading)return;cur.disableAutoMore=!1;let e,t=(0,k.ge)("feed_rows_next");if(t){if(t.firstChild)for(;t.firstChild;)e=t.firstChild,cur.rowsCont.insertBefore(e,t),de.onPostLoaded(e,!0);(0,k.re)(t)}"live"==cur.section&&(cur.all_shown=!0);let s=(0,k.ge)("show_more_link");if(cur.all_shown&&((0,k.hide)(s),(0,k.show)("all_shown")),"live"==cur.section)return;let o=!1,i=function(e){e.keyCode==b.KEY.ESC&&(o=!0)};(0,b.addEvent)(document,"keyup",i);let r=de.getSectionParams(cur.section||"news");(0,L.extend)(r,{offset:cur.offset,from:cur.from,part:1,more:1,last_view:cur.options.last_view,games_news_items_allowed:cur.isGamesInRightBlock?0:1}),(0,L.extend)(r,cur.navParams),cur.options.feedback_list&&(r.list=cur.options.feedback_list),nav.objLoc.situational_suggest_id&&(r.situational_suggest_id=nav.objLoc.situational_suggest_id);let a=cur.section;ajax.post("al_feed.php?sm_"+cur.section,r,{onDone:function(e,t){if((0,b.removeEvent)(document,"keyup",i),a==cur.section)if(o)cur.disableAutoMore=!0;else{if(t){let e,s=(0,k.ce)("div");for(s.innerHTML=t;e=s.firstElementChild;){const t=(0,z.shouldFilterPaginatedRow)({row:e});t.shouldFilter?(console.info("Feed: skipping loaded row",e),s.removeChild(e),(0,n.randEnabled)(window.cur.feed_pagination_filtering_log_prob??.01)&&(0,G.feedLogFilteredRow)({filterReason:t.filterReason,ref:de.getModuleRef(),row:e,rowsContainer:cur.rowsCont,section:cur.section})):(cur.rowsCont.appendChild(e),de.onPostLoaded(e,!0))}}(0,d.shortCurrency)(),de.applyOptions(e),setTimeout(de.scrollCheck,200)}},showProgress:function(){(0,C.lockButton)(s),cur.isFeedLoading=!0},hideProgress:function(){if((0,C.unlockButton)(s),cur.isFeedLoading=!1,s.seen){let e=Math.ceil((Date.now()-s.seen)/1e3),t=cur.section+(cur.subsection?"_"+cur.subsection:"");(0,T.statlogsValueEvent)("feed_load_more_seen_time",e,t),s.seen=!1}},cache:1})},getTypesSection:function(){return"owner"===cur.section?J.Ranges.isUserId(cur.owner)?"person":"group":cur.section},checkFilter:function(e,t){let s,o,i=de.getTypesSection(),n=cur.my_feed_types[i],r=cur.feed_types[i];"notifications"!=i?(!0===n&&(n=(0,L.clone)(r)),s=-1!=(o=(0,L.indexOf)(n,t)),s?n.splice(o,1):(n.push(t),n.length==r.length&&(n=!0)),(0,C.checkbox)(e),cur.my_feed_types[i]=n,de.updateTypesCookie(),de.setFiltersUpdatePage(),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu)):de.setNotifyFilter(e,t)},setFilter:function(e,t){let s=de.getTypesSection(),o=(0,k.ge)(s+"_type_filter"),i=!0;"notifications"!=s&&((0,L.each)((0,k.geByClass)("_feed_filter_row",o,"div"),(function(){if((0,C.isChecked)(this)&&this!=e)return i=!1})),i?(cur.my_feed_types[s]=!0,(0,L.each)((0,k.geByClass)("_feed_filter_row",o,"div"),(function(){(0,C.checkbox)(this,!0)}))):((0,L.each)((0,k.geByClass)("_feed_filter_row",o,"div"),(function(){(0,C.checkbox)(this,!1)})),cur.my_feed_types[s]=[t],(0,C.checkbox)(e,!0)),de.updateTypesCookie(),de.setFiltersUpdatePage({force_expand_filters:1}),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu))},setFiltersUpdatePage:function(e){e=e||{};let t=nav.strLoc;if("updates"===cur.section){t.match(/\&filters\_expanded\=1/)||(0,k.ge)("updates_show_all_filters")&&!e.force_expand_filters||(t+="&filters_expanded=1"),t=t.replace(/\&filters\_shown\=([a-z\,]+)/,"");let s=(0,k.geByClass)("_feed_filter_row","feed_filters"),o=[];for(let e=0;e<s.length;e++)(0,k.hasClass)(s[e],"hide")||o.push(s[e].id.replace("filter_updates",""));t+="&filters_shown="+o.join(",")}nav.go(t)},setNotifyFilter:function(e,t){(0,C.checkbox)(e),cur.notifyPrefs||(cur.notifyPrefs={}),cur.notifyPrefs[t]=(0,C.isChecked)(e),clearTimeout(cur.saveNotifyPrefsTO),cur.saveNotifyPrefsTO=setTimeout((function(){let e=[];(0,L.each)(cur.notifyPrefs,(function(t,s){e.push((s?"":"-")+t)})),e=e.join(","),ajax.post("/al_feed.php",{act:"a_set_notify_prefs",prefs:e,feed:1,hash:cur.topNotifyHash},{onDone:function(e){(0,L.addTemplates)({top_notify_prefs:e}),(0,k.toggleClass)("top_notify_pref_"+t,"checked",cur.notifyPrefs[t]),cur.notifyPrefs={},window.TopNotifier&&TopNotifier.invalidate(),nav.go(nav.strLoc),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu)}})}),500)},updateTypesCookie:function(){let e=[];(0,L.each)(cur.my_feed_types,(function(t,s){"tabs"!=t&&e.push(!0===s?"*":s.join(","))})),(0,m.setCookie)("remixfeed",e.join("."),365)},toggleFeedTop:function(e,t,s){let o=(0,k.geByClass1)("_ui_toggler",e),i="top";switch((0,k.toggleClass)(o,"on"),cur.section){case"news":case"recommended":case"groups":case"friends":case"videos":case"photos":case"list":i=(0,k.hasClass)(o,"on")?"top":"recent";break;case"articles":i=(0,k.hasClass)(o,"on")?"suggested":"top";break;case"podcasts":i=(0,k.hasClass)(o,"on")?"recent":"top"}de.switchSubSection(i,t,s)},switchList:function(e){cur.prevList=cur.list,cur.list=e,de.setSection("list",1),uiRightMenu.go((0,k.geByClass1)("feed_section_list"+e),!1,!1),de.go(de.getSectionParams(cur.section))},setSearchSort:function(e){cur.search_sort_value=e,de.submitSearch()},_activateReplyBox:function(e,t,s){(t||{}).cancelBubble=!0;let o=(0,k.ge)("reply_box"+e);if(cur.editing&&cur.editing!=e&&cur.notifyReplyData&&cur.notifyReplyData[cur.editing].disabled&&de.notifyCheckHideReply(cur.editing,(window.event||{}).target),o&&(0,k.isVisible)(o))return void de.notifyCheckHideReply(e,!1);if(void 0===cur.notifyReplyData&&(cur.notifyReplyData={}),cur.notifyReplyData[e]=s,s.disabled){if(o)(0,k.show)(o);else{(0,k.ge)("feedback_row"+e).appendChild((0,k.se)((0,k.rs)(cur.options.feedback_dis,{item:e,text:s.disabled})))}return void setTimeout((function(){cur.editing=e}),0)}(0,k.show)(o),Wall.showEditReply(e,t);let i=(0,k.ge)("reply_field"+e);i.setAttribute("placeholder",s.ph),window.Emoji&&Emoji.val(i,s.greet.replace(/ $/,"&nbsp;")),(0,k.data)(i,"send",de.notifySendReply),(0,k.removeClass)("reply_box"+e,"clear_fix")},notifyClick:function(e,t,s){let o=(0,k.ge)("feedback_row"+e);Wall.checkPostClick(o,t)&&de._activateReplyBox(e,t,s)},blindNotifyReply:function(e,t,s){de._activateReplyBox(e,t,s)},notifySendReply:function(e,t,s){let o=cur.notifyReplyData[e];if(!o||o.sending)return;let i,n=(0,k.ge)("reply_field"+e),r=(0,k.ge)("reply_button"+e),a=(0,k.ge)("feedback_row"+e),c=n&&(0,k.data)(n,"composer");if(s.stickerId)i={message:"",attach1_type:"sticker",attach1:s.stickerId};else{if(i=c?Composer.getSendParams(c,de.notifySendReply.pbind(e)):{message:(0,L.trim)(Emoji.editableVal(n))},i.delayed)return;if(!i.attach1_type&&(!i.message||o.greet&&!o.greet.indexOf(i.message)))return void Emoji.editableFocus(n,!1,!0)}(0,L.extend)(i,{act:"post",from:"feedback",item:e},o.params||{});let l=(0,k.ge)("reply_as_group"+e);l&&(0,k.isVisible)((0,k.domPN)(l))&&(i.from_oid=(0,k.domData)((0,k.domClosest)("_submit_post_box",l),"from-oid")),o.sending=1,ajax.post("al_wall.php",Wall.fixPostParams(i),{onDone:function(t,s){if(delete o.sending,c?Composer.reset(c):window.Emoji&&Emoji.val(n,""),n.autosize&&n.autosize.update(),de.notifyHideReply(e),s){let e=(0,k.geByClass1)("_answer_wrap",a);(0,k.val)(e,s),(0,k.show)(e)}else t&&(0,w.showDoneBox)(t)},onFail:function(){delete o.sending},showProgress:()=>(0,C.lockButton)(r),hideProgress:()=>(0,C.unlockButton)(r)})},notifyCheckHideReply:function(e,t){let s=cur.notifyReplyData&&cur.notifyReplyData[e];if(s&&!s.sending&&(0,k.isVisible)("reply_box"+e)){if(cur.editing=!1,!s.disabled){let t=(0,k.ge)("reply_field"+e),o=(0,L.trim)(window.Emoji?Emoji.editableVal(t):""),i=Wall.hasComposerMedia(t);if(!t||i||o&&!s.greet||s.greet.indexOf(o))return}de.notifyHideReply(e)}},notifyHideReply:function(e){cur.editing==e&&(cur.editing=!1);let t=(0,k.ge)("feedback_row"+e);(0,k.removeClass)(t,"reply_box_open"),(0,k.hide)("reply_box"+e);let s=cur.replySubmitSettings;s&&s.tt&&s.tt.el&&s.tt.destroy()},notifyPostTooltip:function(e,t,s,o){let i=(s||{}).reply,n="al_wall.php";t.indexOf("topic_comment")?t=t.replace("wall_reply","").replace("wall",""):(n="al_board.php",t=t.replace("topic_comment","")),o=o||{},(0,E.showTooltip)(e,(0,L.extend)({url:n,params:(0,L.extend)({act:"post_tt",post:t,self:1,from:"feedback"},s||{}),slide:15,shift:[!i||i%2?27:329,6],ajaxdt:100,showdt:400,hidedt:800,dir:"auto",className:"rich wall_tt wall_module _feed_notification feed_notification",appendParentCls:"scroll_fix_wrap"},o))},getModuleRef:function(){let e=cur.module||"feed_other";return"feed"==cur.module&&(e="news"==cur.section?cur.subsection?"feed_news_"+cur.subsection:"feed_news":"podcasts"===cur.section?e+"_"+cur.section+("recent"===cur.subsection?"_my":""):cur.section?e+"_"+cur.section:"feed_other"),e},ignoreItem:function(e,t,s,o,i,n=0,r="",a=!0){let c;switch(e){case N.BlockTypeIds.UXPollBlock:case N.BlockTypeIds.VideosForYou:case N.BlockTypeIds.VideoPostcard:case N.BlockTypeIds.PhotoRecognize:case N.BlockTypeIds.RecommendedNarratives:case N.BlockTypeIds.BookmarkGame:case N.BlockTypeIds.AchievementGame:case N.BlockTypeIds.YoulaRecommendationsCarousel:case N.BlockTypeIds.AliExpressRecommendationsCarousel:c=(0,k.ge)(e);break;default:c=(0,k.ge)("post"+e)}if(!c)return;let l=(0,ce.getAdAttribute)(c,"ad"),d=(0,k.geByClass1)("ui_actions_menu_wrap",c),_=de.getModuleRef();return d&&uiActionsMenu.toggle(d,!1),(0,u.revertLastInlineVideo)(c),a&&(t.includes("caption")?cur.feedEntriesHTML[e+"_ignored"]=(0,k.val)(c):cur.feedEntriesHTML[e]=(0,k.val)(c)),new Promise(((d,u)=>{ajax.post("/al_feed.php",{act:"a_ignore_item",post_raw:e,feed_raw:t,caption_type:o,uids:i,hash:s,ad_data:l,ref:_,session_id:cur.feed_session_id,module:de.getModuleRef(),position:(0,L.indexOf)((0,k.domPN)((0,k.domPN)(c)).children,(0,k.domPN)(c)),reason_id:n,track_code:r},{onDone:function(e,t){de.destroyPhotoCarouselByPost(c),window.Feed?.viewStats?.onIgnorePost(c),a&&((0,k.val)(c,e),(0,y.evalWithLogging)(t)),d()},onFail:()=>(u(),!0),stat:[window.jsc("web/privacy.js"),"privacy.css"]})}))},unignoreItem:function(e,t,s,o){let i=de.getModuleRef();ajax.post("/al_feed.php",{act:"a_unignore_item",post_raw:e,feed_raw:t,hash:s,ref:i},{onDone:function(){t.includes("caption")?(0,k.val)("post"+e,cur.feedEntriesHTML[e+"_ignored"]):de.restorePost(e)},showProgress:o&&C.lockButton.pbind(o),hideProgress:o&&C.unlockButton.pbind(o)})},reportIgnoredItem:function(e,t){ajax.post("al_wall.php",{act:"spam",post:e,hash:t},{onDone:function(t){let s=(0,k.ge)("post"+e),o=s&&(0,k.geByClass1)("feed_post_report",s,"div");(0,k.val)(o,t)}})},ignoreOwner:function(e,t,s,o,i,n){e&&(cur.feedEntriesHTML[e+"_ignored"]=(0,k.val)("post"+e));let r="list"==cur.section&&cur.list||0,a=de.getModuleRef();ajax.post("/al_feed.php",{act:"a_ignore_owner",post_raw:e,owner_id:t,type:s,hash:o,list:r,ref:a,track_code:n},{onDone:function(s){(0,k.val)("post"+e,s),(0,L.each)((0,k.geByClass)("post",cur.rowsCont),(function(s,o){let i=this.id.match(/post((-?\d+)_(-?\d+)(_\d+)?)/);i&&i[1]!=e&&(!i[4]&&i[2]==t||i[4]&&i[3]==t)&&((0,u.revertLastInlineVideo)(this),(0,k.hide)(this.parentNode))}))},showProgress:()=>{i&&i.classList.contains("ui_actions_menu_item")?(0,C.lockActionsMenuItem)(i):M.FlatButton.isFlatButton(i)&&M.FlatButton.lock(i)},hideProgress:()=>{i&&i.classList.contains("ui_actions_menu_item")?(0,C.unlockActionsMenuItem)(i):M.FlatButton.isFlatButton(i)&&M.FlatButton.unlock(i)}})},unignoreOwner:function(e,t,s,o,i){let n="list"==cur.section&&cur.list||0,r=de.getModuleRef();ajax.post("/al_feed.php",{act:"a_unignore_owner",post_raw:e||"",owner_id:t,hash:s,list:n,ref:r,track_code:i},{onDone:function(s){e?(0,k.val)("post"+e,cur.feedEntriesHTML[e+"_ignored"]):(0,k.val)("ignore_row"+t,s),(0,L.each)((0,k.geByClass)("post",cur.rowsCont),(function(e,s){let o=this.id.match(/post((-?\d+)_(-?\d+)(_\d+)?)/);o&&(!o[4]&&o[2]==t||o[4]&&o[3]==t)&&(0,k.show)(this.parentNode)}))},showProgress:()=>M.FlatButton.lock(o),hideProgress:()=>M.FlatButton.unlock(o)})},ignoreGroupWall:function(e,t,s,o,i){e&&(cur.feedEntriesHTML[e+"_ignored"]=(0,k.val)("post"+e));let n=de.getModuleRef();ajax.post("/al_feed.php",{act:"a_ignore_owner",post_raw:e,owner_id:t,ignore_type:"group_wall",hash:s,ref:n,track_code:i},{onDone:function(t){(0,k.val)("post"+e,t)},showProgress:()=>M.FlatButton.lock(o),hideProgress:()=>M.FlatButton.unlock(o)})},unignoreGroupWall:function(e,t,s,o,i){let n=de.getModuleRef();ajax.post("/al_feed.php",{act:"a_unignore_owner",post_raw:e||"",owner_id:t,ignore_type:"group_wall",hash:s,ref:n,track_code:i},{onDone:function(s){e?(0,k.val)("post"+e,cur.feedEntriesHTML[e+"_ignored"]):(0,k.val)("ignore_row"+t,s)},showProgress:()=>M.FlatButton.lock(o),hideProgress:()=>M.FlatButton.unlock(o)})},ignoreLiveOwner:function(e,t,s,o){let i=(0,k.ge)("post"+e),n=(0,k.geByClass1)("ui_actions_menu_wrap",i);n&&uiActionsMenu.toggle(n,!1),(0,u.revertLastInlineVideo)(i),cur.feedEntriesHTML[e+"_ignored"]=(0,k.val)("post"+e),ajax.post("al_feed.php?act=a_ignore_live_owner",{post_raw:e,owner_id:t,hash:s},{onDone:function(t){(0,k.val)("post"+e,t)},showProgress:o&&C.lockButton.pbind(o),hideProgress:o&&C.unlockButton.pbind(o)})},unignoreLiveOwner:function(e,t,s,o){ajax.post("al_feed.php?act=a_unignore_live_owner",{post_raw:e,owner_id:t,hash:s},{onDone:function(t){(0,k.val)("post"+e,cur.feedEntriesHTML[e+"_ignored"])},showProgress:o&&C.lockButton.pbind(o),hideProgress:o&&C.unlockButton.pbind(o)})},unsubscribe:function(e,t,s){(0,b.triggerEvent)((0,k.ge)("post_delete"+e),"mouseout"),cur.feedEntriesHTML[e]=(0,k.ge)("post"+e).innerHTML;let o=e.match(/(\-?\d+)_(photo|video|shortVideo|topic|note|market|)(\d+)/);o&&ajax.post("al_feed.php",{act:"unsubscribe",type:{"":24,photo:21,video:22,shortVideo:26,topic:20,note:23,market:25}[o[2]],owner_id:o[1],place_id:o[3],hash:t,feed:1},{onDone:function(t){(0,k.ge)("post"+e).innerHTML=t.replace("%post_raw%",e)},showProgress:s&&C.lockButton.pbind(s),hideProgress:s&&C.unlockButton.pbind(s)})},subscribe:function(e,t,s){let o=e.match(/(\-?\d+)_(photo|video|shortVideo|topic|note|market|)(\d+)/);o&&ajax.post("al_feed.php",{act:"subscribe",type:{"":24,photo:21,video:22,shortVideo:26,topic:20,note:23,market:25}[o[2]],owner_id:o[1],place_id:o[3],hash:t,feed:1},{onDone:de.restorePost.pbind(e),showProgress:s&&C.lockButton.pbind(s),hideProgress:s&&C.unlockButton.pbind(s)})},restorePost:function(e){let t;if(e===N.BlockTypeIds.PhotoRecognize)t=(0,k.ge)(e);else t=(0,k.ge)("post"+e);if(!t)return;t.innerHTML=cur.feedEntriesHTML[e],de.initPhotoCarouselInPost(t);document.querySelectorAll(".ui_actions_menu_wrap").forEach((e=>{e&&(e.classList.remove("shown"),uiActionsMenu.hide(e))}));let s=(0,k.geByClass1)("input_back",t,"div"),o=(0,k.geByTag1)("textarea",t);o&&(o.placeholder=s.innerHTML,s.parentNode.removeChild(s),(0,S.placeholderSetup)(o))},toggleReposts:function(e,t,s,o){if((0,b.checkEvent)(o))return!0;let i=(0,k.ge)("feed_reposts_more"+t+"_"+s),n=(0,k.ge)("feed_reposts"+t+"_"+s),r=0,a=(0,v.scrollGetY)(),c=(0,k.isVisible)(n);if(n)return c?r-=n.offsetHeight+(0,L.intval)((0,k.getStyle)(e,"marginTop")):((0,k.domPN)((0,k.domPN)(n))||{}).bits=0,(0,k.toggle)(n,!c),M.FlatButton.setLabel(i,c?_.getLang("news_show_X_reposts",n.childNodes.length):_.getLang("news_hide_reposts")),r&&(0,v.scrollToY)(a+r+(0,k.getSize)("page_header")[1],0),!1;i&&(0,k.re)(i.parentNode.parentNode)},editHidden:function(){return(0,P.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"feed",height:lastWindowHeight},{stat:["ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")]}),cur.onOListSave=de.onHiddenSave,!1},onHiddenSave:function(e,t,s,o){let i=(0,w.curBox)(),r={act:"a_ignore_olist",no_reposts:(0,k.ge)("feed_list_reposts")&&!(0,C.isChecked)("feed_list_reposts")?1:0,hash:o.hash};return(0,n.partConfigEnabled)("use_only_black_list_param_to_process_owners")?r.Black=t.join(","):e.length<t.length?r.White=e.join(","):r.Black=t.join(","),ajax.post("al_feed.php",r,{onDone:function(e,t){i.hide(),de.switchSection("photos"==cur.section?"photos":"news")},showProgress:C.lockButton.pbind(i.btns.ok[0]),hideProgress:C.unlockButton.pbind(i.btns.ok[0])}),!1},addList:function(){return de.editList(-1)},editList:function(e){return de.toggleTabsMenu(!1,0),(0,P.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"feed",list_id:e,height:lastWindowHeight},{stat:["ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")],onFail:function(e){return setTimeout((0,P.showFastBox)({title:_.getLang("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e,_.getLang("global_close")).hide,4500),!0}}),cur.onOListSave=de.onListSave.pbind(e),!1},onListSave:function(e,t,s,o,i){let n=(0,k.val)("feed_list_name");if(!(0,L.trim)(n))return(0,C.notaBene)("feed_list_name"),!1;if(!t.length)return!1;let r=(0,w.curBox)();return ajax.post("al_feed.php",{act:"a_save_list",hash:cur.tabs_hash,White:t.join(","),title:n,list_id:e,no_reposts:(0,k.ge)("feed_list_reposts")&&!(0,C.isChecked)("feed_list_reposts")?1:0},{onDone:function(t){let s=(0,k.geByClass1)("feed_section_list"+e,cur.feedEls.rmenu),o=(0,k.geByClass1)("feed_filter_list"+e,cur.feedEls.rmenu);const i=uiRightMenu.selectLabelNode(s);(0,k.val)(i,(0,L.clean)(n)),(0,k.val)((0,k.geByClass1)("ui_actions_menu_item_label",o),(0,L.clean)(n)),r.hide(),e>0?de.switchList(e):nav.go({0:"feed",section:"list",list:t},null,{nocur:!0})},onFail:function(e){return(0,k.val)("feed_list_error",e),(0,k.show)("feed_list_error_wrap"),!0},showProgress:C.lockButton.pbind(r.btns.ok[0]),hideProgress:C.unlockButton.pbind(r.btns.ok[0])}),!1},deleteList:function(e,t,s,o){if(o&&(0,b.cancelEvent)(o),e<=0)return!1;if(!s){de.toggleTabsMenu(!1,0);const s=(0,P.showFastBox)({title:_.getLang("news_delete_list_sure_title"),bodyStyle:"padding: 20px; line-height: 160%;"},_.getLang("news_delete_list_sure").replace("{list}",t),_.getLang("global_delete"),(function(){de.deleteList(e,t,!0)}),_.getLang("global_cancel"),(function(){s.hide()}));return}const i=(0,w.curBox)();ajax.post("al_feed.php",(0,L.extend)({act:"a_delete_list",list_id:e,hash:cur.tabs_hash}),{onDone:function(){(0,k.re)((0,k.geByClass1)("feed_section_list"+e,cur.feedEls.rmenu)),(0,k.re)((0,k.geByClass1)("feed_filter_list"+e,cur.feedEls.rmenu)),boxQueue.hideAll(),"list"==cur.section&&cur.list==e&&de.switchSection("news")},showProgress:C.lockButton.pbind(i.btns.ok[0]),hideProgress:C.unlockButton.pbind(i.btns.ok[0])})},saveTabs:function(){ajax.post("al_feed.php",{act:"a_save_tabs",hash:cur.tabs_hash,tabs:cur.my_feed_types.tabs.join(",")},{hideProgress:function(){(0,R.isFunction)(cur.onSaveTabs)&&cur.onSaveTabs(),cur.onSaveTabs=null}})},statsShow:function(e,t){return(0,g.showWiki)({w:"stats"+(cur.source||"")},!1,e)},editLiveBlacklist:function(e){(0,b.cancelEvent)(e),(0,P.showBox)("al_video.php?act=live_blacklist_box",{},{onDone:function(e,t){(0,j.videoLiveBlacklistBoxLoader)(e,t)},stat:[window.jsc("web/videoview.js"),"videoview.css",window.jsc("web/indexer.js")]})},_scrollCheck:e=>{if(e=e||{},(0,ie.isFeedViewStatsEnabled)()){const e=(0,H.getFeedPosts)("#feed_rows");window.Feed?.viewStats?.checkScroll(e)}if("scroll"!=e.type&&(!cur.idleManager||cur.idleManager.isIdle))return;let t,s,o,i,n,r,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=(0,v.scrollGetY)(),l=0,d=[];if(!cur.isFeedLoading&&!cur.disableAutoMore){const e=(0,k.ge)("show_more_link");(0,k.isVisible)(e)&&c+a+1e3>e.offsetTop&&de.showMore()}if((0,k.domPN)(cur.topRow)==cur.rowsCont&&"feed_rows_next"!=(cur.topRow||{}).id||(cur.topRow=(0,k.domFC)(cur.rowsCont)),!vk.id||!cur.topRow||"feed_rows_next"==cur.topRow.id||((window.curNotifier||{}).idle_manager||{}).is_idle&&"init"!=e.type)return;let u=[];for(i=(0,k.domPS)(cur.topRow);i;i=(0,k.domPS)(i))cur.topRow.offsetTop>c&&(cur.topRow=i),i.unseen||(i.unseen=!0,u.push((0,H.postsGetRaws)(i)),(0,H.isAdWithShowOff)(i)&&Wall.triggerAdStat((0,k.domFC)(i),"show_off"));for(Page.postsUnseen(u),i=cur.topRow;i&&(t=l||i.offsetTop,!(t>=c+a));i=n)if(n=(0,k.domNS)(i),"feed_rows_next"==(n||{}).id&&(n=null),l=n?n.offsetTop:t+i.offsetHeight,l<c&&n&&(cur.topRow=n),LongView&&LongView.register(i,"feed"),O.longView.registerElement(i),r=i.bits||0,!(r>=3)&&(cur.feedSeenPostHeight>0?(cur.feedPostHeaderHeight=cur.feedPostHeaderHeight||(0,k.getH)(i?.querySelector?.(".post_header, .js-PostHeader")),s=t+cur.feedPostHeaderHeight,o=s+cur.feedSeenPostHeight,i.postBottom||(i.postBottom=s+(0,k.getH)((0,k.geByClass1)("wall_text",i))),o=Math.min(o,i.postBottom),(0,k.geByClass1)("feed_friends_recomm",i)&&(o+=.35*i.clientHeight),r|=(s>=c&&s<c+a?1:0)|(o>=c&&o<c+a?2:0)):r|=(t>=c&&t<c+a?1:0)|(l>=c&&l<c+a?2:0),r&&(i.bits=r,3===r))){let e=(0,H.postsGetRaws)(i);d=(0,ee.handleViewingPosts)({posts:d,postRaws:e,el:i}),(0,ee.handleViewingFeedBlocks)({el:i,index:e?.index,ref:e?.module})}d=d.concat(O.longView.process(c,a)),LongView&&LongView.onScroll(c,a),Page.postsSeen(d);let _=cur.section+(cur.subsection?"_"+cur.subsection:"");(0,ee.feedShowMoreButtonLoadedCount)(_,c,a)},searchUpdate:function(){if(cur.feedEls.search&&_.getLang("news_search")){let e;e=cur.section.indexOf("photos")?cur.section.indexOf("articles")?_.getLang("news_search"):_.getLang("news_articles_search"):_.getLang("news_photo_search"),cur.feedEls.search.setAttribute("placeholder",(0,L.clean)((0,R.unclean)(e))),(0,S.placeholderInit)(cur.feedEls.search,{reload:!0})}},go:function(e,t,s){if(e=e||{},cur._back_local){let m=cur._back_local;m.back?(0,p.showBackLink)(m.back[0],m.back[1],m.back[2]):(0,p.showBackLink)(!1),cur._back_local=!1}if(cur.feedReq)try{cur.feedReq.abort()}catch(b){(0,h.debugLog)(b)}cur.feedReqObj=null;let o=1,n=function(){cur.isFeedLoading=!1};(a.browser.msie||s)&&(o=!1,n=cur.onFrameBlocksDone),cur.wasScroll=!!s&&(0,v.scrollGetY)();let r=window.event&&window.event.target;if(r&&"search"===e.section&&!e._post){let S=nav.getPostParams(r);if(S.post_id&&S.post_click_type){function C(t,s){t&&!e[s]&&(e[s]=t)}C(S.post_id,"_post"),C(S.post_click_type,"_post_click_type"),C(S.post_click_url,"_post_click_url"),C(S.post_click_mention_id,"_post_click_mention_id"),C(S.post_click_cc_key,"_post_click_cc_key"),C(S.ad_data,"_post_ad_data"),C(S.ad_block_unique_id,"_post_ad_block_unique_id")}}let c=cur.feedReqObj={},l={},_=0;const g=()=>{if(!cur.feedReqObj||cur.feedReqObj!==c)return;if(++_>500)return;let e=!0,t={};(0,L.each)(l,(function(s){let o=(0,k.ge)(s);if(o&&(0,k.hasClass)(o,"feed_row"))return o.firstChild?void de.onPostLoaded(o,!0):(t[s]=!0,void(e=!1))})),e||(l=t,setTimeout(g,100))},w=+new Date;cur.feedReq=ajax.post("al_feed.php",(0,L.extend)(e,{part:1}),{onDone:function(s,n,r,a,c){if(!cur.feedEls)return;const _=document.querySelector("h1#feed-page-title-h1");if(_&&s.htitle&&(_.innerHTML=s.htitle),(0,u.revertLastInlineVideo)(),(0,k.removeClass)(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0,window.tooltips&&tooltips.destroyAll((0,k.ge)("feed_rows")),boxQueue.hideAll(),layers.fullhide&&!cur.storyLayer&&layers.fullhide(!0),o&&ajax._framenext(),window.wall&&Wall.cancelEdit(),boxQueue.hideAll(),window.cur.section!==window.cur.prevSection&&(0,re.dispatchSectionChangedEvent)({prevSection:window.cur.prevSection,newSection:window.cur.section}),t?t(n||""):(0,k.val)(cur.rowsCont,n||""),de.applyOptions(s,2),!e.norecom&&"notifications"!==e.section){(0,k.val)("feed_recommends",s.recommends||""),(0,k.toggle)("feed_recommends",!!s.recommends);let e="/al_feed.php#"+(0,i.toQueryString)({act:"recom"});ajaxCache[e]&&delete ajaxCache[e],(0,k.toggleClass)(cur.feedEls.wrap,"feed_asc_shown",(0,k.geByClass1)("feed_asc_block","feed_recommends"))}let h;if(r&&(0,y.evalWithLogging)(r),(0,f.checkPageBlocks)(),(0,v.scrollToTop)(0),(0,d.shortCurrency)(),cur.feedEls.wall)switch(h="clear_fix",cur.section){case"updates":h+=" page_block feed_updates";break;case"photos_search":h+=" page_block feed_found_photos";break;case"notifications":h+=" page_block feed_notifications";break;case"coronavirus":case"stayhome":h+=" feed_wall--with-header"}if((0,k.ge)("feed_wall").className=h,(0,k.toggle)("feed_recommends",(0,L.inArray)(cur.section,["news","recommended","videos"])),(0,k.val)("feed_app_widget",a||""),(0,k.toggle)("feed_app_widget",a),a&&c&&(0,y.evalWithLogging)(c),cur.rowsCont&&cur.rowsCont.children&&((0,L.each)(cur.rowsCont.children,(function(){let e=this;(0,k.hasClass)(e,"feed_row")&&(!e.id||e.firstChild?de.onPostLoaded(e,!0):l[e.id]=!0)})),(0,R.isEmpty)(l)||setTimeout(g,10)),cur.q){const e="photos_search"===cur.section?T.servicePhotos:T.serviceNews,t=+new Date-w;(0,T.saveSearchAttemptStats)(e,0,cur.count,(0,k.val)(cur.feedEls.search),0,cur.event_bits,t,"",T.blockNameEmpty,"",!1,0,null,cur.sort),(0,D.updateCounters)(location.href,document.referrer)}(0,ie.isFeedViewStatsEnabled)()&&window.Feed?.viewStats?.initObserving(),setTimeout(de.scrollCheck,200)},onFail:function(){return!1},showProgress:function(){cur.isFeedLoading=!0},frame:o,ads:1,hideProgress:n})},onFeedSearch:function(e,t,s,o){t||(0,T.removeSearchPositionTracker)("photos");let i,n,r=o||cur.section;if(r.indexOf("photos")?r.indexOf("trends")?r.indexOf("articles")?(i="search",n="news"):(i="articles_search",n="articles"):(i="trends_search",n="trends"):(i="photos_search",n="photos"),"search"==i||de.hasSearchParams(de.getSectionParams(i))){i!=cur.section&&de.setSection(i,1);let s=de.getSectionParams(i);cur.disableSort&&(s.disable_sort=1),de.go(s),window.searcher&&F.searcher.highlightHotHashtag(t||(0,k.val)(e)),cur.feedEls?.search&&(0,re.dispatchQueryChangedEvent)({query:(0,L.trim)(cur.feedEls?.search?.value||"")})}else de.go(de.getSectionParams(n));uiSearch.onChanged(e),uiSearch.showProgress(e)},onSearchChange:function(){return setTimeout(de.onFeedSearch.pbind(cur.feedEls.search),0),!1},init:function(e){(0,c.feedLoadingStats)(e),(0,n.partConfigEnabled)("post_adblock_protection_promo")&&(0,le.initObserverForSmokeScreen)("body"),setTimeout((function(){(0,L.each)((0,k.geByTag)("textarea",cur.rowsCont),(function(){(0,S.placeholderSetup)(this)})),cur.q&&(0,T.saveSearchAttemptStats)("photos_search"===cur.section?T.servicePhotos:T.serviceNews,0,cur.count,(0,k.val)(cur.feedEls.search),"0",cur.event_bits,"0","",T.blockNameEmpty,"",!1,0,null,cur.sort)}),200),(0,L.extend)(cur,{oid:e.user_id,postTo:e.user_id,phCache:{},phShown:{},subsections:{},feed_session_id:e.feed_session_id||"na",module:"feed",isFeedLoading:!1,customSearchChange:de.onSearchChange,navParams:e.nav_params||{},isGamesInRightBlock:e.is_games_in_right_block,wallPostCb:function(){"news"==cur.section?setTimeout(de.update.pbind(1),1e3):setTimeout(de.switchSection.pbind("news"),1e3)},idleManager:function(){let e,t,s;const o={isIdle:!1,onIdle:null,onUnIdle:null,stop:function(){(0,b.removeEvent)(document,"mousemove keydown",e),(0,b.removeEvent)(window,"focus blur",s)},start:function(){a.browser.mobile||(e=function(){cur.idleManager&&o.isIdle&&(o.isIdle=!1,o.onUnIdle&&o.onUnIdle())},t=function(){cur.idleManager&&(o.isIdle=!0,o.onIdle&&o.onIdle())},s=function(s){"focus"==s.type?e():t()},(0,b.addEvent)(window,"focus blur",s))}};return o}(),currentModule:function(){return"videos"==cur.section?"feed_videos":cur.module},onFrameBlocksDone:function(){cur.isFeedLoading=!1,(0===cur.wasScroll||cur.wasScroll>0||!1===cur.wasScroll&&"search"==cur.section&&cur.q&&"#"==cur.q.substr(0,1))&&(cur.wasScroll=!1)},feedEntriesHTML:{},feedUnreadCount:0,feedInitialTitle:"",feedUnread:[],feedToSort:[],feedEls:{wrap:(0,k.ge)("main_feed"),wall:(0,k.ge)("feed_wall"),search:(0,k.ge)("search_query"),rmenu:(0,k.ge)("feed_rmenu"),newPosts:(0,k.ge)("feed_new_posts")}}),cur.nav.push((function(e,t,s,o){if(void 0!==e[0])return;let i=(0,L.clone)(s);if(delete i[0],void 0===e.section||(0,L.inArray)(cur.section,["notifications","replies"])==(0,L.inArray)(e.section,["notifications","replies"])){if("notifications"==cur.section)return de.switchNotifyList(s.list||"all",(0,L.extend)(i,o.params||{})),!1;if(e.list)return de.switchList(e.list),!1;if(void 0!==e.section&&de.switchSection(e.section||"news",!1,!0),e.notify)return!1;if(e.q)return(0,k.val)(cur.feedEls.search,e.q),de.onFeedSearch(cur.feedEls.search),!1;if(delete e.subsection,(0,R.isEmpty)(e)){let e=(0,k.geByClass1)("feed_section_"+(t.section||"news")+(t.list||""));e&&uiRightMenu.go(e,!1,!1)}return cur.likesTabTT&&cur.likesTabTT.destroy(),(0,ee.isFeedPostDurationStatsFixEnabled)()&&de.onFeedPageLeaveHandler(),window.Feed?.viewStats?.onNav(),de.go((0,L.extend)(i,o.params||{})),!1}})),cur.idleManager.onUnIdle=de.updateTitle,cur.idleManager.onIdle=de.reSortItems,cur.options=cur.options||{},(0,L.extend)(cur.options,e),de.applyOptions(e,3),cur.rowsCont=e.wallCont=(0,k.ge)("feed_rows"),Wall.init(e),cur.rowsCont&&cur.rowsCont.children&&(0,L.each)(cur.rowsCont.children,(function(){let e=this;(0,k.hasClass)(e,"feed_row")&&e.firstChild&&de.onPostLoaded(e,!0)})),cur._back={text:_.getLang("news_return_to_news"),show:[de.startEvents],hide:[function(){clearInterval(cur.updateInt),(0,b.removeEvent)(window,"scroll",de.scrollCheck),(0,b.removeEvent)(window,"resize",de.scrollCheck),(0,ee.isFeedPostDurationStatsFixEnabled)()&&de.onFeedPageLeaveHandler(),cur.idleManager.stop(),clearTimeout(cur.lp_error_to),window.cur.feedScrollCheckIntervalID&&clearInterval(window.cur.feedScrollCheckIntervalID),window.Feed?.viewStats?.onNav()}],loc:!1},de.startEvents(e),(0,$.initCheckValidationPhoneLoader)(),(0,X.initUnbanRecommendationLoader)(),(0,x.friendsRecommLogSend)(!0),setTimeout((function(){de._scrollCheck({type:"init"})}),200);try{const e=nav.objLoc.storybox;if(e){const t=JSON.parse(atob(e));t&&(0,te.storyPublisherInitAsync)([{photoUrl:t.url?t.url:t.blob,stickers:t.stickers,attachment:t.attachment,serviceInfo:t.service_info,...t}])}}catch(e){console.log(e)}(0,ne.setFeedInitiated)()},startEvents:function(){cur.idleManager.start(),cur.updateInt=setInterval((function(){de.update(0)}),2e4),(0,ie.isFeedViewStatsEnabled)()&&window.Feed?.viewStats?.initObserving(),(0,b.addEvent)(window,"scroll",de.scrollCheck),(0,b.addEvent)(window,"resize",de.scrollCheck),cur?.options?.pagination_time_interval_check_enabled&&(0,l.feedPaginationIntervalCheckInit)((function(){de._scrollCheck()}))},onFeedPageLeaveHandler:()=>{window.cur.topRow&&Page.postsUnseen([(0,H.postsGetRaws)(window.cur.topRow)])},mentionClick:function(e,t){let s=e,o=((e.getAttribute("mention")||"").match(/^bp(-?\d+_\d+)$/)||{})[1];if(!o)return nav.go(e,t);for(o=o.split("_");e;e=e.parentNode){let i=(e.id||"").match(/^replies(-?\d+_topic\d+)$/);if(i){if(i[1].split("_")[0]==o[0])return Wall.showReply(s,i[1],o[0]+"topic_"+o[1],t);break}}return nav.go(e,t)},toggleCustomFeedTab:function(e,t){return(0,k.hasClass)(e,"feed_tab_link_hidden")?((0,k.removeClass)(e,"feed_tab_link_hidden"),(0,m.setCookie)("remixcustom_feed_added",t)):(0,C.lockButton)(e),de.checkTabsFilter((0,k.geByClass1)("_feed_custom_"+t),t)},recomSubscribe:function(e,t,s){let o,i,n=s?t:(0,k.domPS)(t),r=s?(0,k.domNS)(t):t;s?(o="/al_feed.php",i={act:"subscr",oid:e,from:nav.objLoc.section,hash:(0,k.val)("feed_recom_hash")}):(o="/al_fans.php",i={act:"unsub",oid:e,hash:(0,k.val)("feed_recom_hash"),no_response:1}),ajax.post(o,i,{onDone:function(){(0,k.toggle)(n,!s),(0,k.toggle)(r,!!s),"recommended"!=nav.objLoc.section&&nav.go(nav.objLoc,!1,{params:{norecom:1}})},showProgress:()=>(0,C.lockButton)(t),hideProgress:()=>(0,C.unlockButton)(t)})},clickBlogReminder:function(e,t,s,o,i,n){if(ajax.post("blog.php",{act:"click_reminder",hash:o,nid:t,accept:1,target:n},{onDone:function(){}}),"_blank"!==(0,k.attr)(e,"target"))return(0,b.cancelEvent)(i),nav.go(s)},hideBlogReminder:function(e,t,s,o){s&&(0,b.cancelEvent)(s),(0,k.re)("feed_blog_reminder"),ajax.post("blog.php",{act:"hide_reminder",hash:e,nid:t,accept:0,target:o},{onDone:function(){}})},preloadVideos:function(e){function t(e){let t=new XMLHttpRequest;t.open("GET",e),t.send()}e&&cur.videoAutoplayScrollHandler&&(cur.videoAutoplayPreloaded=cur.videoAutoplayPreloaded||{},(0,L.each)(e,(function(e,s){t(s.index_url),t(s.index_url.replace(/index-(.+).m3u8/,"seg-1-$1.ts")),cur.videoAutoplayPreloaded[s.video]=s.quality})))},expandJoinedGroups:function(e,t){return(0,b.cancelEvent)(t),(0,k.show)((0,k.geByClass1)("feed_groups_hidden_list",e.parentNode)),(0,k.re)(e),!1},showAllFilters:function(e){(0,k.re)(e);let t=(0,k.geByClass)("hide",e.parentNode);for(let e=0;e<t.length;e++)(0,k.removeClass)(t[e],"hide")},toggleSubscription:function(e,t,s,o,i){let n=(0,k.domClosest)("_ui_menu_wrap",e);n&&uiActionsMenu.toggle(n,!(0,k.hasClass)(n,"shown")),Page.toggleSubscription(e,t,s,o,i,(function(e,t){(0,k.geByClass)("post",cur.rowsCont).forEach((function(s){let i=s.id.split("_"),n=+i[i.length-2].replace("post","");if(o!==n)return;let r=(0,k.geByClass1)("page_action_subscribe",s);(0,k.val)(r,e),(0,k.domData)(r,"act",t)}))}))},onPostLoaded:function(e,t){Wall.onPostLoaded(e,t),this.initPrettyCardGallery(e),t&&!(0,k.hasClass)(e,"_post")&&de.initPhotoCarouselInPost((0,k.geByClass1)("_post",e))},openPostSuggest:function(e,t,s){if(t&&null!=t.type)switch(t.type){case 1:const i=t.postData,n=t.notHideByClick;let r=(0,k.ge)("post_field");return void((r?(0,L.trim)(r.innerHTML).replace("<br>",""):"")||cur.wallAddMedia&&cur.wallAddMedia.attachCount()?(0,P.showFastBox)({title:_.getLang("news_suggest_alert_title")},_.getLang("news_suggest_alert_text"),_.getLang("global_yes"),(function(){(0,w.curBox)().hide(),o(i,n)}),_.getLang("global_cancel")):o(i,n));case 4:return window.open(t.link),void de.suggestionEvent(e,"open",s,t.notHideByClick)}function o(t,o=!1){cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),cur.options&&(cur.options.situational_suggest_id=e),t[0]=t[0].replace(/<br>/g,"\n");let i=cur.editing;delete cur.editing,Wall.setDraft(t),de.suggestionEvent(e,"open",s,o),cur.editing=i}},suggestionEvent:(e,t,s,o)=>(ajax.post("al_feed.php",{act:"suggestion_event",suggest_id:e,event_type:t,not_hide_by_click:(0,L.intval)(o)}),o||(0,k.re)((0,k.geByClass1)("_post_suggest")),(0,b.cancelEvent)(s)),closePostSuggest(e,t,s){de.suggestionEvent(e,t,s,!1)},hideRightBlock:se.hideRightBlock,initPrettyCardGallery:function(e){if(!(0,k.geByClass1)("pretty-cards",e))return!1;window.PrettyCardGallery&&new window.PrettyCardGallery(e)},initPhotoCarouselInPost(e){e&&(0,q.initPhotoBlockInPostLoader)(e,de.sendPhotoCarouselEvent.bind(de)).then((t=>{(0,k.data)(e,"photo_carousel",t),(0,Z.pushNavDestroy)((()=>{(0,k.removeData)(e,"photo_carousel")}))}))},destroyPhotoCarouselByPost(e){const t=(0,k.data)(e,"photo_carousel");t&&t.destroy()},sendPhotoCarouselEvent(e,t,s=null){if(!t)return;const o=t?.getAttribute("data-post-id");if(!o)return;let i="",n="";const r=o.match(/1_(-?\d+)_(\d+)/);if(!r||!r[1]||!r[2])return;i=r[1],n=r[2];let a=t.getAttribute("data-photo-raw-id");const c=t.getAttribute("data-pseudopost-type"),l=t.getAttribute("data-post-creation-timestamp");if(!a&&"photo_group"===c&&s){const e=s.target;if(e&&e.href){const t=e.href.match(/\/photo(-?\d+_\d+)/);a=t&&t[1]}}const d=de.getModuleRef(),u=(0,ne.getTrackCodeFromPost)(t),_={event_type:e,content_type:c,post_owner_id:i,post_id:n,photo_raw_id:a,timestamp:l,ref:d};u&&Object.assign(_,{track_code:u}),(0,T.statlogsValueEvent)("feed_new_carousel_stat",_)},disablePhotoRecognizeBlock(e){const t=document.getElementById(`${N.BlockTypeIds.PhotoRecognize}`);t&&(cur.feedEntriesHTML[`${N.BlockTypeIds.PhotoRecognize}_ignored`]=(0,k.val)(t),ajax.post("al_feed.php",{act:"disable_recognize_block",hash:e},{onDone:e=>{(0,k.val)(t,e)}}))},enablePhotoRecognizeBlock(e){const t=document.getElementById(`${N.BlockTypeIds.PhotoRecognize}`);t&&ajax.post("al_feed.php",{act:"enable_recognize_block",hash:e},{onDone:()=>{(0,k.val)(t,cur.feedEntriesHTML[`${N.BlockTypeIds.PhotoRecognize}_ignored`])}})},initRightBlocks:e=>{(0,K.initFeedRightBlocksLoader)(e)}};de.scrollCheck=(0,o.throttle)(de._scrollCheck,50)},646096:(e,t,s)=>{s.d(t,{longView:()=>c});var o=s(447836),i=s(98962),n=s(70689),r=s(636322);let a={tracking:[],viewed:{}};const c={process:(e,t)=>{const{tracking:s,viewed:c}=a;if(0===s.length)return[];let l=[];return(0,r.each)(s,(function(s,a){let d=(0,n.domFC)(a),u=d?.id;if(!d||!u)return;let _=(0,i.getAdAttribute)(d,"ad-block-uid"),h=""+u;if(_&&(h+="_"+_),!c[h]&&document.body.contains(a))if((0,o.isElemViewable)(a,.5,e,t)){let e=Date.now();a.longViewStartedAt?e-a.longViewStartedAt>=1e3&&(c[h]=!0,l.push((0,r.extend)({},(0,o.postsGetRaws)(a),{long:1}))):a.longViewStartedAt=Date.now()}else a.longViewStartedAt=null})),l},registerElement:e=>!!e&&(!!e.longViewTracking||!e.longViewRegistered&&(e.longViewRegistered=!0,e.longViewTracking=(0,o.isAutoplayAd)(e)||(0,o.isAdWithLongImpression)(e)||(0,o.isAdWithLongImpressionOnly)(e),!!e.longViewTracking&&(a.tracking.push(e),!0)))}},907860:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{evalWithLogging:()=>evalWithLogging});var _web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(379440);const evalWithLogging=evalString=>{try{return eval(evalString)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__.logEvalError)(e,evalString)}}},63809:(e,t,s)=>{s.d(t,{apiStatEventsAddWeb:()=>i});var o=s(166695);function i(e){return(0,o.api)("statEvents.addWeb",e)}},885067:(e,t,s)=>{s.d(t,{calculateElementSize:()=>o});const o=e=>{if(!e)return{width:0,height:0};const t=e.getBoundingClientRect();return{width:t.width,height:t.height}}},820841:(e,t,s)=>{s.d(t,{getFeedStatsVisibilityThreshold:()=>i,visibilityThresholdConfig:()=>o});const o={up:{visible:.35,invisible:.65},down:{visible:.35,invisible:.65}};function i(e,t){return o[t][e?"invisible":"visible"]}},747487:(e,t,s)=>{s.d(t,{FeedViewStatsCollector:()=>h,isFeedViewStatsCollectorEnabled:()=>f});var o=s(322695),i=s(324153),n=s(180937),r=s(288824),a=s(597978),c=s(977053),l=s(63809);const d="feed_content_views_stat_events_key";const u=function(e){function t(s){if("locked"===a.vkSessionStorage.getItem(e))setTimeout((()=>{t(s)}),100);else{a.vkSessionStorage.setItem(e,"locked");try{s()}catch(e){}a.vkSessionStorage.setItem(e,"free")}}return e=>t(e)}("feed_content_views_stat_events_lock_key"),_=(0,r.makeSharedState)("feed_stats_collector",(()=>({is_stats_send_scheduled:!1})),{version:0});class h{async sendEvent(){const e=n.multiAccountLs.get(d);if(!e||Array.isArray(e)&&0===e.length)return;const t=e.length;try{await(0,l.apiStatEventsAddWeb)({events:JSON.stringify(e)})}catch{}return new Promise((e=>u((()=>{const s=n.multiAccountLs.get(d).slice(t);n.multiAccountLs.set(d,s),e("ok")}))))}scheduleSend(){_().is_stats_send_scheduled||(_().is_stats_send_scheduled=!0,setTimeout((()=>{this.sendEvent().then((()=>{_().is_stats_send_scheduled=!1}))}),5e3))}prepareEvent(e){return{...(new o.ProductionStatCollector).getBaseEvent(e?.screen),type:i.ProductionStatEventTypes.TYPE_VIEW,[i.ProductionStatEventTypes.TYPE_VIEW]:{item:e.eventItem,...e.viewEvent}}}logEvent(e){u((()=>{let t=n.multiAccountLs.get(d);t?t.push(e):t=[e],n.multiAccountLs.set(d,t),this.scheduleSend()}))}sendPreviousEvents(){return this.sendEvent()}}function f(){return(0,c.partConfigEnabled)("feed_content_views_feed_stat_collector_client_web")}},739543:(e,t,s)=>{s.d(t,{IntersectionObserverPostView:()=>o});class o{initObserver(e,t){if(this.observer)return;let s={root:e,rootMargin:`${t?.headerHeight??0}px 0px ${t?.bottomMenuHeight}px 0px`,threshold:t?.threshold??.35};this.observer=new IntersectionObserver((e=>{e.forEach((e=>{const t=e.isIntersecting,s=this.postElements.get(e.target);s&&e.target&&(s.callbacks?.forEach((s=>s?.(e.target,t))),this.postElements.set(e.target,s))}))}),s)}observe(e,t){const s=this.postElements.get(e);s?t&&(s.callbacks.push(t),this.postElements.set(e,{callbacks:s.callbacks})):(this.postElements.set(e,{callbacks:t?[t]:[]}),this.observer?.observe(e))}unobserve(e){this.postElements.delete(e),this.observer?.unobserve(e)}destroy(){this.postElements.clear(),this.observer?.disconnect()}refresh(e){this.observer?.unobserve(e),this.observer?.observe(e)}constructor(){this.postElements=new Map}}},866303:(e,t,s)=>{s.d(t,{ObservingPost:()=>i});var o=s(794548);class i{resetTime(){this._startView=-1,this._endView=-1}setSeenState(){this.state="seen",this._endView=Date.now(),this._duration=this._endView-this._startView,this.onEndViewCallback?.(this)}setVisibleState(){this.state="visible",this._startView=Date.now(),this.onStartViewCallback?.(this)}setInvisibleState(){this.state="invisible",this.resetTime()}updateBlockStatsSeen(){this._isBlockStatsSeen=!0}updateVisibility(e){"visible"===this.state&&"invisible"===e?this.setSeenState():"invisible"===this.state&&"visible"===e?this.setVisibleState():"reset"===e?this.setInvisibleState():"visible"===this.state&&"forceEndView"===e&&this.setSeenState()}calculateVisibility({viewPortData:e,scrollDirection:t,clientHeight:s}){const i=this._el?.getBoundingClientRect();if(!i)return this;const{isVisible:n}=(0,o.checkPostVisibility)(i,e,t,s,"seen"===this.state);return this.updateVisibility(n?"visible":"invisible"),this}getState(){return this.state}get startView(){return this._startView}get endView(){return this._endView}get el(){return this._el}get duration(){return this._duration}get width(){return this._width}get height(){return this._height}get id(){return this._id}get postId(){return this._postId}get index(){return this._index}get trackCode(){return this._trackCode}get screen(){return this._screen}get itemType(){return this._itemType}get block(){return this._block}get long(){return this._long}get hash(){return this._hash}get adView(){return this._adView}get isBlockStatsSeen(){return this._isBlockStatsSeen}get isAdsPostClicked(){return this._isAdsPostClicked}get postBoundingClientRect(){return this._postBoundingClientRect}constructor(e,t){this._startView=-1,this._endView=-1,this.state="invisible",this._postBoundingClientRect=e.getBoundingClientRect(),this._el=e,this._width=Math.round(this._postBoundingClientRect.width),this._height=Math.round(this._postBoundingClientRect.height),this._id=t.id,this._postId=t.postId,this._index=t.index,this._trackCode=t.trackCode,this._screen=t.screen,this._itemType=t.itemType,this._block=t.block,this._adView=t.adView,this._hash=t.hash,this._isBlockStatsSeen=!1,this._isAdsPostClicked=!1,this.onStartViewCallback=t.onStartView,this.onEndViewCallback=t.onEndView}}},427729:(e,t,s)=>{s.d(t,{FeedPostsStats:()=>l});var o=s(290559),i=s(324153),n=s(794548),r=s(233227),a=s(747487),c=s(322695);class l{getPostById(e){return this.observingPosts.find((t=>t?.el.id===e))}onEndView(e){e&&this.flushSeenPost(e)}flushSeenPost(e){const t=this.prepareStatsEvent(e);t?setTimeout((()=>{this.sendToViewStats(t),this.viewLogger?.logImportant("post stats logged to collector",t),this.platformContext?.onFlushSeenPost(e),this.resetViewState(e)}),0):this.resetViewState(e)}resetViewState(e){setTimeout((()=>{e.updateVisibility("reset"),this.intersectionObserver?.refresh(e.el),this.viewLogger?.log("reset post view state",e)}),this.resetViewStateTimer)}prepareStatsEvent(e){if(-1===e.endView||-1===e.startView)return void this.viewLogger?.log("view not started or ended",e);if(!e.trackCode)return void this.viewLogger?.log("no trackcode or postId",e);if(e.itemType===i.EventItemType.ADS)return void this.viewLogger?.log("cannot send ads type",e);const t={position:e.index,end_view:(0,n.convertViewTimeToMicroseconds)(e.endView),start_view:(0,n.convertViewTimeToMicroseconds)(e.startView),type:i.ViewProductionStatEventTypes.TYPE_FEED_ITEM,[i.ViewProductionStatEventTypes.TYPE_FEED_ITEM]:{event_type:e.itemType,width:e.width,height:e.height}},s=e.postId?.split("_").map(Number);return{viewEvent:t,eventItem:{type:e.itemType,id:s?.[1],owner_id:s?.[0],track_code:e.trackCode},screen:e.screen?(0,r.convertWebFeedRefToStatsScreen)(e.screen):""}}sendToViewStats(e){e?.viewEvent&&((0,a.isFeedViewStatsCollectorEnabled)()?this.feedViewStatsCollector.logEvent(this.feedViewStatsCollector.prepareEvent(e)):this.viewStatCollector.logEvent(e.viewEvent,e?.eventItem,e.screen))}removePostFromTracking(e,t){const s=this.getPostById(e.id);s&&(this.flushSeenPost(s),this.viewLogger?.log(t),this.intersectionObserver?.unobserve(e))}initPosts(e,t,s){if(!e||0===e.length)return void this.viewLogger?.log("(initPosts) posts length is zero or no posts at all = %o",e);const i=Array.from(e);this.viewLogger?.log("(initPosts) arrPosts.length = %d",i.length),this.observingPosts=i.map(((e,i)=>{const n=(0,o.getPostElementBySelector)(this.platformContext?.selectors.postSelector??"",e);if(!n)return null;const r=this.observingPosts[i];if(r&&r.width>0&&r.height>0)return this.viewLogger?.log("(initPosts) observingPost exists",r),r;const a=this.platformContext?.createObservingPost(n,i,{onEndView:e=>{this.onEndView(e),s(e)},onStartView:e=>{t(e)}});return a?0===a.width||0===a.height?(this.viewLogger?.log("(initPosts) observingPost width and height are ZERO",a),null):(this.observePost(a),a):(this.viewLogger?.log("(initPosts) observingPost is null",n),null)})),this.viewLogger?.log("(initPosts) observingPosts length = %d",this.observingPosts.length),this.postsLength=i.length}unseenPosts(){const e=[];for(let t of this.observingPosts)t&&"visible"===t.getState()&&(e.push(t),t.updateVisibility("forceEndView"));return e}observePost(e){this.intersectionObserver?.observe(e.el,((t,s)=>{e.updateVisibility(s?"visible":"invisible")}))}pausePostsObserving(){if(this.intersectionObserver){for(let e of this.observingPosts){const t=e?.el;t&&this.intersectionObserver.unobserve(t)}this.unseenPosts()}}unpausePostsObserving(){for(let e of this.observingPosts)e&&this.observePost(e)}getPostsLength(){return this.postsLength}cleanData(){this.observingPosts=[],this.postsLength=0}constructor(e){this.observingPosts=[],this.postsLength=0,this.resetViewStateTimer=2500,this.intersectionObserver=null,this.viewLogger=null,this.productionStatCollector=new c.ProductionStatCollector,this.viewStatCollector=new c.ViewStatCollector(this.productionStatCollector),this.intersectionObserver=e.intersectionObserver,this.viewLogger=e.viewLogger,this.platformContext=e.platformContext,this.feedViewStatsCollector=e.feedViewStatsCollector}}},689295:(e,t,s)=>{s.d(t,{feedViewStatsState:()=>o,isFeedViewStatsExist:()=>i});const o=(0,s(288824).makeSharedState)("feed-view-stats",(()=>({feedViewStatsInstance:null})),{version:0}),i=e=>!!e},55177:(e,t,s)=>{s.d(t,{FeedViewStats:()=>r});var o=s(198448),i=s(747487),n=s(427729);class r{static new(e){return new r(e)}observe(e){"stopped"===this.observingState&&(this.feedViewStatsCollector.sendPreviousEvents(),this.initViewPortData(),this.intersectionObserver?.initObserver(e??null,{threshold:this.platformContext.intersectionThreshold,bottomMenuHeight:this.viewPortData?.bottomMenuHeight,headerHeight:this.viewPortData?.headerHeight}),this.initVisibilityHandlers(),this.initWkLayerHandler(),this.viewLogger?.logState("observing",""),this.observingState="observing")}unpause(){"observing"!==this.observingState&&(this.postsStats.unpausePostsObserving(),this.observingState="observing",this.viewLogger?.logState("observing",""))}pause(){"paused"!==this.observingState&&(this.postsStats.pausePostsObserving(),this.observingState="paused",this.viewLogger?.logState("paused",""))}stop(){this.postsStats.unseenPosts(),this.postsStats.cleanData(),this.intersectionObserver?.destroy(),this.cleanData(),this.cleanUpEventHandlers(),this.viewLogger?.logState("stopped",""),this.observingState="stopped"}initWkLayerHandler(){this.platformContext.initPostModalHandler?.((()=>{this.viewLogger?.log("wklayer closed"),this.unpause()}))}setDocumentElementProperties(){this.clientHeight=document.documentElement.clientHeight,this.scrollTop=document.documentElement.scrollTop}initViewPortData(){const e=()=>{const e=document.querySelector(".BottomMenu .BottomMenu__fixed"),t=document.querySelector("#page_header"),s=e?.offsetHeight??0,o=t?.offsetHeight??0;this.viewPortData={bottomMenuHeight:s,headerHeight:o}};e();const t=(0,o.debounce)(e.bind(this),60);this.eventHandlersCleanupFunctions.resize?.(),window.addEventListener("resize",t),this.eventHandlersCleanupFunctions.resize=()=>{window.removeEventListener("resize",t)}}initVisibilityHandlers(){const e=()=>{this.stop()},t=()=>{"hidden"===document.visibilityState?this.pause():"visible"!==document.visibilityState||this.platformContext.isPostModalOpened||this.unpause()};window.addEventListener("visibilitychange",t),window.addEventListener("pagehide",e),this.eventHandlersCleanupFunctions.visibilitychange=()=>{window.removeEventListener("visibilitychange",t)},this.eventHandlersCleanupFunctions.pagehide=()=>{window.removeEventListener("pagehide",e)}}getDirection(){let e="down";return this.scrollTop>this.lastScrollTop?e="down":this.scrollTop<this.lastScrollTop&&(e="up"),this.lastScrollTop=this.scrollTop<=0?0:this.scrollTop,e}cleanUpEventHandlers(){for(let e of Object.values(this.eventHandlersCleanupFunctions))e()}onPostEndView(e){e&&(this.viewLogger?.resetViewTimer(e,this.scrollDirection),this.viewLogger?.logEndView(e,this.scrollDirection),this.platformContext?.onViewEnded(e))}onPostStartView(e){e&&(this.viewLogger?.logStartView(e,this.scrollDirection),this.viewLogger?.initViewTimer(e,this.currentPosts,this.scrollDirection),this.platformContext?.onViewStarted(e))}initObserving(){"stopped"===this.observingState&&(this.viewLogger?.log("Init observing"),this.observe(null))}checkScroll(e){if("observing"!==this.observingState)return;this.setDocumentElementProperties();const t=this.getDirection();e.length===this.postsStats.getPostsLength()&&t===this.scrollDirection||(this.currentPosts=Array.from(e),this.postsStats.initPosts(e,this.onPostStartView.bind(this),this.onPostEndView.bind(this))),this.scrollDirection=t,this.platformContext.onScroll(this.clientHeight,this.scrollTop)}cleanData(){this.viewPortData=null}onIgnorePost(e){e&&this.postsStats.removePostFromTracking(e,"post ignored")}onReport(e){e&&this.postsStats.removePostFromTracking(e,"post reported")}onNav(){this.stop(),this.platformContext.onNav(),this.viewLogger?.log("navigated")}onWkLayer(e){this.pause(),this.viewLogger?.log(`opened wk layer with id = ${e}`)}constructor(e){this.lastScrollTop=0,this.viewPortData=null,this.scrollDirection="down",this.eventHandlersCleanupFunctions={},this.clientHeight=0,this.scrollTop=0,this.observingState="stopped",this.intersectionObserver=null,this.feedViewStatsCollector=new i.FeedViewStatsCollector,this.viewLogger=e.viewLogger,this.platformContext=e.platformContext,this.intersectionObserver=e.intersectionObserver,this.postsStats=new n.FeedPostsStats({platformContext:this.platformContext,viewLogger:this.viewLogger,intersectionObserver:this.intersectionObserver,feedViewStatsCollector:this.feedViewStatsCollector}),this.viewLogger?.log("FeedViewStats constructor")}}},794548:(e,t,s)=>{s.d(t,{checkPostVisibility:()=>i,convertViewTimeToMicroseconds:()=>n});s(885067);var o=s(820841);function i(e,t,s,i,n=!1){return function(e,t,s,o=1){const i=s-t.bottomMenuHeight-t.headerHeight,n=e.top>=t.headerHeight,r=e.bottom<=i,a={isVisible:!0,visiblePostPart:1};if(n&&r)return a;const c=s<e.bottom?e.bottom-s:0,l=e.top<0?-e.top:0;if(c>0&&l>0)return a;const d=e.height-c-l,u=d*e.width,_=e.height*e.width,h=u/_;return{isVisible:h>=o,visiblePostPart:h}}(e,t,i,(0,o.getFeedStatsVisibilityThreshold)(n,s))}function n(e){return String(1e3*e)}},380526:(e,t,s)=>{s.d(t,{KEY:()=>o,checkEvent:()=>n,isMainClick:()=>i,preventLinkOpening:()=>r});const o={LEFT:37,UP:38,RIGHT:39,DOWN:40,DEL:8,TAB:9,RETURN:13,ENTER:13,ESC:27,PAGEUP:33,PAGEDOWN:34,SPACE:32,CTRL:17,ALT:18,SHIFT:16,META_LEFT:91,META_RIGHT:93};function i(e){return!("click"!==e.type&&"mousedown"!==e.type&&"mouseup"!==e.type||0!==e.button||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)}function n(e){return!!(e&&e instanceof MouseEvent)&&!i(e)}const r=e=>new Promise((t=>{i(e instanceof MouseEvent?e:e.nativeEvent)&&(e.stopPropagation(),e.preventDefault(),t())}))},859927:(e,t,s)=>{s.d(t,{getPerformanceStatsEventMomentData:()=>i});var o=s(371774);const i=()=>{const e=performance.now?.();if(void 0===e)return;return{eventTime:e,network:o.default.getConnectionEffectiveType()}}},345524:(e,t,s)=>{s.d(t,{getPerformanceStatsTools:()=>n});var o=s(859927),i=s(763111);function n({module:e=i.navigationStat.getModule(),page:t,entity:n,cooldownRecord:r}={}){if(!window.performance||"visible"!==window.document.visibilityState)return Promise.resolve();const a=(0,o.getPerformanceStatsEventMomentData)();return a?s.e(59240).then(s.bind(s,192830)).then((({configurePerformanceStatsUtils:s,navigationStat:i,PerformanceStatsEventName:c,AuxiliaryPerformanceStatsEventName:l,LeavingFeedEventName:d})=>{if(!i.getModule)return;const{storePerformanceStats:u,sendStoredPerformanceStats:_,readMetricValue:h}=s({...a,module:e,page:t,entity:n,cooldownRecord:r});if(!h(c.load_performance_stats_chunk)){const e=(0,o.getPerformanceStatsEventMomentData)();u(c.load_performance_stats_chunk,e),_()}return{storePerformanceStats:u,sendStoredPerformanceStats:_,readMetricValue:h,PerformanceStatsEventName:c,AuxiliaryPerformanceStatsEventName:l,LeavingFeedEventName:d}})):Promise.resolve()}},570599:(e,t,s)=>{s.d(t,{trackTmrFeedPostView:()=>a});var o=s(963526),i=s(977053);const n=6,r="tmrPostViewEnabledAllPosts";function a(){(0,i.partConfigEnabled)("web_mytracker_collect_post_stats")&&function(){const e=window.cur,t=e?.[r];if(t)return!0;return!1}()&&(0,o.tmrSendTimespentEvent)(n)}},986450:(e,t,s)=>{function o(e){return new Promise((t=>setTimeout(t,e)))}s.d(t,{sleep:()=>o})},78839:(e,t,s)=>{s.d(t,{storyPublisherInitAsync:()=>i});var o=s(251087);function i(e){(function(e){const t=!0,s=(0,o.showBoxLoader)();return e.then((e=>t&&(0,o.isBoxLoadingCancelled)(s)?n:((0,o.isBoxLoadingCancelled)(s)||(0,o.hideBoxLoader)(),e)),(e=>((0,o.hideBoxLoader)(),Promise.reject(e))))})(window.stManager.add([window.jsc("web/story_publisher.js")])).then((t=>{(function(e){return e===n})(t)||window.StoryPublisher.init(...e)}))}const n="showBoxLoaderForPromise cancelled"},695526:(e,t,s)=>{var o=s(802130),i=s(396155),n=s(71938),r=s(448921);window.vk?.pe?.static_manager_dynamic_imports&&window.vk?.stDomain&&(s.p=window.vk.stDomain+"/dist/"),window.feed=i.Feed,window.Feed=i.Feed,(0,n.initCaptionInteractiveHandlers)(),(0,r.initCommentsHandlers)();try{window.stManager.done(window.jsc("web/feed.js"))}catch(e){}requestIdleCallback((()=>{try{(0,o.statlogsValueEvent)("entries_requests",1,"feed","web")}catch{}}),{timeout:5e3})},521471:(e,t,s)=>{s.d(t,{hideRightBlock:()=>o.hideRightBlock,requestRightBlock:()=>o.requestRightBlock});var o=s(450148)},450148:(e,t,s)=>{s.d(t,{hideRightBlock:()=>g,requestRightBlock:()=>p});var o,i=s(907860),n=s(70689),r=s(65718),a=s(614049),c=s(851782),l=s(641546),d=s(101588),u=s(253659),_=s(970471);!function(e){e.fromDocumentRequest="from_document_request"}(o||(o={}));const h=e=>{u.debugConsole.error(e),(0,r.logError)(new Error(e))};function f(e,t,s,o){e.insertAdjacentHTML("beforeend",t),s&&(0,i.evalWithLogging)(s),function(e){e.no_left_ads&&(window.cur.no_left_ads=!0);e.is_games_in_right_block&&(window.cur.isGamesInRightBlock=!0)}(o),u.debugConsole.info("FeedPageRightBlock: right block has been shown.")}async function p({isDocumentRequest:e,params:t}){const s=(0,_.getFeedPageLoadingState)().rightBlock.setRequestStarted();try{u.debugConsole.info("FeedPageRightBlock: right block request started");const o=await c.ajax.promisifiedPost(window.nav?.toStr({...window.nav?.objLoc,0:"al_feed_right_block.php"}),{...t,from_document_request:e},{cancellationToken:s,local:e,ignoreDefaultErrorLogger:!0});if(e&&!(0,d.isPageTheSame)())return void u.debugConsole.error("FeedPageRightBlock: landing on page with different page id (document request)");if(!Array.isArray(o))return void h("FeedPageRightBlock: no array returned in response to request");const[i]=o;if(!(0,l.isLikePlainObject)(i,{html:"",js:"",no_left_ads:!1,is_games_in_right_block:!1}))return void h(`FeedPageRightBlock: invalid response: ${(0,a.stringifyUnknown)(i)}`);(0,_.getFeedPageLoadingState)().rightBlock.setRequestState("success");const{html:n,js:r,no_left_ads:p,is_games_in_right_block:g}=i;return u.debugConsole.info("FeedPageRightBlock: right block request has been completed. Data: ",i),n?e=>f(e,n,r,{no_left_ads:p,is_games_in_right_block:g}):void u.debugConsole.info("FeedPageRightBlock: no html (no right block)")}catch(e){(0,_.getFeedPageLoadingState)().rightBlock.setRequestState("error"),h(`FeedPageRightBlock: error loading block. Error: ${(0,a.stringifyUnknown)(e)}`)}}function g(e,t,s){let o=(0,n.domCA)(e,".page_block");return(0,n.re)(o),window.cur.isGamesInRightBlock=!1,window.ajax.post("al_feed.php",{act:"a_hide_right_block",block_type:t,app_id:e.dataset.app_id||0,hash:s}),!1}},71938:(e,t,s)=>{s.d(t,{initCaptionInteractiveHandlers:()=>l});var o=s(234173),i=s(105940),n=s(199777),r=s(30655),a=s(41578);function c(e){const t=(0,i.getTrackCodeFromPost)(e);(0,n.sendCaptionLinkClickEvent)(t,(0,i.resolveRefFromCur)())}function l(){(0,o.tq)().setInteractiveHandler("Post/captionClickMention",(e=>{const t=e.payload.target;t&&(c(t),(0,r.mentionClick)(t,e.payload.event))})),(0,o.tq)().setInteractiveHandler("Post/captionClick",(e=>{const t=e.payload.target;t&&(c(t),a.default.go(t,e.payload.event))})),(0,o.tq)().setInteractiveHandler("Post/captionClickStats",(e=>{const t=e.payload?.event?.target??e.payload.target;t&&"A"===t.tagName&&c(t)}))}},640009:(e,t,s)=>{function o(e,t){return s.e(15302).then(s.bind(s,281392)).then((({initPhotoBlockInPost:s})=>s(e,t)))}s.d(t,{initPhotoBlockInPostLoader:()=>o})},649809:(e,t,s)=>{s.d(t,{initFeedRightBlocksLoader:()=>i});var o=s(636322);const i=e=>{const t=(0,o.vkLocal)((t=>t(e)));Promise.all([s.e(2067),s.e(20795),s.e(53290)]).then(s.bind(s,758087)).then((({initFeedRightBlocks:e})=>{t(e)}))}},447785:(e,t,s)=>{var o;s.d(t,{BlockTypeIds:()=>o}),function(e){e.YoulaRecommendationsCarousel="block_youla-recommendations-carousel",e.AliExpressRecommendationsCarousel="block_aliexpress-recommendations-carousel",e.PhotoRecognize="tags_suggestions",e.RecommendedNarratives="recommended_narratives",e.BookmarkGame="bookmark_game",e.AchievementGame="achievement_game",e.VideosForYou="videos_for_you",e.VideoPostcard="video_postcard",e.UXPollBlock="uxpoll_block"}(o||(o={}))},119966:(e,t,s)=>{s.d(t,{LEAVING_FEED_STATS:()=>o});const o="leaving_feed_stats"},7278:(e,t,s)=>{s.d(t,{feedHtmlPaintingStats:()=>l,feedLoadingStats:()=>c,requestContentStats:()=>d});var o=s(977053),i=s(345524),n=s(753167),r=s(119966),a=s(859927);async function c({collect_stats:e,is_loaded_from_page_skeleton:t}){if(!e||!(0,o.partConfigEnabled)("feed_web_performance_stats"))return;(0,o.partConfigEnabled)("web_navigation_listeners")&&async function(){const e=await(0,i.getPerformanceStatsTools)({module:"feed",entity:r.LEAVING_FEED_STATS});if(!e)return;const{storePerformanceStats:t,sendStoredPerformanceStats:s,readMetricValue:o,LeavingFeedEventName:c}=e;window.setTimeout((()=>{if(!Object.keys(c).some(o)){const e=(0,a.getPerformanceStatsEventMomentData)();t(c.stay_in_feed,e),s(),window.nav.removeNavigationStartListener(n.onNavigationStart)}}),12e4)}();const s=await(0,i.getPerformanceStatsTools)({module:"feed"});if(!s)return;const{storePerformanceStats:c,sendStoredPerformanceStats:l,PerformanceStatsEventName:d,AuxiliaryPerformanceStatsEventName:u}=s;c(d.render_content),c({metricName:d.render_content_without_ttfb,basisMetricName:d.render_content,auxiliaryMetricName:u.TTFB}),t?(c(d.render_content_after_skeleton),c({metricName:d.render_content_after_skeleton_without_ttfb,basisMetricName:d.render_content_after_skeleton,auxiliaryMetricName:u.TTFB}),c({metricName:d.render_content_after_skeleton_without_skeleton,basisMetricName:d.render_content_after_skeleton,auxiliaryMetricName:d.render_skeleton}),c({metricName:d.render_content_after_skeleton_without_paint_content_html,basisMetricName:d.render_content_after_skeleton,auxiliaryMetricName:d.paint_content_html})):(c(d.render),c({metricName:d.render_without_ttfb,basisMetricName:d.render,auxiliaryMetricName:u.TTFB})),l()}async function l(){if(!(0,o.partConfigEnabled)("feed_web_performance_stats"))return;const e=await(0,i.getPerformanceStatsTools)({module:"feed"});if(!e)return;const{storePerformanceStats:t,sendStoredPerformanceStats:s,PerformanceStatsEventName:n,AuxiliaryPerformanceStatsEventName:r}=e;t(n.paint_content_html),t({metricName:n.paint_content_html_without_ttfb,basisMetricName:n.paint_content_html,auxiliaryMetricName:r.TTFB}),s()}async function d(){if(!(0,o.partConfigEnabled)("feed_web_performance_stats"))return;const e=await(0,i.getPerformanceStatsTools)({module:"feed"});if(!e)return;const{storePerformanceStats:t,PerformanceStatsEventName:s}=e;t(s.request_content_after_skeleton)}},753167:(e,t,s)=>{s.d(t,{onNavigationStart:()=>l});var o=s(465902),i=s(345524),n=s(970471),r=s(364771),a=s(119966),c=s(636322);async function l(e,t){const s=window.nav.objLoc[0]===o.FeedPath.feed&&t[0]!==window.nav.objLoc[0];try{if(s&&(0,c.isPageFirstOneOpened)()&&!["error","timeout"].includes((0,n.getFeedPageLoadingState)().content.requestState)){const e=await(0,i.getPerformanceStatsTools)({module:"feed",entity:a.LEAVING_FEED_STATS});if(!e)return;const{storePerformanceStats:t,sendStoredPerformanceStats:s,LeavingFeedEventName:o,readMetricValue:r}=e;if(r(o.navigation_from_feed))return;t(o.navigation_from_feed),(0,n.getFeedPageLoadingState)().skeleton.hasSkeleton?t(o.navigation_from_feed_skeleton_on):t(o.navigation_from_feed_skeleton_off),["initial","loading"].includes((0,n.getFeedPageLoadingState)().content.requestState)?t(o.navigation_from_feed_before_page_load):t(o.navigation_from_feed_after_page_load),s(),window.nav.removeNavigationStartListener(l)}}catch(e){console.error("leaving feed navigation stats error"),(0,r.logUnknownError)(e)}}},471474:(e,t,s)=>{s.d(t,{feedLogFilteredRow:()=>n});var o=s(802481),i=s(278063);function n({filterReason:e,ref:t,row:s,rowsContainer:n,section:r}){const a={contentId:s.firstElementChild?.id,feedRowsCount:n.childElementCount,filterReason:e,ref:t,rowFlags:(0,i.formatStringValueBooleans)([Boolean(s.firstElementChild?.id),Boolean(s.firstElementChild)]),section:r};(0,o.saveStatlogEvents)({name:"feed_pagination_item_filtered",value:a})}},430503:(e,t,s)=>{function o(e){const t=window.cur;t.feedScrollCheckIntervalID&&clearInterval(t.feedScrollCheckIntervalID);const s=setInterval((function(){"feed"===window.cur.module?e():o()}),500);function o(){clearInterval(s)}t.feedScrollCheckIntervalID=s,setTimeout(o,5e3)}s.d(t,{feedPaginationIntervalCheckInit:()=>o})},398322:(e,t,s)=>{s.d(t,{shouldFilterPaginatedRow:()=>c});const o=/^post(-?\d+_\d+)$/,i=e=>!!e.id&&o.test(e.id),n=e=>!!e.id&&e.id.startsWith("feedback_row"),r={shouldFilter:!1},a={shouldFilter:!0,filterReason:"empty"};function c({row:e}){const t=e.firstElementChild;return t?function(e){const t=i(e),s=n(e);if(!t&&!s)return r;const o=!!e.id&&null!==document.querySelector(`#${e.id}`);if(!o)return r;return{shouldFilter:!0,filterReason:l({isNotification:s,isPost:t})}}(t):a}function l(e){return e.isNotification?"duplicate_notification":e.isPost?"duplicate_post":"duplicate_unknown"}},19946:(e,t,s)=>{s.d(t,{initCheckValidationPhoneLoader:()=>o});const o=()=>Promise.all([s.e(77794),s.e(37513)]).then(s.bind(s,120516)).then((({initCheckValidationPhone:e})=>{e()}))},93538:(e,t,s)=>{s.d(t,{initUnbanRecommendationLoader:()=>o});const o=()=>s.e(73634).then(s.bind(s,24499)).then((({initUnbanRecommendation:e})=>{e()}))},278063:(e,t,s)=>{function o(e){return e.map((e=>e?"1":"0")).join("_")}s.d(t,{formatStringValueBooleans:()=>o})},261769:(e,t,s)=>{s.d(t,{WebPlatformViewStatsContext:()=>h});var o=s(105940),i=s(199777),n=s(324153),r=s(368076),a=s(866303),c=s(820841),l=s(570599),d=s(98962),u=s(447836),_=s(658539);class h{static new(){return new h}static getItemType(e){return(0,d.getAdAttribute)(e,"ad")?n.EventItemType.ADS:n.EventItemType.POST}static getPostWithMeta(e){return e.id?.startsWith("feed_repost")?e.firstElementChild:e}cleanUpEventHandlers(){for(let e of Object.values(this.eventHandlersCleanupFunctions))e()}isAllowedPost(e){return!Boolean((0,r.findChildOrSelf)(e.el,".FeedBlockWrap"))}extractIdsFromPost(){return null}createObservingPost(e,t,s){const i=h.getPostWithMeta(e)??e,n=(0,o.getTrackCodeFromPost)(i),r=(0,o.resolveRefFromCur)();return new a.ObservingPost(e,{el:e,id:e.id,postId:i.getAttribute("data-post-id"),index:t,trackCode:n,screen:r,itemType:h.getItemType(i),onEndView:e=>{s?.onEndView?.(e)},onStartView:e=>{s?.onStartView?.(e)}})}onViewStarted(e){e&&((0,i.handleViewingPosts)({el:e.el?.parentElement}),e.isBlockStatsSeen||(0,i.handleViewingFeedBlocks)({el:e.el?.parentElement,index:e.index,ref:e.screen??"",onView:()=>{e.updateBlockStatsSeen()}}),(0,l.trackTmrFeedPostView)())}onViewEnded(e){}onScroll(e,t){let s=(0,o.resolveRefFromCur)();(0,i.feedShowMoreButtonLoadedCount)(s,t,e)}onFlushSeenPost(){}onNav(){this.cleanUpEventHandlers()}getFeedPosts(){return(0,u.getFeedPosts)("#feed_rows")}initPostModalHandler(e){const t=(0,_.handleWkViewCloseEvent)(e);this.eventHandlersCleanupFunctions.wkview_close=()=>{t()}}constructor(){this.eventHandlersCleanupFunctions={},this.isPostModalOpened=(0,_.isWkLayerWallPostOpen)(),this.selectors={postSelector:".feed_row > div"},this.intersectionThreshold=c.visibilityThresholdConfig.down.visible}}},414224:(e,t,s)=>{s.d(t,{feedViewStatsFactory:()=>c});var o=s(261769),i=s(55177),n=s(689295),r=s(105047),a=s(739543);function c(e,t){if(!(0,r.isFeedViewStatsEnabled)())return null;let s=(0,n.feedViewStatsState)().feedViewStatsInstance;if(!(0,n.isFeedViewStatsExist)(s)){const r={posts:e,platformContext:o.WebPlatformViewStatsContext.new(),rootElement:t,intersectionObserver:new a.IntersectionObserverPostView};s=i.FeedViewStats.new(r),(0,n.feedViewStatsState)().feedViewStatsInstance=s}return s}},105047:(e,t,s)=>{s.d(t,{isFeedViewStatsEnabled:()=>i});var o=s(977053);function i(){return(0,o.partConfigEnabled)("feed_content_views_view_time_stats_web")}},101588:(e,t,s)=>{s.d(t,{isPageTheSame:()=>o});const o=(0,s(636322).vkLocal)((()=>!0))},614049:(e,t,s)=>{s.d(t,{stringifyUnknown:()=>o});const o=e=>{if("object"!=typeof e)return String(e);try{return JSON.stringify(e)}catch{return"got a non-serializable error object"}}},641546:(e,t,s)=>{function o(e){return"object"==typeof e&&null!==e}function i(e,t){return function(e,t){return o(e)&&t in e}(e,t)?e[t]:void 0}s.d(t,{getField:()=>i,isLikePlainObject:()=>r,unknownToBinaryInt:()=>n});const n=e=>1===Number(e)?1:0;function r(e,t){return o(e)&&Object.entries(t).every((([t,s])=>typeof e[t]==typeof s))}},588386:(e,t,s)=>{function o(e){var t,s;if(null!==(s=t=e)&&"object"==typeof s&&("queue"in t||"key"in t&&"string"==typeof t.key))return e.queue||e.key}s.d(t,{subscriptionObjectStableId:()=>o})},660480:(e,t,s)=>{s.d(t,{cid:()=>l});var o=s(43129);let i=1e3;const n=function(e){for(let t=0;t<10;t++)e.push(t.toString());for(let t=0;t<25;t++)e.push(String.fromCharCode(97+t)),e.push(String.fromCharCode(65+t));return(0,o.shuffle)(e)}([]),r=n.length;function a(e){return(e>=r?a((e/r>>0)-1):"")+n[e%r>>0]}const c=function(){const e=[];for(let t=0;e.length<5&&t<n.length;t++)(e.length>0||!/[0-9]/.test(n[t]))&&e.push(n[t]);return e.join("")}(),l=()=>c+a(i++)},374617:(e,t,s)=>{s.d(t,{initObserverForSmokeScreen:()=>d,runSmokeScreenObfuscate:()=>l});var o=s(533541),i=s(986450),n=s(65718),r=s(98962);const a=e=>{const t=e.getCache().names;Object.entries(t).forEach((([e,t])=>{if(!document.querySelector(e))return;const s=t.slice(1),o=e.slice(1);document.querySelectorAll(e).forEach((e=>{e.classList.add(s),e.classList.remove(o)}))}))},c=async(e=3,t=0)=>{const s=o.Locator.getInstance();if(!s.hasCache())try{await s.wrap()}catch(s){(0,n.logError)(s),t<e&&(await(0,i.sleep)(300*Math.pow(3,t)),await c(e,t+1))}return s},l=async()=>{const e=await c();e.isEnabled&&a(e)},d=async e=>{const t=document.querySelector(e);if(!t)return void console.error("[initObserverForSmokeScreen] targetToObserve not found");new MutationObserver((function(e){for(const t of e)for(const e of t.addedNodes)e instanceof HTMLElement&&((0,r.hideAdAttributesInNodeProperties)(),s.isEnabled&&a(s))})).observe(t,{childList:!0,subtree:!0});const s=o.Locator.getInstance();c()}},533541:(e,t,s)=>{s.d(t,{Locator:()=>n});var o=s(660480),i=s(288824);class n{lookup(e){return this.cache.names[e]??e}hasCache(){return Object.keys(this.cache.names).length>0}getCache(){return this.cache}disableLocator(){this.isEnabled=!1}transform(e){let t=this.cache.names[e];return t?t=t.slice(1):(t=(0,o.cid)(),this.cache.names[e]=e[0]+t,this.cache.reverse[t]=e),t}parseRulesByText(e){const t=document.implementation.createHTMLDocument(""),s=document.createElement("style");return s.textContent=e,t.body.appendChild(s),s?.sheet?.cssRules}async wrap(){const e=await window.stManager.add("SmokeGuard.css"),[,t]=e?.[0],s=await fetch(t.href),o=await s.text();if(!o)throw Error("[Locator.wrap] smoke_guard styles not found");const i=this.parseRulesByText(o);if(!i)throw Error("[Locator.wrap] no styleSheet parsed");const n=new CSSStyleSheet;for(const e of i){if(!(e instanceof CSSStyleRule))continue;const t=e.selectorText,s=e.cssText,o=`.${this.transform(t)}`,i=s.replace(t,o);n.insertRule(i,n.cssRules.length)}document.adoptedStyleSheets=[...document.adoptedStyleSheets,n]}constructor(){this.isEnabled=!0,this.cache={names:{},reverse:{}}}}n.getInstance=(0,i.makeSharedState)("smoke_guard/smoke_screen/locator",(()=>new n),{version:1})},879692:(e,t,s)=>{s.d(t,{isActsToApi2ForVKCOMViewerEnabled:()=>a,isActsToApiFirstForVKCOMViewerEnabled:()=>r,isApiForVKCOMViewerEnabled:()=>i,isMinimizedStoryFeedBlockEnabled:()=>n,isStickerTemplateEnabled:()=>c});var o=s(977053);function i(){return Boolean((0,o.partConfigEnabled)("stories_web_api"))}function n(){return Boolean((0,o.partConfigEnabled)("stories_minimized_feed_block"))}function r(){return(0,o.partConfigEnabled)("stories_web_acts_to_api_1")}function a(){return(0,o.partConfigEnabled)("stories_web_acts_to_api_2")}function c(){return(0,o.partConfigEnabled)("stories_sticker_template")}},984457:(e,t,s)=>{function o(e,t){return s.e(63167).then(s.bind(s,780342)).then((({default:s})=>{s.init(e,t)}))}s.d(t,{videoLiveBlacklistBoxLoader:()=>o})}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,loadStylesheet,installedCssChunks;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(s.exports,s,s.exports,__webpack_require__),s.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,s,o)=>{if(!t){var i=1/0;for(c=0;c<deferred.length;c++){for(var[t,s,o]=deferred[c],n=!0,r=0;r<t.length;r++)(!1&o||i>=o)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[r])))?t.splice(r--,1):(n=!1,o<i&&(i=o));if(n){deferred.splice(c--,1);var a=s();void 0!==a&&(e=a)}}return e}o=o||0;for(var c=deferred.length;c>0&&deferred[c-1][2]>o;c--)deferred[c]=deferred[c-1];deferred[c]=[t,s,o]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var s=Object.create(null);__webpack_require__.r(s);var o={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var i=2&t&&e;"object"==typeof i&&!~leafPrototypes.indexOf(i);i=getProto(i))Object.getOwnPropertyNames(i).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,__webpack_require__.d(s,o),s},__webpack_require__.d=(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,s)=>(__webpack_require__.f[s](e,t),t)),[])),__webpack_require__.u=e=>24817===e?"web/chunks/hls.b496ce21.js":77794===e?"web/chunks/7bdfc282.async.758ca0aa.js":95040===e?"web/chunks/cf5562e5.async.b4aed2d1.js":40530===e?"web/chunks/5ef6139d.async.f064c195.js":69488===e?"web/chunks/a7aba191.async.c36a6a36.js":67498===e?"web/chunks/19b9f4a7.async.9c26c7dc.js":24328===e?"web/chunks/c4004e28.async.ea2a65ee.js":27370===e?"web/chunks/2c9432b5.async.5b90c7cd.js":5157===e?"web/chunks/unauth_action_box.111478de.js":25394===e?"web/chunks/AudioLongtapModal.ab967a4b.js":75980===e?"web/chunks/menu_settings.7bdcde07.js":89334===e?"web/chunks/a228276f.async.a4e26c75.js":40928===e?"web/chunks/fcbd3ef2.async.877aa898.js":9914===e?"web/chunks/52fa6987.async.94be31b8.js":59727===e?"web/chunks/VideoUpload.d33511cc.js":9375===e?"web/chunks/voice_message_player.faac3006.js":28762===e?"web/chunks/speech.3083d7af.js":57468===e?"web/chunks/SilentModeForms.d5a6e099.js":28872===e?"web/chunks/feed-client-nav-skeleton.73bce91a.js":35953===e?"web/chunks/feed-client-nav-async-right-block.f4069a0d.js":59240===e?"web/chunks/performance-stats.b497cf49.js":53290===e?"web/chunks/init_feed_right_blocks.c0a466fa.js":63167===e?"web/chunks/video_live_blacklist_box.68037691.js":37513===e?"web/chunks/init_check_validation_phone.2ea1ef7a.js":73634===e?"web/chunks/init_unban_recommendation.579521ea.js":15302===e?"web/chunks/init_photo_block_in_post.8f075a00.js":85059===e?"web/chunks/059ba3af.async.1897b369.js":67724===e?"web/chunks/VideoEditorModal.eb979233.js":22854===e?"web/chunks/PublishClipToVideoModal.dae3ac0f.js":30271===e?"web/chunks/VideoUploadModal.b8d73da8.js":31286===e?"web/chunks/VideoExternalUploadModal.2c5830cb.js":969===e?"web/chunks/0dc980e6.async.f010f601.js":92846===e?"web/chunks/ClipUploadModal.8eff9d1c.js":378===e?"web/chunks/79f739a7.async.6dfc0f2b.js":72491===e?"web/chunks/story_blocks.dfab0b41.js":7308===e?"web/chunks/7308.e4292e75.js":1854===e?"chunks/1854.9b4b0c68.js":18254===e?"chunks/"+e+".0ac520ae.js":92398===e?"chunks/"+e+".18cb85f5.js":"web/chunks/videoplayer-interactive.c61a72cb.js",__webpack_require__.miniCssF=e=>({5157:1,59727:1}[e]?"web/chunks/b1037836.css":25394===e?"web/chunks/6a66a172.css":75980===e?"web/chunks/5bbee2c9.css":57468===e?"web/chunks/122e7a6e.css":53290===e?"web/chunks/b523c55b.css":37513===e?"web/chunks/2b70e2ca.css":73634===e?"web/chunks/254f9600.css":67724===e?"web/chunks/3c048aa6.css":22854===e?"web/chunks/70c35bc4.css":{30271:1,31286:1}[e]?"web/chunks/f89919fd.css":92846===e?"web/chunks/83ceb5be.css":72491===e?"web/chunks/6b53e0ac.css":void 0),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},__webpack_require__.l=(e,t,s,o)=>{if(inProgress[e])inProgress[e].push(t);else{var i,n;if(void 0!==s)for(var r=document.getElementsByTagName("script"),a=0;a<r.length;a++){var c=r[a];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")=="vk:"+s){i=c;break}}i||(n=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,__webpack_require__.nc&&i.setAttribute("nonce",__webpack_require__.nc),i.setAttribute("data-webpack","vk:"+s),i.src=e),inProgress[e]=[t];var l=(t,s)=>{i.onerror=i.onload=null,clearTimeout(d);var o=inProgress[e];if(delete inProgress[e],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((e=>e(s))),t)return t(s)},d=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),n&&document.head.appendChild(i)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/dist/",loadStylesheet=e=>new Promise(((t,s)=>{var o=__webpack_require__.miniCssF(e),i=__webpack_require__.p+o;if(((e,t)=>{for(var s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var i=(r=s[o]).getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(i===e||i===t))return r}var n=document.getElementsByTagName("style");for(o=0;o<n.length;o++){var r;if((i=(r=n[o]).getAttribute("data-href"))===e||i===t)return r}})(o,i))return t();((e,t,s,o)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.onerror=i.onload=n=>{if(i.onerror=i.onload=null,"load"===n.type)s();else{var r=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=r,c.request=a,i.parentNode.removeChild(i),o(c)}},i.href=t,document.head.appendChild(i)})(e,i,t,s)})),installedCssChunks={12495:0},__webpack_require__.f.miniCss=(e,t)=>{installedCssChunks[e]?t.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{5157:1,22854:1,25394:1,30271:1,31286:1,37513:1,53290:1,57468:1,59727:1,67724:1,72491:1,73634:1,75980:1,92846:1}[e]&&t.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(t=>{throw delete installedCssChunks[e],t})))},(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={12495:0};__webpack_require__.f.j=(t,s)=>{var o=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==o)if(o)s.push(o[2]);else{var i=new Promise(((s,i)=>o=e[t]=[s,i]));s.push(o[2]=i);var n=__webpack_require__.p+__webpack_require__.u(t),r=new Error;__webpack_require__.l(n,(s=>{if(__webpack_require__.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;r.message="Loading chunk "+t+" failed.\n("+i+": "+n+")",r.name="ChunkLoadError",r.type=i,r.request=n,o[1](r)}}),"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,s)=>{var o,i,[n,r,a]=s,c=0;if(n.some((t=>0!==e[t]))){for(o in r)__webpack_require__.o(r,o)&&(__webpack_require__.m[o]=r[o]);if(a)var l=a(__webpack_require__)}for(t&&t(s);c<n.length;c++)i=n[c],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return __webpack_require__.O(l)},s=self.webpackChunkvkweb=self.webpackChunkvkweb||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var __webpack_exports__=__webpack_require__.O(void 0,[213,83737,2067,20795,57451,5038,95167,38234,74606,99812],(()=>__webpack_require__(695526)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();