/*! For license information please see de31987e.0fb9c930.js.LICENSE.txt */
"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[51587],{385228:(e,t,n)=>{n.d(t,{Icon20More:()=>o});var o=(0,n(28178).makeIcon)("Icon20More","more_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="more_20"><path fill="currentColor" d="M15 8.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3m-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3m-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3" /></symbol>',20,20,!1,void 0)},904093:(e,t,n)=>{n.d(t,{Icon20PinOutline:()=>o});var o=(0,n(28178).makeIcon)("Icon20PinOutline","pin_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="pin_outline_20"><g fill="none" fill-rule="evenodd"><path d="M0 0h20v20H0z" /><path fill="currentColor" fill-rule="nonzero" d="M11.332 2.604a.75.75 0 0 1 1.266-.384l5.182 5.183a.75.75 0 0 1-.383 1.265l-1.54.308a.3.3 0 0 0-.152.082l-2.463 2.463a.3.3 0 0 0-.086.187l-.297 3.858a1.012 1.012 0 0 1-1.724.638l-3.139-3.139-4.716 4.716a.75.75 0 0 1-1.133-.977l.073-.084 4.715-4.716-3.139-3.138a1.01 1.01 0 0 1-.084-1.336l.084-.095c.171-.171.397-.275.638-.294l3.859-.296a.3.3 0 0 0 .187-.086l2.463-2.464a.3.3 0 0 0 .081-.151Zm1.196 1.668-.033.166c-.07.348-.24.667-.491.918L9.54 7.819a1.8 1.8 0 0 1-1.133.521l-2.801.216 5.837 5.837.216-2.8c.03-.374.174-.729.413-1.015l.108-.118 2.464-2.463c.25-.251.57-.422.918-.492l.165-.033z" /></g></symbol>',20,20,!1,void 0)},17117:(e,t,n)=>{n.d(t,{Icon20ReportOutline:()=>o});var o=(0,n(28178).makeIcon)("Icon20ReportOutline","report_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="report_outline_20"><path d="M10.001 5.5a.75.75 0 0 0-.75.75v4.5a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75m-.9 8.4a.9.9 0 1 1 1.8 0 .9.9 0 0 1-1.8 0" /><path fill-rule="evenodd" d="m17.326 14.814-2.514 2.514c-.432.433-.648.649-.9.803a2.5 2.5 0 0 1-.723.3c-.288.069-.594.069-1.205.069h-3.97c-.612 0-.918 0-1.206-.07a2.5 2.5 0 0 1-.723-.299c-.252-.154-.468-.37-.9-.803L2.67 14.814c-.432-.432-.648-.648-.802-.9a2.5 2.5 0 0 1-.3-.723c-.068-.288-.068-.593-.069-1.204V8.014c0-.611 0-.917.069-1.205a2.5 2.5 0 0 1 .3-.723c.154-.252.37-.468.803-.9L5.186 2.67c.432-.432.649-.648.9-.803a2.5 2.5 0 0 1 .723-.299c.288-.069.594-.069 1.205-.069h3.97c.611 0 .917 0 1.205.07a2.5 2.5 0 0 1 .723.298c.252.155.468.371.9.804l2.514 2.514c.432.432.648.648.803.9.137.224.238.468.3.723.068.288.068.593.068 1.205v3.972c0 .611 0 .917-.069 1.205a2.5 2.5 0 0 1-.299.723c-.155.252-.37.468-.803.9Zm-.474-1.706c-.062.101-.149.188-.321.36l-3.063 3.063c-.173.173-.26.26-.36.322a1 1 0 0 1-.29.12c-.115.027-.237.027-.482.027H7.662c-.245 0-.367 0-.482-.028a1 1 0 0 1-.29-.12c-.1-.061-.186-.148-.36-.32l-3.06-3.065c-.173-.172-.26-.259-.321-.36a1 1 0 0 1-.12-.289C3 12.704 3 12.582 3 12.338V7.663c0-.245 0-.367.027-.482a1 1 0 0 1 .12-.29c.062-.1.148-.187.321-.36l3.064-3.063c.173-.172.26-.259.36-.32a1 1 0 0 1 .29-.12C7.295 3 7.418 3 7.662 3h4.673c.245 0 .367 0 .482.028a1 1 0 0 1 .29.12c.1.061.187.148.36.32l3.063 3.063c.172.173.259.26.32.36q.084.136.12.29c.028.115.028.237.028.482v4.674c0 .245 0 .367-.027.482a1 1 0 0 1-.12.29Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},540246:(e,t,n)=>{n.d(t,{Icon56CommentsOutline:()=>o});var o=(0,n(28178).makeIcon)("Icon56CommentsOutline","comments_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="comments_outline_56"><path fill="currentColor" d="m27.234 42.143.965 1.149zm-10.09 8.477-.966-1.149zM8.5 15a1.5 1.5 0 0 0 0-3zm20.895 20.672-.965 1.148zm9.462 7.948.965-1.149zM5 36.5v-18H2v18zm9.5 3.5h-6v3h6zm2.5 9.854V42.5h-3v7.354zm9.27-8.86-10.092 8.477 1.93 2.297 10.091-8.476zm1.93 2.298c.223-.189.507-.292.8-.292v-3c-.999 0-1.966.352-2.73.995zM14 49.854c0 2.124 2.482 3.28 4.108 1.914l-1.93-2.297a.5.5 0 0 1 .822.383zM14.5 43a.5.5 0 0 1-.5-.5h3a2.5 2.5 0 0 0-2.5-2.5zM2 36.5A6.5 6.5 0 0 0 8.5 43v-3A3.5 3.5 0 0 1 5 36.5zm3-18A3.5 3.5 0 0 1 8.5 15v-3A6.5 6.5 0 0 0 2 18.5zM46.5 5h-28v3h28zM12 11.5v18h3v-18zm41 18v-18h-3v18zM41.5 36h5v-3h-5zm.5 6.854V35.5h-3v7.354zM18.5 36h7.679v-3H18.5zm9.93.82 9.462 7.948 1.93-2.297-9.463-7.948zM26.179 36a3.5 3.5 0 0 1 2.25.82l1.93-2.297A6.5 6.5 0 0 0 26.18 33zM39 42.854a.5.5 0 0 1 .822-.383l-1.93 2.297c1.626 1.366 4.108.21 4.108-1.914zM41.5 33a2.5 2.5 0 0 0-2.5 2.5h3a.5.5 0 0 1-.5.5zm8.5-3.5a3.5 3.5 0 0 1-3.5 3.5v3a6.5 6.5 0 0 0 6.5-6.5zm-38 0a6.5 6.5 0 0 0 6.5 6.5v-3a3.5 3.5 0 0 1-3.5-3.5zM18.5 5a6.5 6.5 0 0 0-6.5 6.5h3A3.5 3.5 0 0 1 18.5 8zm28 3a3.5 3.5 0 0 1 3.5 3.5h3A6.5 6.5 0 0 0 46.5 5z" /></symbol>',56,56,!1,void 0)},952464:(e,t,n)=>{n.d(t,{default:()=>o});const o={scroll:"VideoChat-module__scroll--1zGsq",in:"VideoChat-module__in--qeyRv",message:"VideoChat-module__message--da28x",messageHighlight:"VideoChat-module__messageHighlight--yPjmR",messageContent:"VideoChat-module__messageContent--E9uEF",deleteMessageContent:"VideoChat-module__deleteMessageContent--oGNmC",ownerName:"VideoChat-module__ownerName--AGC7x",adminOwnerName:"VideoChat-module__adminOwnerName--CJdeb",adminOwnerNameWrapper:"VideoChat-module__adminOwnerNameWrapper--ZA3B2",messageText:"VideoChat-module__messageText--SHnPZ",messageActions:"VideoChat-module__messageActions--Hd0xT",stub:"VideoChat-module__stub--OpUK3"}},878371:(e,t,n)=>{n.d(t,{default:()=>o});const o={button:"VideoChatHideButton-module__button--URjJQ"}},649390:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 9.59 2.96 8.04a1 1 0 0 0-1.42 1.42L3.8 11.7a1 1 0 0 0 1.42 0l5.25-5.25a1 1 0 0 0-1.42-1.42z" fill="currentColor"/></svg>',name:"verified_12"}}n.d(t,{getIcon12Verified:()=>o})},290161:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><linearGradient id="like_circle_fill_red_20__a" gradientUnits="userSpaceOnUse" x1="-10" x2="10" y1="10" y2="30"><stop offset="0" stop-color="#ff5263"/><stop offset="1" stop-color="#ff3347"/></linearGradient><path d="M0 10a10 10 0 1 1 20 0 10 10 0 0 1-20 0z" fill="url(#like_circle_fill_red_20__a)"/><path d="M12.2 6.5c1.55 0 2.8 1.2 2.8 2.7 0 1.5-.63 2.24-3.28 4.23l-1.2.9a.86.86 0 0 1-1.03 0l-1.21-.9C5.63 11.44 5 10.69 5 9.19 5 7.7 6.25 6.5 7.8 6.5c.83 0 1.55.4 2.2 1.15.65-.75 1.37-1.15 2.2-1.15z" fill="#fff"/></svg>',name:"like_circle_fill_red_20"}}n.d(t,{getIcon20LikeCircleFillRed:()=>o})},159532:(e,t,n)=>{n.d(t,{Stickers:()=>s});var o=n(2190),i=n(433830);const s={getStickerUrl:function(e,t){let n=String(t);if(o.colorScheme.isDarkScheme()&&(n=n.replace(/b$/,"")+"b"),window.Emoji){const t=Emoji.stickersById?.[e]?.sticker[Emoji.STICKER_FIELD_IMAGES]?.[n];if(t)return t}const s={id:e,size:n};if((0,i.isMvk)()){if(window.stickers_cache){const t=window.stickers_cache.getStickerImage(e,n);if(t)return t}return window.store.stickers&&function(e,t){return e.replace(/%([^%]+?)%/g,(e=>(e=e.slice(1,-1),t.hasOwnProperty(e)?t[e]:"")))}(window.store.stickers.url_template,{id:e,size:n})}return window.getTemplate("stickers_sticker_url",s)},getStickerPopupLayer:function(e){return(0,i.isMvk)()&&window.stickers_cache?.getStickerPopupLayer(e)||[]}}},863818:(e,t,n)=>{n.d(t,{VideoChat:()=>E});var o=n(70689),i=n(902947),s=n(449147),a=n(93367),r=n(636322),l=n(585703),c=n(963526),d=n(977584),u=n(471828),m=n(193805),h=n(649390),p=n(166695),g=n(294857),f=n(634042),_=n(184132),v=n(819427),w=n(699906),y=n(936967),C=n(368076),S=n(665811),M=n(397631),b=n(659397);const E={SCROLL_EDGE_BELOW_THRESHOLD:20,MAX_COMMENTS_NUM:50,MAX_LIKES_PER_BATCH:5,MAX_STICKERS_PER_BATCH:5,init(e,t){if(E.block&&E.destroy(),!e)return;E.block=e,E.options=(0,r.extend)({},t),E.messagesWrap=(0,o.domByClass)(e,"mv_chat_messages_wrap"),E.stickersWrap=(0,o.domByClass)(e,"mv_chat_stickers_wrap"),t.chatRefactoring?(E.initChatComponent(t.messageData),this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches):E.scroll=new uiScroll((0,o.domFC)(E.messagesWrap),{global:!0,hidden:t.scrollHidden,reversed:!0,preserveEdgeBelow:!0,preserveEdgeBelowThreshold:E.SCROLL_EDGE_BELOW_THRESHOLD,theme:"videoview",onupdate:E.onScrollUpdate}),this.scrollBottomBtnWrap=(0,o.domByClass)(e,"mv_chat_new_messages_btn_wrap"),E.replyForm=(0,o.domByClass)(e,"mv_chat_reply_form"),E.replyForm&&(E.replyInput=(0,o.domByClass)(e,"mv_chat_reply_input"),E.initReplyInput()),E.firstMsgIntro=(0,o.domByClass)(e,"mv_chat_first_message_intro");[E.messagesWrap,E.replyForm].forEach((e=>e?.classList.add("chat_hide_button_enabled"))),E.initChatHideButton(),t.stickerRefactoring&&(E.stickerManager?.destroy(),E.stickerManager=null,E.stickersCanvasWrap=null)},initReplyInput(){(0,s.placeholderInit)(E.replyInput,{editable:!0,global:!0}),window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){const e=Emoji.init(E.replyInput,{forceStickerPack:E.options.forceStickerPack,controlsCont:E.replyForm,noLineBreaks:1,noCtrlSend:1,noStickers:!!E.options.noStickers,ref:"video_chat",onSend:function(){E.sendMessage()},checkEditable:function(){E.checkFormHeight(),E.checkTextLen()},onStickerSend:function(e){E.sendSticker(e)}});(0,o.data)(E.replyForm,"optId",e)}))},initChatComponent(e){E.firstMessageIntroText=E.firstMessageIntroText||u.getLang("video_first_message_intro"),E.VideoChatComponent=w.VideoChatComponent,E.VideoChatComponent.init({messages:e,firstMessageIntroText:E.firstMessageIntroText})},initChatHideButton(){E.chatHideButtonText=E.chatHideButtonText||u.getLang("video_action_button_hide_chat"),E.VideoChatHideButtonComponent=S.VideoChatHideButtonComponent,E.VideoChatHideButtonComponent.init({btnText:E.chatHideButtonText}),E.chatHideButton=E.block?.querySelector("#video_chat_hide_button")||E.chatHideButton},checkFormHeight(){const e=E.replyForm;let t=e.offsetHeight;if(E.chatHideButton){t+=E.chatHideButton.offsetHeight}if(e.lastHeight===t)return;if(e.lastHeight=t,(0,o.setStyle)(E.messagesWrap,{bottom:t+"px"}),E.options.chatRefactoring)return;!E.scroll.data.scrollBottom&&E.scroll.scrollBottom()},checkTextLen(e=E.replyInput){const t=(0,r.trim)(Emoji.editableVal(e));if(e.lastLen===t.length)return;if((e.lastLen=t.length)>mvcur.maxChatReplyLength){const t=cur.storyLayer?u.getLang("stories_live_chat_msg_too_long"):u.getLang("video_live_chat_msg_too_long");(0,l.showTooltip)(e,{black:1,text:t,shift:!!cur.storyLayer&&[-30,10]})}else window.tooltips&&tooltips.destroy(e)},stickerClick:(e,t,n)=>(window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.clickSticker(e,t,n)})),!1),onScrollUpdate(e){E.options.chatRefactoring||e.data.scrollBottom<E.SCROLL_EDGE_BELOW_THRESHOLD&&E.toggleScrollBottomBtn(!1)},getMessageAccessFlags(e,t){e=parseInt(e,10),t=parseInt(t,10);const{adminLevel:n,canDeleteComments:o,canPinComments:i}=Videoview.getMvData(),s=n>m.GroupAdminLevel.USER;let a=!1;window.replyAsList?.length&&(a=window.replyAsList.some((e=>e[0]===t)));const r=window.vk.id;return{canDeleteComment:s||!!o||e===r||t===r||a,canReportComment:e!==t&&t!==r&&!a,canPinComment:!!i}},receiveMessage(e,t,n,o,i,s,a,l,c,d,u,m){if((0,r.intval)(c))return void E.appendSticker(c,n);const{canDeleteComment:p,canReportComment:g,canPinComment:f}=E.getMessageAccessFlags(e,n);if(E.options.chatRefactoring)return void E.appendMessageRefactoring({id:t,author_id:Number(n),owner_id:Number(e),text:l,owner_href:s,photo_url:i,is_verified:u,owner_name:o,can_delete:!!p,can_report:1===Number(m)||!!g,can_pin:!!f,action_hash:E.options.chatActionHash});let _="";f?_+=(0,r.getTemplate)("video_chat_message_actions_menu",{owner_id:e,author_id:n,author_name:o,author_href:s,author_verified:!!u,comment_id:t,show_delete:!!p,show_report:!!g}):(g&&(_+=(0,r.getTemplate)("video_chat_message_action_report",{video_owner_id:e,msg_id:t})),p&&(_+=(0,r.getTemplate)("video_chat_message_action_del",{video_owner_id:e,msg_id:t})));let v=o;u&&(v+='<div class="mv_page_verified">'+(0,h.getIcon12Verified)().icon+"</div>");const w=(0,r.getTemplate)("video_chat_message",{author_href:s,author_photo:i,author_name:v,message:l,video_owner_id:e,msg_id:t,actions:_,classes:n==e?"mv_chat_admin_message":""});E.appendMessage(w,t)},receiveDelete(e,t){if(E.options.chatRefactoring)return void E.sendCustomEvent(y.CustomEventType.DELETE_MESSAGE,t);const n="#mv_chat_msg"+mvcur.mvData.oid+"_"+t;let i=E._messagesBatch&&E._messagesBatch.querySelector(n);i?i.remove():(i=E.messagesWrap.querySelector(n),i&&!(0,o.hasClass)(i,"_deleted")&&E.scroll.updateBelow((function(){i.remove()})))},checkStickerFlood(e,t){const n=mvcur.queueBatchId;E._stickersLimits&&E._stickersLimits.batch==n||(E._stickersLimits={batch:n,like:0,sticker:0},E._stickersDelay=0);const o="like"==e?"like":"sticker",i="like"==o?E.MAX_LIKES_PER_BATCH:E.MAX_STICKERS_PER_BATCH;return!(++E._stickersLimits[o]>i&&t!=vk.id)},appendSticker(e,t,n=!0){if(!E.isHidden()&&!Videoview.isFS&&"hidden"!=document.visibilityState&&"animation"in document.body.style&&"onanimationend"in window&&!this.prefersReducedMotion){if(t==vk.id){const t=E.recentlySentSticker;if(t&&t.stickerId==e&&t.fromQueue!=n&&Date.now()-t.time<3e3)return;E.recentlySentSticker={stickerId:e,fromQueue:n,time:Date.now()}}else if(!E.checkStickerFlood(e,t))return;if(E.options.stickerRefactoring){if(!E.stickersCanvasWrap){const e=document.createElement("canvas");e.width=100,e.height=320,e.classList.add("mv_chat_stickers_wrap");const t=document.querySelector(".videoplayer")||document.querySelector(".LiveWebPlayer__content");t&&(t.append(e),E.stickersCanvasWrap=e)}return E.stickerManager=E.stickerManager||new v.StickerManager(E.stickersCanvasWrap),void E.stickerManager.add(e,"like"==e)}if("like"==e){const e=(0,o.ce)("div",{className:"mv_chat_like"});s(e),(0,a.addEvent)(e,"animationend",c),l(e)}else{const t=(0,o.ce)("img",{className:"mv_chat_sticker",src:Stickers.getStickerUrl(e,((0,i.isRetina)()?128:64)+"b")});s(t),(0,a.addEvent)(t,"error animationend",c),(0,a.addEvent)(t,"load",l)}}function s(e){let n="",s=0,a=0,l=0,c=(0,r.intval)((E.getHeight()-80)/6);for(let e=0;e<=100;e+=20){e>0&&(s+=(0,i.irand)(-4,4),a-=c,l+=(0,i.irand)(-4,4),c=(0,r.intval)(.9*c));n+=`\n          ${e}% {\n            transform: translate(${s}px, ${a}px) rotate(${l}deg) scale(${e?1:.7});\n            opacity: ${0==e||100==e?0:1};\n          }\n        `}const d="mv_chat_sticker_animation_"+Date.now()+"_"+(0,i.irand)(0,1e9);n=`@keyframes ${d} {${n}}`,e.appendChild((0,o.ce)("style",{innerHTML:n}));const u=(0,i.irand)(1500,2500)+"ms",m=(t==vk.id?0:E._stickersDelay+=100)+"ms";(0,o.setStyle)(e,{animation:[d,u,m,"linear"].join(" ")})}function l(e){const t=e.currentTarget||e;(E._stickersBatch||(E._stickersBatch=document.createDocumentFragment())).appendChild(t),E._appendStickerTimeout||(E._appendStickerTimeout=setTimeout((function(){E.appendStickersBatch(),E._appendStickerTimeout=null}),0))}function c(e){const t=e.currentTarget||e;(0,a.removeEvent)(t),t.remove()}},appendStickersBatch(){const e=E._stickersBatch;if(e&&(E._stickersBatch=null,!E.isHidden())){if(!E.stickersWrap){const e=document.createElement("div");e.classList.add("mv_chat_stickers_wrap");const t=document.querySelector(".videoplayer");t&&(t.append(e),E.stickersWrap=e)}E.stickersWrap?.appendChild(e)}},removeStickers(){if(E.stickersWrap)for(let e;e=(0,o.domFC)(E.stickersWrap);)(0,a.removeEvent)(e),e.remove()},appendMessageRefactoring(e){E._messagesBatchData=E._messagesBatchData||[],E._messagesBatchData.push(e),E._messagesBatchData.length>E.MAX_COMMENTS_NUM&&(E._messagesBatchData=E._messagesBatchData.slice(Math.max(E._messagesBatchData.length-E.MAX_COMMENTS_NUM,0))),E.isHidden()||window.Videoview.isFS||"hidden"===document.visibilityState||E.sendBatchOfMessages()},sendBatchOfMessages(){E.options.chatRefactoring&&!E._appendMessageTimeout&&E._messagesBatchData?.length&&(E._appendMessageTimeout=setTimeout((()=>{E.sendCustomEvent(y.CustomEventType.NEW_MESSAGES,E._messagesBatchData),E._messagesBatchData=[],E._appendMessageTimeout=null}),0))},sendCustomEvent(e,t={}){window.dispatchEvent(new CustomEvent(y.CustomEventName,{detail:{eventType:e,data:t}}))},appendMessage(e,t){const n=E._messagesBatch||(E._messagesBatch=document.createDocumentFragment()),o="#mv_chat_msg"+mvcur.mvData.oid+"_"+t;if(E.messagesWrap.querySelector(o)||n.querySelector(o))return;const i=(0,C.createElementFromHTML)(e);[...i.querySelectorAll(".mv_chat_message_show_action_false")].forEach((e=>{e.parentNode.removeChild(e)})),n.appendChild(i);const s=n.childNodes;for(;n.childNodes.length>E.MAX_COMMENTS_NUM;)s[0].remove();E.isHidden()||E._appendMessageTimeout||(E._appendMessageTimeout=setTimeout((function(){E.appendMessagesBatch(),E._appendMessageTimeout=null}),0))},appendMessagesBatch(){if(E.isHidden()||window.Videoview.isFS||"hidden"===document.visibilityState)return;if(E.options.chatRefactoring)return;const e=E._messagesBatch;if(!e)return;E._messagesBatch=null,E.firstMsgIntro&&(E.firstMsgIntro.remove(),E.firstMsgIntro=null);const t=E.scroll.content,n=t.childNodes;let o=t.childNodes.length+e.children.length-E.MAX_COMMENTS_NUM;if(n.length&&o>0)for(;o>0;)n[0].remove(),o--;E.scroll.updateBelow((function(){t.appendChild(e)})),E.scroll.data.scrollBottom>100&&E.toggleScrollBottomBtn(!0)},toggleScrollBottomBtn(e){(0,o.toggleClass)(this.scrollBottomBtnWrap,"hidden",!e)},scrollBottom(){if(E.options.chatRefactoring)return window.VideoChat.sendCustomEvent(y.CustomEventType.SCROLL_BOTTOM),void window.VideoChat.toggleScrollBottomBtn(!1);E.scroll.scrollBottom(0)},replyAsAnimate(e,t,n){const i=e&&(0,o.geByClass1)("mv_chat_reply_author_photo",e),s=i&&(0,o.geByClass)("mv_chat_reply_author_photo_img",i),a=(0,o.hasClass)(e,"mv_chat_author_secondary")?0:1;s&&s[a]&&(s[a].src=n),(0,o.toggleClass)(e,"mv_chat_author_secondary")},replyAsGroup(e,t){window.replyAsList?E.replyAsGroupTT(e,t):(window.replyAsList=[],window.replyAsData={},(0,o.domData)(e,"can_reply_as_any_group")?ajax.post("/al_groups.php?act=get_editor_clubs",{},{cache:1,onDone:function(n){window.replyAsList=n,(0,r.each)(n,(function(e,[t,n,o,i]){window.replyAsData[t]=this})),E.replyAsGroupTT(e,t)}}):E.replyAsGroupTT(e,t))},replyAsGroupList(e,t,n){const i=[n];let s=(0,o.domByClass)(e,"mv_chat_reply_group_data");if(s){let e=[(0,o.domData)(s,"group_id"),(0,o.domData)(s,"group_photo"),(0,o.domData)(s,"group_href"),(0,o.domData)(s,"group_name")];i.push(e),window.replyAsData[e[0]]=e}return(0,r.each)(window.replyAsList,(function(e,[n,o,s,a]){n!=t&&i.push(this)})),i},replyAsGroupOver(e){const t=(0,o.gpeByClass)("mv_chat_reply_form",e);(0,l.showTooltip)(e,{text:function(){return(0,o.domData)(t,"from-oid")<0?u.getLang("global_on_behalf_group"):u.getLang("global_on_behalf_me")},black:1,shift:[9,8,8]})},replyAsGroupTT(e,t){const n=E.replyAsProfileData(),i=(0,o.gpeByClass)("mv_chat_reply_form",e),s=i&&(0,o.domData)(i,"from-oid");let l=(0,o.data)(e,"tt");if(!n)return!1;if(!l){const i=E.replyAsGroupList(e,t,n);let c="";(0,r.each)(i,(function(e,[t,n,o,i]){c+=(0,r.getTemplate)("video_chat_message_author_select_row",{author_id:t,author_href:o,author_photo:n,author_name:(0,b.decodeHTMLEntities)((0,b.encodeHTMLEntities)((0,b.escape)(i))),classes:s==t?" active":""})})),l=new ElementTooltip(e,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+c+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"top",offset:function(){return[0,-5]},onFirstTimeShow:function(t){const n=(0,o.geByClass)("post_from_tt_row",t);(0,r.each)(n,(function(t,n){(0,a.addEvent)(n,"click",E.setReplyAsGroup.pbind(e,{from:(0,o.domData)(this,"from-oid")}))})),this.rows=n,this.scroll=new uiScroll((0,o.geByClass1)("_post_scroll_wrap",t)),setTimeout((function(){l.scroll.update(),l.updatePosition()}),0)},onShow:function(e){setTimeout((function(){if(!l.scroll)return;const t=(0,o.geByClass1)("active",e),n=t?t.offsetTop-(l.scroll.data.viewportHeight-(0,o.getSize)(t)[1])/2:0;l.scroll.scrollTop(n)}),0)},onHide:function(e){}}),(0,o.data)(e,"tt",l)}t&&l.isShown()&&E.setReplyAsGroup(e,{from:s==vk.id?t:vk.id}),e.tt&&e.tt.hide&&e.tt.hide(),l.isShown()||l.show()},replyAsProfileData:()=>window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData,setReplyAsGroup(e,t){if(!e)return!1;const n=(0,o.domClosest)("mv_chat_reply_form",e),i=(0,o.data)(e,"tt"),s=t.from||(t.fromGroup?cur.oid:vk.id),a=s==vk.id?E.replyAsProfileData():window.replyAsData&&window.replyAsData[s];return!((0,o.domData)(n,"from-oid")==s||!a||a[0]!=s)&&((0,o.domData)(n,"from-oid",s),E.replyAsAnimate(n,a[2],a[1]),i&&i.rows&&(0,r.each)(i.rows,(function(){(0,o.toggleClass)(this,"active",(0,o.domData)(this,"from-oid")==s)})),e.setAttribute("aria-label",_.Ranges.isGroupId(s)?u.getLang("wall_reply_as_group"):u.getLang("wall_reply_as_user")),!1)},sendMessage(){if(E.messageSending)return;const e={Message:(0,r.trim)(Emoji.val(E.replyInput))};if(!e.Message)return void(0,o.elfocus)(E.replyInput);if(Date.now()-E.lastMsgSent<1e3)return window.tooltips&&tooltips.destroy(E.replyInput),void(0,l.showTooltip)(E.replyInput,{text:u.getLang("video_live_chat_too_fast"),black:1});const t=Videoview.getMvData(),n=(0,o.geByClass1)("mv_chat_reply_form",this.block);n&&(0,o.domData)(n,"from-oid")&&(e.from_oid=(0,o.domData)(n,"from-oid")),ajax.post("al_video.php?act=post_comment",(0,r.extend)(e,{video:t.videoRaw,hash:t.hash,videoviewer_chat:1,item_access_hash:mvcur.mvData.itemAccessHash}),{onDone:function(e,t,n){E.messageSending=!1,E.options.chatRefactoring&&n?.[0]?E.appendMessageRefactoring(n[0]):e&&t&&E.appendMessage(e,t),Emoji.val(E.replyInput,""),E.checkFormHeight(),E.options.chatRefactoring||E.scroll.data.scrollBottom&&E.scrollBottom(),E.lastMsgSent=Date.now(),mvcur.player&&mvcur.player.vars.stats_tmr&&(0,c.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onFail:function(e){if(E.messageSending=!1,E.replyInput)return window.tooltips&&tooltips.destroy(E.replyInput),(0,l.showTooltip)(E.replyInput,{text:e,showdt:200,forcetodown:0,slide:15,black:1}),(0,o.elfocus)(E.replyInput),!0}}),E.messageSending=!0},sendSticker(e){const t=Videoview.getMvData();ajax.post("al_video.php?act=live_send_sticker",{sticker_id:e,owner_id:t.oid,video_id:t.vid,hash:t.hash,item_access_hash:mvcur.mvData.itemAccessHash},{onDone(){E.appendSticker(e,vk.id,!1)},onFail:t=>("action_disabled"===t&&E.appendSticker(e,vk.id,!1),!0)})},showActionsMenu(e,t){const n=(0,f.getMsgElement)(e,t),o=n?.querySelector(".mv_chat_message_actions");o.style.visibility="visible"},hideActionsMenu(e,t){const n=(0,f.getMsgElement)(e,t),o=n?.querySelector(".mv_chat_message_actions");o.style.visibility=""},hidePinnedMessage(){g.PinnedMessageComponent.init()},showPinnedMessage(e,t,n,o,i,s,a=!1,r=!1,l=!1,c=""){if(!c){const t=(0,f.getMsgElement)(e,s),n=t?.querySelector(".mv_chat_message_text");c=n?.innerHTML}g.PinnedMessageComponent.init({ownerId:e,commentId:s,text:c||"",authorId:t,authorName:n,authorHref:o,authorVerified:i,canUnpin:a,canDelete:r,canReport:l})},deleteMessage(e,t){let n;if(!E.options.chatRefactoring){if(n=document.querySelector(`#mv_chat_msg${e}`),!n)return;n.classList.add("_deleted")}ajax.post("al_video.php?act=delete_comment",{comment:e,hash:t,videoview_chat:1},{onDone(t){if(E.options.chatRefactoring){const{itemId:n}=(0,M.splitRawId)(e);n&&E.sendCustomEvent(y.CustomEventType.DELETE_MESSAGE,{msgId:n,stubText:t})}else if(n){n.classList.add("_show_deleted_stub");const e=n.querySelector(".mv_chat_message_content");e&&(e.innerHTML=t)}document.querySelector(`#pinned_message${e}`)&&E.hidePinnedMessage()}})},showReportVideoChatCommentForm(e,t){(0,d.showReportForm)("video_comment",e,t,(()=>{const n=(0,f.getMsgElement)(e,t);n&&(n.classList.add("_deleted"),n.classList.add("_show_deleted_stub"),(0,o.val)((0,o.domByClass)(n,"mv_chat_message_content"),u.getLang("global_report_sent")))}))},pinMessage(e,t,n,o,i,s,a,r,l){(0,p.api)("video.pinComment",{owner_id:e,comment_id:s}).then((()=>{E.showPinnedMessage(e,t,n,o,i,s,!0,a,r,l)}))},unpinMessage(e,t){(0,p.api)("video.unpinComment",{owner_id:e,comment_id:t}).then((()=>{E.hidePinnedMessage()}))},isHidden(){return!!this.hidden||Videoview.isMinimized()},setHidden(e){this.hidden=e},toggle(){const e=E.isHidden();this.setHidden(!e),E.toggleStateClasses(),e&&E.scroll&&(E.appendMessagesBatch(),E.updateScroll()),e||E.removeStickers(),e&&(E.sendBatchOfMessages(),window.Videoview.queueReconnect())},onFullscreenChange(e){window.VideoChat.onResize(),window.VideoChat.updateScroll(),e||(E.sendBatchOfMessages(),window.Videoview.queueReconnect())},toggleStateClasses(){const e=!!this.block,t=E.isHidden(),n=Videoview.isMinimized();(0,o.toggleClass)("mv_box","_has_chat",e&&!n),(0,o.toggleClass)("mv_box","_hide_chat",e&&!n&&t);let i="";e&&(E.appendMessagesBatch(),E.sendBatchOfMessages(),i=t?u.getLang("video_aria_expand_chat"):u.getLang("video_aria_minimize_chat"));(0,o.ge)("mv_top_pl_toggle")&&(0,o.attr)("mv_top_pl_toggle","aria-label",i)},updateScroll(){E.options.chatRefactoring||(E.scroll.update(),E.scroll.scrollBottom(),E.toggleScrollBottomBtn(!1))},onResize(){E.block&&(E._chatHeight=E.block.offsetHeight)},getHeight:()=>E.block?E._chatHeight||(E._chatHeight=E.block.offsetHeight):0,destroy(){if(E.block){if(E.scroll&&(E.scroll.destroy(),E.scroll=null),E.replyForm){const e=(0,o.data)(E.replyForm,"optId");void 0!==e&&Emoji.destroy(e),(0,o.removeData)(E.replyForm),(0,o.removeData)(E.replyInput),E.replyForm=E.replyInput=null}E.removeStickers(),(0,o.removeData)(E.block),E.block.remove(),E.block=null,E.messagesWrap=null,E.stickersWrap=null,E.options.chatRefactoring&&(w.VideoChatComponent.destroy(),E._messagesBatchData=null),E.options.stickerRefactoring&&(E.stickersCanvasWrap=null,E.stickerManager?.destroy()),E.options=null,clearTimeout(E._appendMessageTimeout),clearTimeout(E._appendStickerTimeout),E._appendMessageTimeout=null,E._appendStickerTimeout=null,E._messagesBatch=null,E.firstMsgIntro=null,E.messageSending=!1,E.toggleStateClasses()}}}},161950:(e,t,n)=>{n.d(t,{removeDuplicateById:()=>o});const o=e=>{const t=new Set;return e.reduce(((e,n)=>{const o=n.id;return t.has(o)||e.push(n),t.add(o),e}),[])}},397631:(e,t,n)=>{n.d(t,{splitRawId:()=>o});const o=e=>{const[t,n,o]=e.split("_");return{ownerId:Number(t),itemId:Number(n),externalId:void 0!==o?o:null}}},193805:(e,t,n)=>{n.d(t,{ANALYTICS_SCREEN_OTHER:()=>s,ANALYTICS_SCREEN_SETTINGS:()=>i,GroupAdminLevel:()=>o});const o={USER:0,MODERATOR:1,EDITOR:2,ADMINISTRATOR:3,HOST:4,EVENT_CREATOR:5,CREATOR:6,PSEUDO_LEVEL_ADVERTISER:100},i="settings",s="other"},977584:(e,t,n)=>{n.d(t,{ReportReasonIds:()=>m,afterCommentReportSubmit:()=>p,showReportForm:()=>h});var o=n(785893),i=n(379440),s=n(471828),a=n(684542),r=n(166695),l=n(263740),c=n(661587),d=n(284658);(0,a.initApi)();const u=window.vk;var m;function h(e,t,i,s,a,r,l,u){const m=(0,c.asyncComponent)((()=>Promise.all([n.e(2067),n.e(20795),n.e(29019)]).then(n.bind(n,177911))),(({ReportForm:e})=>e));(0,d.showMessageBoxModalSuspense)((n=>(0,o.jsx)(m,{...n,reportSource:e,reportSourceOwnerId:t,reportSourceId:i,onSubmit:s,messengerAdditionalData:r,from:l,adData:u})),{onDestroy:a})}function p(e,t,n){const o=function(e,t,n){switch(e){case"photo":return`#post${t}photo_${n}`;case"video":return`#post${t}video_${n}mv`;case"market":return`#post${t}market_${n}`}}(e,t,n);if("photo"===e){const e=document.querySelector(`${o} .dld`);null!==e&&(e.outerHTML="")}const a=document.querySelector(`${o} .reply_wrap`);null!==a?(a.style.display="none",a.outerHTML+=`<div class="dld">${s.getLang("global_report_sent")}</div>`):(0,i.debugLog)(`Unable to hide report button for ${e} comment`)}(0,r.setLoginConfig)({onCaptcha:l.handleCaptcha,domain:u?.apiConfigDomains?.loginDomain}),(0,r.setApiConfig)({onCaptcha:l.handleCaptcha,domain:u?.apiConfigDomains?.apiDomain}),function(e){e[e.NotOriginalContent=28]="NotOriginalContent"}(m||(m={}))},819427:(e,t,n)=>{n.d(t,{StickerManager:()=>a});var o=n(902947),i=n(159532),s=n(290161);class a{add(e,t=!1){if(this.stickers.length>8)return;const n=new Image;n.onload=()=>{this.stickers.push({img:n,id:e,x:t?this.likeStartX:this.stickerStartX,y:t?this.startY-60:this.startY,isLike:t,startTime:Date.now()+(0,o.irand)(0,600),speed:(0,o.irand)(2,3),size:t?20:64,scale:t?2:1,opacity:t?.8:0,rotateDegree:(0,o.irand)(0,4),rotateDirection:Math.random()<.5?-1:1}),this.drawNextFrame()},n.src=t?"data:image/svg+xml; charset=utf8, "+encodeURIComponent((0,s.getIcon20LikeCircleFillRed)().icon):i.Stickers.getStickerUrl(e,((0,o.isRetina)()?128:64)+"b")}drawSticker(e){if(e.startTime>Date.now()||!this.ctx)return;if(e.isLike&&(e.scale=2),e.y<=this.startY&&e.y>=this.startY-25){const t=e.opacity+.15;if(e.opacity=Math.min(t,1),!e.isLike){const t=e.scale+.04;e.scale=Math.min(t,1)}}else if(e.y>=this.endY&&e.y<=this.endY+25){const t=e.opacity-.15;e.opacity=Math.max(t,0)}const t=e.size*e.scale,n=1===e.scale?e.x:e.x+(e.size-t)/2;e.rotateDegree+=.1*e.rotateDirection,e.rotateDegree<0?(e.rotateDegree=0,e.rotateDirection*=-1):e.rotateDegree>4&&(e.rotateDegree=4,e.rotateDirection*=-1),e.y-=e.speed,this.ctx&&(this.ctx.globalAlpha=e.opacity),this.ctx.setTransform(e.scale,0,0,e.scale,n,e.y),this.ctx.rotate(e.rotateDegree*Math.PI/180),this.ctx.drawImage(e.img,n,e.y),this.ctx&&(this.ctx.globalAlpha=1)}drawNextFrame(){this.isRendering||(this.isRendering=!0,this.rAF=requestAnimationFrame(this.animate))}destroy(){this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null)}constructor(e){this.stickers=[],this.endY=32,this.isRendering=!1,this.scaleRatio=1,this.animate=()=>{this.ctx&&(this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvasWidth*this.scaleRatio,this.canvasHeight*this.scaleRatio),this.stickers=this.stickers.filter((e=>e.y>this.endY)),this.stickers.forEach((e=>{this.drawSticker(e)})),this.isRendering=!1,this.stickers.some((e=>e.y>this.endY))?this.drawNextFrame():(this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvasWidth*this.scaleRatio,this.canvasHeight*this.scaleRatio)))},this.ctx=e.getContext("2d"),this.canvasWidth=e.width,this.canvasHeight=e.height,this.stickerStartX=(this.canvasWidth-64)/2,this.likeStartX=this.canvasWidth-20-20,this.startY=this.canvasHeight-64,this.ctx&&(0,o.isRetina)()&&(this.scaleRatio=window.devicePixelRatio||1,this.ctx.canvas.width=this.canvasWidth*this.scaleRatio,this.ctx.canvas.height=this.canvasHeight*this.scaleRatio,this.ctx.canvas.style.width=`${this.canvasWidth}px`,this.ctx.canvas.style.height=`${this.canvasHeight}px`,this.ctx.scale(this.scaleRatio,this.scaleRatio))}}},358769:(e,t,n)=>{n.d(t,{VideoChat:()=>y});var o=n(785893),i=n(667294),s=n(906811),a=n(540246),r=n(258037),l=n(780891),c=n(693573),d=n(715201),u=n(800856),m=n(493829),h=n(22378),p=n(659397),g=n(952464),f=n(936967),_=n(896568),v=n(161950),w=n(814390);const y=({messages:e,firstMessageIntroText:t})=>{const[n,y]=(0,i.useState)(e),[C,S]=(0,i.useState)(!1),[M,b]=(0,i.useState)(!1),[E,x]=(0,i.useState)(0),[k,T]=(0,i.useState)(null),I=(0,i.useRef)(null),R=e=>{e.scrollToIndex(1e3,{align:"end",behavior:"auto"}),b(!1),S(!1)},B=(0,s.useVirtualizer)({count:n.length,overscan:5,estimateSize:()=>36,getScrollElement:()=>I.current,paddingStart:E,onChange:e=>{const{isScrolling:t,scrollDirection:n,getTotalSize:o,scrollElement:i}=e;if(!i)return;const s=o(),a=i.clientHeight+i.scrollTop+30<s;M&&a&&window.VideoChat?.toggleScrollBottomBtn(!0),t&&"backward"===n&&i.clientHeight+i.scrollTop!==s?S(!0):(i.clientHeight+i.scrollTop===s&&(S(!1),b(!1),window.VideoChat?.toggleScrollBottomBtn(!1)),C||R(B))}});if((0,i.useEffect)((()=>{let e;return k&&(e=setTimeout((()=>{T(null)}),1e3)),()=>{clearTimeout(e)}}),[k]),(0,i.useEffect)((()=>{const e=e=>{const{eventType:t}=e.detail;switch(t){case f.CustomEventType.NEW_MESSAGES:const t=e.detail.data;y((e=>{let n=[...e,...t];n=(0,v.removeDuplicateById)(n);const o=Math.max(n.length-50,0);return o>0&&(n=n.slice(o)),n})),b(!0),B.notify();break;case f.CustomEventType.DELETE_MESSAGE:const{msgId:o,stubText:i}=e.detail.data,s=n.findIndex((e=>e.id===String(o)));-1!==s&&(y((e=>(e[s].text=i,e[s].deleted=!0,e))),C||R(B),B.notify());break;case f.CustomEventType.SCROLL_BOTTOM:R(B);break;case f.CustomEventType.HIGHLIGHT_MESSAGE:const a=e.detail.data,r=n.findIndex((e=>e.id===String(a)));-1!==r&&(B.scrollToIndex(r,{align:"end",behavior:"auto"}),T(n[r].id));break;case f.CustomEventType.UPDATE_TOP_PADDING:x(e.detail.data)}};return window.addEventListener(f.CustomEventName,e),()=>{window.removeEventListener(f.CustomEventName,e)}}),[n,C]),(0,i.useEffect)((()=>{n.length&&R(B)}),[]),!n.length)return(0,o.jsx)("div",{className:g.default.stub,children:(0,o.jsx)(r.Placeholder,{icon:(0,o.jsx)(a.Icon56CommentsOutline,{}),children:t})});const D=B.getVirtualItems();return(0,o.jsx)(l.AppRootProvider,{children:(0,o.jsx)(c.AppearanceProvider,{value:"dark",children:(0,o.jsx)(d.CustomScrollView,{boxRef:I,className:g.default.scroll,children:(0,o.jsx)("div",{className:g.default.in,style:{height:B.getTotalSize()},children:D.map((({key:e,index:t,start:i})=>{const{owner_href:s,photo_url:a,text:r,can_delete:l,can_report:c,can_pin:d,deleted:f}=n[t];return(0,o.jsxs)("div",{"data-index":t,ref:B.measureElement,className:(0,p.classNames)(g.default.message,{[g.default.messageHighlight]:n[t].id===k}),style:{transform:`translateY(${i}px)`},children:[(0,o.jsx)(u.Link,{href:s,target:"_blank",children:(0,o.jsx)(m.Avatar,{src:a,size:24,loading:"lazy"})}),(0,o.jsxs)("div",{className:(0,p.classNames)(g.default.messageContent,{[g.default.deleteMessageContent]:f}),children:[!f&&(0,o.jsx)(w.VideoChatOwnerName,{message:n[t]}),(0,o.jsx)(h.InnerHTML,{className:g.default.messageText,Component:"span",children:r})]}),!f&&(l||d||c)&&(0,o.jsx)(_.VideoChatMessageActions,{message:n[t]})]},e)}))})})})})}},896568:(e,t,n)=>{n.d(t,{VideoChatMessageActions:()=>p});var o=n(785893),i=n(904093),s=n(579431),a=n(17117),r=n(385228),l=n(471828),c=n(924766),d=n(152827),u=n(981284),m=n(595815),h=n(952464);const p=({message:e})=>{const{id:t,owner_id:n,author_id:p,owner_href:g,owner_name:f,is_verified:_,text:v,can_delete:w,can_report:y,can_pin:C,action_hash:S}=e,M=()=>{window.VideoChat?.pinMessage(n,p,f,g,_,t,w,y,v)},b=()=>{window.VideoChat?.deleteMessage((0,m.joinRawId)({ownerId:n,itemId:Number(t)}),S)},E=()=>{window.VideoChat?.showReportVideoChatCommentForm(n,t)};return[C,w,y].filter(Boolean).length>1?(0,o.jsx)("div",{className:h.default.messageActions,children:(0,o.jsx)(c.DropdownActionSheet,{placement:"bottom-start",content:(0,o.jsxs)(o.Fragment,{children:[C&&(0,o.jsx)(c.DropdownActionSheet.Item,{type:"contrast",onClick:M,before:(0,o.jsx)(i.Icon20PinOutline,{}),children:l.getLang("video_pin_message")}),w&&(0,o.jsx)(c.DropdownActionSheet.Item,{type:"contrast",onClick:b,before:(0,o.jsx)(s.Icon20Cancel,{}),children:l.getLang("global_delete")}),y&&(0,o.jsx)(c.DropdownActionSheet.Item,{type:"contrast",onClick:E,before:(0,o.jsx)(a.Icon20ReportOutline,{}),children:l.getLang("global_report_spam")})]}),children:(0,o.jsx)(r.Icon20More,{})})}):(0,o.jsx)("div",{className:h.default.messageActions,children:(0,o.jsxs)(o.Fragment,{children:[C&&(0,o.jsx)(d.TextTooltip,{text:l.getLang("video_pin_message"),placement:"right",children:(0,o.jsx)(u.IconButton,{noPadding:!0,activeMode:"opacity",hoverMode:"opacity",onClick:M,children:(0,o.jsx)(i.Icon20PinOutline,{})})}),w&&(0,o.jsx)(d.TextTooltip,{text:l.getLang("global_delete"),placement:"right",children:(0,o.jsx)(u.IconButton,{noPadding:!0,activeMode:"opacity",hoverMode:"opacity",onClick:b,children:(0,o.jsx)(s.Icon20Cancel,{})})}),y&&(0,o.jsx)(d.TextTooltip,{text:l.getLang("global_report_spam"),placement:"right",children:(0,o.jsx)(u.IconButton,{noPadding:!0,activeMode:"opacity",hoverMode:"opacity",onClick:E,children:(0,o.jsx)(a.Icon20ReportOutline,{})})})]})})}},814390:(e,t,n)=>{n.d(t,{VideoChatOwnerName:()=>c});var o=n(785893),i=n(20403),s=n(27773),a=n(800856),r=n(264003),l=n(952464);const c=({message:e})=>{const{owner_id:t,author_id:n,owner_href:c,owner_name:d,is_verified:u}=e,m=n===t,h=m?l.default.adminOwnerName:l.default.ownerName,p=(0,o.jsx)(o.Fragment,{children:u?(0,o.jsx)(s.VerifiedLabel,{href:c,target:"_blank",children:(0,o.jsx)("span",{className:h,children:d})}):(0,o.jsx)(a.Link,{href:c,target:"_blank",children:(0,o.jsx)("span",{className:h,children:d})})});return m?(0,o.jsx)("span",{className:l.default.adminOwnerNameWrapper,children:(0,o.jsx)(r.ContentBadge,{rounded:!0,type:"text",appearance:"accent-tint",size:"m",after:(0,o.jsx)(i.Icon12Favorite,{}),children:p})}):p}},936967:(e,t,n)=>{n.d(t,{CustomEventName:()=>o,CustomEventType:()=>i});const o="VideoCustomEvent/CHAT_UPDATE";var i;!function(e){e.NEW_MESSAGES="NEW_MESSAGES",e.DELETE_MESSAGE="DELETE_MESSAGE",e.SCROLL_BOTTOM="SCROLL_BOTTOM",e.HIGHLIGHT_MESSAGE="HIGHLIGHT_MESSAGE",e.UPDATE_TOP_PADDING="UPDATE_TOP_PADDING"}(i||(i={}))},745290:(e,t,n)=>{n.d(t,{VideoChatHideButton:()=>c});var o=n(785893),i=n(667294),s=n(659397),a=n(780891),r=n(693573),l=n(878371);const c=({btnText:e})=>{const t=(0,i.useCallback)((0,s.debounce)((e=>window.Videoview?.toggleSideBlock?.(e)),100),[]);return(0,o.jsx)(a.AppRootProvider,{children:(0,o.jsx)(r.AppearanceProvider,{value:"dark",children:(0,o.jsx)("button",{className:l.default.button,onClick:t,id:"video_chat_hide_button",children:e})})})}},665811:(e,t,n)=>{n.d(t,{VideoChatHideButtonComponent:()=>l});var o=n(42374),i=n(745290),s=n(4139);const a="VideoChatHideButton";let r;const l={init:function(e){(0,o.getReactRootEl)(a)&&(r=(0,s.createReactInitiator)(i.VideoChatHideButton,(0,o.getReactRootEl)(a)),r.render(e))},destroy:function(){r?.unmount?.()}}},699906:(e,t,n)=>{n.d(t,{VideoChatComponent:()=>r});var o=n(42374),i=n(358769),s=n(4139);let a;const r={init:function(e){a=(0,s.createReactInitiator)(i.VideoChat,(0,o.getReactRootEl)("VideoChat")),a.render(e)},destroy:function(){a?.unmount()}}},294857:(e,t,n)=>{n.d(t,{APP_NAME:()=>o,PinnedMessageComponent:()=>i});const o="PinnedMessage";const i={init:function(e){window.initReactApplication(o,e||{})}}},634042:(e,t,n)=>{n.d(t,{getMsgElement:()=>o});const o=(e,t)=>document.querySelector(`#mv_chat_msg${e}_${t}`)},834347:(e,t,n)=>{function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}n.d(t,{extends:()=>o})},906811:(e,t,n)=>{n.d(t,{useVirtualizer:()=>c,useWindowVirtualizer:()=>d});var o=n(834347),i=n(667294),s=n(973935),a=n(945032),r="undefined"!=typeof document?i.useLayoutEffect:i.useEffect;function l(e){var t=i.useReducer((function(){return{}}),{})[1],n=(0,o.extends)({},e,{onChange:function(n,o){o?(0,s.flushSync)(t):t(),null==e.onChange||e.onChange(n,o)}}),l=i.useState((function(){return new a.Virtualizer(n)}))[0];return l.setOptions(n),i.useEffect((function(){return l._didMount()}),[]),r((function(){return l._willUpdate()})),l}function c(e){return l((0,o.extends)({observeElementRect:a.observeElementRect,observeElementOffset:a.observeElementOffset,scrollToFn:a.elementScroll},e))}function d(e){return l((0,o.extends)({getScrollElement:function(){return"undefined"!=typeof document?window:null},observeElementRect:a.observeWindowRect,observeElementOffset:a.observeWindowOffset,scrollToFn:a.windowScroll,initialOffset:"undefined"!=typeof document?window.scrollY:void 0},e))}},148849:(e,t,n)=>{function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}n.d(t,{extends:()=>o})},945032:(e,t,n)=>{n.d(t,{Virtualizer:()=>p,defaultRangeExtractor:()=>a,elementScroll:()=>h,observeElementOffset:()=>c,observeElementRect:()=>r,observeWindowOffset:()=>d,observeWindowRect:()=>l,windowScroll:()=>m});var o=n(148849),i=n(301257),s=function(e){return e},a=function(e){for(var t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),o=[],i=t;i<=n;i++)o.push(i);return o},r=function(e,t){var n=e.scrollElement;if(n){var o=function(e){var n=e.width,o=e.height;t({width:Math.round(n),height:Math.round(o)})};o(n.getBoundingClientRect());var i=new ResizeObserver((function(e){var t=e[0];if(null!=t&&t.borderBoxSize){var i=t.borderBoxSize[0];if(i)return void o({width:i.inlineSize,height:i.blockSize})}o(n.getBoundingClientRect())}));return i.observe(n,{box:"border-box"}),function(){i.unobserve(n)}}},l=function(e,t){var n=e.scrollElement;if(n){var o=function(){t({width:n.innerWidth,height:n.innerHeight})};return o(),n.addEventListener("resize",o,{passive:!0}),function(){n.removeEventListener("resize",o)}}},c=function(e,t){var n=e.scrollElement;if(n){var o=function(){t(n[e.options.horizontal?"scrollLeft":"scrollTop"])};return o(),n.addEventListener("scroll",o,{passive:!0}),function(){n.removeEventListener("scroll",o)}}},d=function(e,t){var n=e.scrollElement;if(n){var o=function(){t(n[e.options.horizontal?"scrollX":"scrollY"])};return o(),n.addEventListener("scroll",o,{passive:!0}),function(){n.removeEventListener("scroll",o)}}},u=function(e,t,n){if(null!=t&&t.borderBoxSize){var o=t.borderBoxSize[0];if(o)return Math.round(o[n.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[n.options.horizontal?"width":"height"])},m=function(e,t,n){var o,i,s=t.adjustments,a=void 0===s?0:s,r=t.behavior,l=e+a;null==(o=n.scrollElement)||null==o.scrollTo||o.scrollTo(((i={})[n.options.horizontal?"left":"top"]=l,i.behavior=r,i))},h=function(e,t,n){var o,i,s=t.adjustments,a=void 0===s?0:s,r=t.behavior,l=e+a;null==(o=n.scrollElement)||null==o.scrollTo||o.scrollTo(((i={})[n.options.horizontal?"left":"top"]=l,i.behavior=r,i))},p=function(e){var t,n,r=this;this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(t=null,n=function(){return t||("undefined"!=typeof ResizeObserver?t=new ResizeObserver((function(e){e.forEach((function(e){r._measureElement(e.target,e)}))})):null)},{disconnect:function(){var e;return null==(e=n())?void 0:e.disconnect()},observe:function(e){var t;return null==(t=n())?void 0:t.observe(e,{box:"border-box"})},unobserve:function(e){var t;return null==(t=n())?void 0:t.unobserve(e)}}),this.range=null,this.setOptions=function(e){Object.entries(e).forEach((function(t){var n=t[0];void 0===t[1]&&delete e[n]})),r.options=(0,o.extends)({debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:s,rangeExtractor:a,onChange:function(){},measureElement:u,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1},e)},this.notify=function(e){null==r.options.onChange||r.options.onChange(r,e)},this.maybeNotify=(0,i.memo)((function(){return r.calculateRange(),[r.isScrolling,r.range?r.range.startIndex:null,r.range?r.range.endIndex:null]}),(function(e){r.notify(e)}),{key:!1,debug:function(){return r.options.debug},initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=function(){r.unsubs.filter(Boolean).forEach((function(e){return e()})),r.unsubs=[],r.scrollElement=null},this._didMount=function(){return r.measureElementCache.forEach(r.observer.observe),function(){r.observer.disconnect(),r.cleanup()}},this._willUpdate=function(){var e=r.options.getScrollElement();r.scrollElement!==e&&(r.cleanup(),r.scrollElement=e,r._scrollToOffset(r.scrollOffset,{adjustments:void 0,behavior:void 0}),r.unsubs.push(r.options.observeElementRect(r,(function(e){r.scrollRect=e,r.maybeNotify()}))),r.unsubs.push(r.options.observeElementOffset(r,(function(e){r.scrollAdjustments=0,r.scrollOffset!==e&&(null!==r.isScrollingTimeoutId&&(clearTimeout(r.isScrollingTimeoutId),r.isScrollingTimeoutId=null),r.isScrolling=!0,r.scrollDirection=r.scrollOffset<e?"forward":"backward",r.scrollOffset=e,r.maybeNotify(),r.isScrollingTimeoutId=setTimeout((function(){r.isScrollingTimeoutId=null,r.isScrolling=!1,r.scrollDirection=null,r.maybeNotify()}),r.options.scrollingDelay))}))))},this.getSize=function(){return r.scrollRect[r.options.horizontal?"width":"height"]},this.memoOptions=(0,i.memo)((function(){return[r.options.count,r.options.paddingStart,r.options.scrollMargin,r.options.getItemKey]}),(function(e,t,n,o){return r.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:o}}),{key:!1}),this.getFurthestMeasurement=function(e,t){for(var n=new Map,o=new Map,i=t-1;i>=0;i--){var s=e[i];if(!n.has(s.lane)){var a=o.get(s.lane);if(null==a||s.end>a.end?o.set(s.lane,s):s.end<a.end&&n.set(s.lane,!0),n.size===r.options.lanes)break}}return o.size===r.options.lanes?Array.from(o.values()).sort((function(e,t){return e.end-t.end}))[0]:void 0},this.getMeasurements=(0,i.memo)((function(){return[r.memoOptions(),r.itemSizeCache]}),(function(e,t){var n=e.count,o=e.paddingStart,i=e.scrollMargin,s=e.getItemKey,a=r.pendingMeasuredCacheIndexes.length>0?Math.min.apply(Math,r.pendingMeasuredCacheIndexes):0;r.pendingMeasuredCacheIndexes=[];for(var l=r.measurementsCache.slice(0,a),c=a;c<n;c++){var d=s(c),u=1===r.options.lanes?l[c-1]:r.getFurthestMeasurement(l,c),m=u?u.end:o+i,h=t.get(d),p="number"==typeof h?h:r.options.estimateSize(c),g=m+p,f=u?u.lane:c%r.options.lanes;l[c]={index:c,start:m,size:p,end:g,key:d,lane:f}}return r.measurementsCache=l,l}),{key:!1,debug:function(){return r.options.debug}}),this.calculateRange=(0,i.memo)((function(){return[r.getMeasurements(),r.getSize(),r.scrollOffset]}),(function(e,t,n){return r.range=e.length>0&&t>0?function(e){var t=e.measurements,n=e.outerSize,o=e.scrollOffset,i=t.length-1,s=function(e){return t[e].start},a=g(0,i,s,o),r=a;for(;r<i&&t[r].end<o+n;)r++;return{startIndex:a,endIndex:r}}({measurements:e,outerSize:t,scrollOffset:n}):null}),{key:!1,debug:function(){return r.options.debug}}),this.getIndexes=(0,i.memo)((function(){return[r.options.rangeExtractor,r.calculateRange(),r.options.overscan,r.options.count]}),(function(e,t,n,i){return null===t?[]:e((0,o.extends)({},t,{overscan:n,count:i}))}),{key:!1,debug:function(){return r.options.debug}}),this.indexFromElement=function(e){var t=r.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn("Missing attribute name '"+t+"={index}' on measured element."),-1)},this._measureElement=function(e,t){var n=r.measurementsCache[r.indexFromElement(e)];if(n&&e.isConnected){var o=r.measureElementCache.get(n.key);o!==e&&(o&&r.observer.unobserve(o),r.observer.observe(e),r.measureElementCache.set(n.key,e));var i=r.options.measureElement(e,t,r);r.resizeItem(n,i)}else r.measureElementCache.forEach((function(t,n){t===e&&(r.observer.unobserve(e),r.measureElementCache.delete(n))}))},this.resizeItem=function(e,t){var n,o=t-(null!=(n=r.itemSizeCache.get(e.key))?n:e.size);0!==o&&(e.start<r.scrollOffset&&r._scrollToOffset(r.scrollOffset,{adjustments:r.scrollAdjustments+=o,behavior:void 0}),r.pendingMeasuredCacheIndexes.push(e.index),r.itemSizeCache=new Map(r.itemSizeCache.set(e.key,t)),r.notify(!1))},this.measureElement=function(e){e&&r._measureElement(e,void 0)},this.getVirtualItems=(0,i.memo)((function(){return[r.getIndexes(),r.getMeasurements()]}),(function(e,t){for(var n=[],o=0,i=e.length;o<i;o++){var s=t[e[o]];n.push(s)}return n}),{key:!1,debug:function(){return r.options.debug}}),this.getVirtualItemForOffset=function(e){var t=r.getMeasurements();return(0,i.notUndefined)(t[g(0,t.length-1,(function(e){return(0,i.notUndefined)(t[e]).start}),e)])},this.getOffsetForAlignment=function(e,t){var n=r.getSize();"auto"===t&&(t=e<=r.scrollOffset?"start":e>=r.scrollOffset+n?"end":"start"),"start"===t||("end"===t?e-=n:"center"===t&&(e-=n/2));var o=r.options.horizontal?"scrollWidth":"scrollHeight",i=(r.scrollElement?"document"in r.scrollElement?r.scrollElement.document.documentElement[o]:r.scrollElement[o]:0)-r.getSize();return Math.max(Math.min(i,e),0)},this.getOffsetForIndex=function(e,t){void 0===t&&(t="auto"),e=Math.max(0,Math.min(e,r.options.count-1));var n=(0,i.notUndefined)(r.getMeasurements()[e]);if("auto"===t)if(n.end>=r.scrollOffset+r.getSize()-r.options.scrollPaddingEnd)t="end";else{if(!(n.start<=r.scrollOffset+r.options.scrollPaddingStart))return[r.scrollOffset,t];t="start"}var o="end"===t?n.end+r.options.scrollPaddingEnd:n.start-r.options.scrollPaddingStart;return[r.getOffsetForAlignment(o,t),t]},this.isDynamicMode=function(){return r.measureElementCache.size>0},this.cancelScrollToIndex=function(){null!==r.scrollToIndexTimeoutId&&(clearTimeout(r.scrollToIndexTimeoutId),r.scrollToIndexTimeoutId=null)},this.scrollToOffset=function(e,t){var n=void 0===t?{}:t,o=n.align,i=void 0===o?"start":o,s=n.behavior;r.cancelScrollToIndex(),"smooth"===s&&r.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r._scrollToOffset(r.getOffsetForAlignment(e,i),{adjustments:void 0,behavior:s})},this.scrollToIndex=function(e,t){var n=void 0===t?{}:t,o=n.align,s=void 0===o?"auto":o,a=n.behavior;e=Math.max(0,Math.min(e,r.options.count-1)),r.cancelScrollToIndex(),"smooth"===a&&r.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");var l=r.getOffsetForIndex(e,s),c=l[0],d=l[1];r._scrollToOffset(c,{adjustments:void 0,behavior:a}),"smooth"!==a&&r.isDynamicMode()&&(r.scrollToIndexTimeoutId=setTimeout((function(){if(r.scrollToIndexTimeoutId=null,r.measureElementCache.has(r.options.getItemKey(e))){var t=r.getOffsetForIndex(e,d)[0];(0,i.approxEqual)(t,r.scrollOffset)||r.scrollToIndex(e,{align:d,behavior:a})}else r.scrollToIndex(e,{align:d,behavior:a})})))},this.scrollBy=function(e,t){var n=(void 0===t?{}:t).behavior;r.cancelScrollToIndex(),"smooth"===n&&r.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r._scrollToOffset(r.scrollOffset+e,{adjustments:void 0,behavior:n})},this.getTotalSize=function(){var e;return((null==(e=r.getMeasurements()[r.options.count-1])?void 0:e.end)||r.options.paddingStart)-r.options.scrollMargin+r.options.paddingEnd},this._scrollToOffset=function(e,t){var n=t.adjustments,o=t.behavior;r.options.scrollToFn(e,{behavior:o,adjustments:n},r)},this.measure=function(){r.itemSizeCache=new Map,r.notify(!1)},this.setOptions(e),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach((function(e){r.itemSizeCache.set(e.key,e.size)})),this.maybeNotify()},g=function(e,t,n,o){for(;e<=t;){var i=(e+t)/2|0,s=n(i);if(s<o)e=i+1;else{if(!(s>o))return i;t=i-1}}return e>0?e-1:0}},301257:(e,t,n)=>{function o(e,t,n){var o,i,s=null!=(o=n.initialDeps)?o:[];return function(){var o;n.key&&null!=n.debug&&n.debug()&&(o=Date.now());var a,r=e();if(!(r.length!==s.length||r.some((function(e,t){return s[t]!==e}))))return i;if(s=r,n.key&&null!=n.debug&&n.debug()&&(a=Date.now()),i=t.apply(void 0,r),n.key&&null!=n.debug&&n.debug()){var l=Math.round(100*(Date.now()-o))/100,c=Math.round(100*(Date.now()-a))/100,d=c/16,u=function(e,t){for(e=String(e);e.length<t;)e=" "+e;return e};console.info("%c⏱ "+u(c,5)+" /"+u(l,5)+" ms","\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl("+Math.max(0,Math.min(120-120*d,120))+"deg 100% 31%);",null==n?void 0:n.key)}return null==n||null==n.onChange||n.onChange(i),i}}function i(e,t){if(void 0===e)throw new Error("Unexpected undefined"+(t?": "+t:""));return e}n.d(t,{approxEqual:()=>s,memo:()=>o,notUndefined:()=>i});var s=function(e,t){return Math.abs(e-t)<1}}}]);try{stManager.done("dist/web/chunks/de31987e.0fb9c930.js")}catch(e){}