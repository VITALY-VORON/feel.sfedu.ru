(()=>{"use strict";var __webpack_modules__={46131:(e,_,s)=>{s.d(_,{Icon24UserAddOutline:()=>r});var r=(0,s(28178).makeIcon)("Icon24UserAddOutline","user_add_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="user_add_outline_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path fill="currentColor" fill-rule="nonzero" d="M18.85 7.95A2.85 2.85 0 0 0 16 5.1a2.85 2.85 0 0 0-2.85 2.85A2.85 2.85 0 0 0 16 10.8a2.85 2.85 0 0 0 2.85-2.85m1.8 0A4.65 4.65 0 0 1 16 12.6a4.65 4.65 0 0 1-4.65-4.65A4.65 4.65 0 0 1 16 3.3a4.65 4.65 0 0 1 4.65 4.65M9.9 18.429c0 .768-.09.671.335.671h11.53c.426 0 .335.097.335-.671 0-1.893-2.778-3.029-6.1-3.029s-6.1 1.136-6.1 3.029m-4-8.329h2.7a.9.9 0 1 1 0 1.8H5.9v2.7a.9.9 0 1 1-1.8 0v-2.7H1.4a.9.9 0 1 1 0-1.8h2.7V7.4a.9.9 0 1 1 1.8 0zm2.2 8.329c0-3.327 3.673-4.829 7.9-4.829s7.9 1.502 7.9 4.829c0 1.735-.686 2.471-2.135 2.471h-11.53c-1.45 0-2.135-.736-2.135-2.471" /></g></symbol>',24,24,!1,void 0)},246164:(e,_,s)=>{s.d(_,{default:()=>r});const r={content:"PageBlock-module__content--Kz7Ae"}},687164:(e,_,s)=>{s.d(_,{FriendsAddResponseEnumNames:()=>r});const r={SEND:1,APPROVED:2,RESEND:4}},146427:(e,_,s)=>{s.d(_,{FriendsFriendStatusStatusEnumNames:()=>r});const r={NOT_A_FRIEND:0,OUTCOMING_REQUEST:1,INCOMING_REQUEST:2,IS_FRIEND:3}},625492:(e,_,s)=>{s.d(_,{OwnerStateStateEnumNames:()=>r});const r={BANNED:1,ADULT:2,HIDDEN:3,DELETED:4,BLACKLISTED:5}},702029:(e,_,s)=>{function r(){return{icon:'<svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M3.53 2.46a.75.75 0 0 0-1.07 1.07L4.94 6 2.46 8.47a.75.75 0 1 0 1.07 1.07L6 7.06l2.47 2.48a.75.75 0 0 0 1.07-1.07L7.06 6l2.48-2.47a.75.75 0 1 0-1.07-1.07L6 4.94z" fill="currentColor"/></svg>',name:"cancel_12"}}s.d(_,{getIcon12Cancel:()=>r})},558149:(e,_,s)=>{function r(){return{icon:'<svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M16 32a1.5 1.5 0 0 1 0-3 13 13 0 1 0-12.2-8.5 1.5 1.5 0 1 1-2.81 1.04A15.97 15.97 0 0 1 0 16a16 16 0 1 1 16 16Z" fill="currentColor"/></svg>',name:"spinner_32"}}s.d(_,{getIcon32Spinner:()=>r})},430228:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(379440),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15042),_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(902947),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(449147),_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(97875),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(255693),_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(762003),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(261712),_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(70689),_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(488844),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(636322),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(159663),_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(877926),_friends_constants__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(505369),_shared_counters_updateCounters__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(656334),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(93367),_shared_lib_site__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(433830),_icons_desktop__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(558149),_icons_desktop__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(702029),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(251087),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(226059),_web_friends_templates_requestsTemplate__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(113348),_web_friends_templates_friendsTemplate__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(911658),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(977053),_web_friends_components_initFriendsRightBlocks__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(414284),_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(618418),_friends_utils__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(944313),_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(890623),_shared_friends_friends_stats__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(379696),_shared_friends_utils__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(35227),_web_friends_components_AddNewFriendsModal_index__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(402666),_shared_utils_onDomReady__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(833449),_web_components_ui_helpHintTooltip__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(31517),_shared_friends_cleanupConstants__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(835838);const drawFriendTemplateOptions=(e,_)=>{if(_.isInvite)return{info_actions:""};const s=e[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_LIST_FRIEND_OPTIONS_INDEX],r=!!s?.show_write_button,t=["all","online","recent"].includes(_.section)&&!!s?.show_call_button,n=Number(e[0])!==window.vk?.id&&["all","online"].includes(_.section)&&!!s?.show_add_friend_button,i=s?.friendship_status,o=s?.is_allowed_to_send_friend_request;let a="";i&&i===_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_STATUS_REQUEST_FROM_USER&&(a="friends_field_toggle_friend--cancelVisible");return{info_actions:[r?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.getTemplate)("friends_friend_info_action_write",{friend_id:e[0]}):void 0,r&&t?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.getTemplate)("friends_friend_info_action_call",{friend_id:e[0]}):void 0,n?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.getTemplate)("friends_friend_info_action_toggle_friend",{friend_id:e[0],hash:s?.friendship_toggle_hash,additional_class:a,action_text:o?cur.summaryLang.friends_add_to_friends:cur.summaryLang.global_fan_subscribe,request_send_text:o?cur.summaryLang.friends_add_request_sent:cur.summaryLang.friends_you_are_subscribed}):void 0].filter((e=>!!e)).join('<span class="divider-pixels"></span>')}},transformCommonFriendToFriend=e=>{const _=[...e];return _[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_IMAGE_STATUS_INDEX]=_[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.COMMON_FRIENDS_IMAGE_STATUS_INDEX],_[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.COMMON_FRIENDS_IMAGE_STATUS_INDEX]=null,_},Friends={init:function(e){if((0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackStartWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_MARK_START),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)(cur,{fSearchWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_search_cont","friends"),fSearch:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("s_search"),fSearchFilterLnk:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_search_fltr_control","market_search_wrap"),fSearchExtSearchLink:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_search_fltr_ext_link","market_search_wrap"),module:"friends",fListEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_list"),showMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("show_more"),pageEnd:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_end"),fContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("list_content"),fSearchContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_search_cont"),friendsTpl:(0,_web_friends_templates_friendsTemplate__WEBPACK_IMPORTED_MODULE_20__.friendsTemplate)(e),commonTpl:(0,_web_friends_templates_requestsTemplate__WEBPACK_IMPORTED_MODULE_19__.requestsTemplate)(e),savedMasks:{},friends:{},timeouts:{}}),this.prevStr="",cur.secData||(cur.secData={}),cur.curList=cur.section,(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_3__.placeholderInit)(cur.fSearch),setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("friends_search_input_wrap")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.elfocus)(cur.fSearch)}),0),Friends.scrollNode=window,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(Friends.scrollNode,"scroll",Friends.scrollResize),setTimeout((function(){(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_30__.pushNavDestroy)((()=>{clearTimeout(cur.resizeTimeout),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.removeEvent)(Friends.scrollNode,"scroll",Friends.scrollResize)}))}),0),Friends.initLoadAddFriendsModal(),!cur.silent){this.indexAll((function(){"list"==cur.section.substr(0,4)&&(cur.friendsList[cur.section]=Friends.filter(cur.friendsList.all,cur.section)),cur.friendsList[cur.section]&&cur.friendsList[cur.section].length||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_not_found")}));const e=(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackEndWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_MARK_START);(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.sendLoadingStats)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_STATLOG,e.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,outRequestsCount:window.cur.outRequestsCount,mode:_friends_utils__WEBPACK_IMPORTED_MODULE_23__.FriendsListLoadingMode.DEFAULT,httpStatus:200,section:window.cur.curList,errorMessage:"",loadingType:_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FriendsListLoadingType.INIT_BLOCKING,hasError:"false",userId:window.vk.id})}cur.nav.push(friendsNavHandler),cur.nav.push(friendsGroupInviteNavHandler),(0,_friends_utils__WEBPACK_IMPORTED_MODULE_23__.isFriendsLoadingBugfixEnabled)(cur.silent)?(0,_friends_utils__WEBPACK_IMPORTED_MODULE_23__.fillFriendsListWithDataFromServer)({friendsMethods:{showMore:Friends.showMore,filter:Friends.filter,indexAll:Friends.indexAll}}):cur.silent&&ajax.post("al_friends.php",{act:"load_friends_silent",id:cur.oid,gid:cur.gid,sort:nav.objLoc.sort,platform_id:nav.objLoc.platform_id,section:cur.section},{onDone:(e,_,s)=>{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(cur.showMore,"load_more"),cur.silent=!1,!e)return;cur.occupations=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)(cur.occupations||{},_);for(let _ in e)e.hasOwnProperty(_)&&(cur.friendsList[_]=e[_]);this.indexAll((function(){"list"==cur.section.substr(0,4)&&(cur.friendsList[cur.section]=Friends.filter(cur.friendsList.all,cur.section)),(cur.onSilentLoad||Friends.showMore)()})),s.cities&&window.stManager.add(["ui_controls.js","ui_controls.css"],(function(){cur.cityFilter.setData(s.cities),cur.cityFilterOpened&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_fltr_progress"),cur.cityFilter.showDefaultList())}));const r=(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackEndWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_MARK_START);(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.sendLoadingStats)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_STATLOG,r.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,outRequestsCount:window.cur.outRequestsCount,mode:_friends_utils__WEBPACK_IMPORTED_MODULE_23__.FriendsListLoadingMode.SILENT,httpStatus:200,section:window.cur.curList,errorMessage:"",loadingType:_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FriendsListLoadingType.INIT_BLOCKING,hasError:"false",userId:window.vk.id})},onFail:(e,_)=>{const s=(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackEndWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_MARK_START);let r="";r="string"==typeof e?e:e.message,(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.sendLoadingStats)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_STATLOG,s.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,outRequestsCount:window.cur.outRequestsCount,mode:_friends_utils__WEBPACK_IMPORTED_MODULE_23__.FriendsListLoadingMode.SILENT,httpStatus:_,section:window.cur.curList,errorMessage:r,loadingType:_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FriendsListLoadingType.INIT_BLOCKING,hasError:"true",userId:window.vk.id})},local:1})},initLoadAddFriendsModal:function(){new URLSearchParams(window.location.search).get(_shared_friends_cleanupConstants__WEBPACK_IMPORTED_MODULE_29__.SHOW_REC_MODAL_PARAM)===_shared_friends_cleanupConstants__WEBPACK_IMPORTED_MODULE_29__.SHOW_REC_MODAL_PARAM_TRUE_VAL&&Friends.showAddFriendsReccomendationModal()},indexAll:function(e){if(!cur.friendsList)return;let _=cur.friendsList.all;cur.friendsDomains={},cur.friendsIndex=new window.vkIndexer(_,(function(e){let _=parseInt(e[0]);if(cur.friends&&_){cur.friends[_]=e;let s=(e[2].startsWith("/")?e[2].slice(1):e[2])||"";s===`id${_}`&&(s=""),s&&cur.friendsDomains&&(cur.friendsDomains[s]=_);return[e[5]||"",s].join(" ")}return""}),(function(){cur.friendsList&&(cur.silent||(cur.friendsList.online=Friends.filter(_,"online"),"common"==cur.section&&(cur.friendsList.common=Friends.filter(_,"common")),e&&e()),Friends.initBackFunc())})),cur.section==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME&&Friends.indexPhone()},indexPhone:function(){cur.phoneIndex=new window.vkIndexer(cur.friendsList[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME],(function(e){if(!e[14])return"";let _=e[14][0]||"",s=e[14][1]||"",r=e[14][2]||"";const t=parseInt(e[0]);let n=(e[2].startsWith("/")?e[2].slice(1):e[2])||"";return n===`id${t}`&&(n=""),[e[5],_,_.replace(/[^0-9\+]/g,""),s,s.replace(/[^0-9\+]/g,""),r,n].join(" ")}))},initBackFunc:function(){cur._back={text:cur.backLang,show:[function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.addEvent)(Friends.scrollNode,"scroll",Friends.scrollResize)}],hide:[function(){if(Friends.searchTimout&&clearTimeout(Friends.searchTimout),cur.timeouts)for(let e in cur.timeouts)cur.timeouts.hasOwnProperty(e)&&clearTimeout(cur.timeouts);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.removeEvent)(Friends.scrollNode,"scroll",Friends.scrollResize)}]}},switchTab:function(e,_,s){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(s))return!0;uiTabs.switchTab(e);let r={0:"friends",section:_};return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(s)||nav.change(r)},switchMenu:function(e,_,s){if(void 0!==e.href&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(s))return!0;let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("ui_rmenu",e);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_rmenu_item_sel",r)==e)return!1;let t={0:"friends",section:_};return vk.id!=cur.oid&&(t.id=cur.oid),uiRightMenu.go(e,s,t),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_5__.scrollToTop)(0),!1},filter:function(e,_){let s=e?e.length:0,r=[],t=0;"list"==_.substr(0,4)&&(t=parseInt(_.substr(4)),_="list");for(let n=0;n<s;n++){let s=e[n];if(!cur.filterIds||cur.filterIds[parseInt(s[0])])switch(_){case"online":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.intval)(s[4])&&r.push(s);break;case"common":cur.commonCount&&s[11]&&r.push(s);break;case"list":parseInt(s[6])&1<<t&&r.push(s);break;default:r.push(s)}}return r},loadMore:function(start,end,forceSection){let section=forceSection||cur.section,list=cur.curList,curData=cur.secData[section],showMore=cur.showMore;curData.loading||(curData.loading=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(showMore,"load_more"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(showMore),(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackStartWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LOAD_MORE_MARK_START),ajax.post("/friends",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)({act:"get_section_friends",section,offset:start,id:cur.oid,gid:cur.gid,sort:nav.objLoc.sort},cur.filter),{onDone:function(data,preload){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(showMore,"load_more");let response=null;try{response=eval("("+data+")")}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__.logEvalError)(e,data)}if(!cur.friendsList)return;cur.friendsList[list]||(cur.friendsList[list]=[]),Array.prototype.push.apply(cur.friendsList[list],response[section]),this.showMore(!1,start,end),curData.loading=!1,curData.preload=preload;const measure=(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackEndWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LOAD_MORE_MARK_START);(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.sendLoadingStats)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_STATLOG,measure.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,outRequestsCount:window.cur.outRequestsCount,mode:_friends_utils__WEBPACK_IMPORTED_MODULE_23__.FriendsListLoadingMode.DEFAULT,httpStatus:200,section,errorMessage:"",loadingType:_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FriendsListLoadingType.LOAD_MORE,userId:window.vk.id,hasError:"false"})}.bind(this),onFail:(e,_)=>{const s=(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackEndWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LOAD_MORE_MARK_START);let r="";r="string"==typeof e?e:e.message,(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.sendLoadingStats)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_STATLOG,s.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,outRequestsCount:window.cur.outRequestsCount,mode:_friends_utils__WEBPACK_IMPORTED_MODULE_23__.FriendsListLoadingMode.DEFAULT,httpStatus:_,section,errorMessage:r,loadingType:_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FriendsListLoadingType.LOAD_MORE,hasError:"true",userId:window.vk.id})}}))},showMore:function(e,_,s,r){if(!cur.friendsList)return!1;let t=cur.curList,n=cur.friendsList[t],i=cur.friendsPerPage,o=cur.showMore,a=cur.section,d=cur.sectionCount,l=cur.shownFriends;const c=Friends.isInvitePage();if(-1===e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(cur.showMore,"manual")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(cur.showMore,"manual"),cur.pageEnd=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_search_wrap")),e=!1),!n||!n.length){if(0===cur.shownFriends&&!cur.searchCount){if(cur.isLoading)return!1;cur.searchStr?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)("friends_not_found","friends_search"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("search_ph").innerHTML=cur.searchStr.replace(/([<>&#]*)/g,"")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)("friends_not_found","friends_search"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)("friends_not_found","friends_only_other");let e="";"list"===cur.curList.substr(0,4)?cur.filterIds?(e=cur.summaryLang.list_not_found_filter,e=e.replace("{link}",'<a onclick="Friends.clearFilter(true);">').replace("{/link}","</a>")):(e=cur.summaryLang.list_not_found,e=e.replace("{link}",'<a onclick="Friends.editList(-1);">').replace("{/link}","</a>")):"requests"===cur.section?e=cur.summaryLang.friends_no_friend_requests:cur.filter?(e=cur.summaryLang.not_found_filter,e=e.replace("{link}",'<a onclick="Friends.clearFilter(true);">').replace("{/link}","</a>")):e=cur.summaryLang.not_found,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_not_found_text").innerHTML=e,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_not_found")}return e&&(cur.fContent.innerHTML=""),cur.searchCount&&Friends.serverSearchMore(),void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("show_more","friends_search_more")}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("friends_not_found")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_not_found"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)("friends_not_found","friends_only_other")),null==_&&(_=l),null==s&&(s=l+i);let u=n.slice(_,s);if(!u.length){let e=cur.secData[a];return e&&e.preload&&Friends.loadMore(_,s,a),cur.searchCount&&Friends.serverSearchMore(),void(l>=d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(o))}let E=[];e&&(cur.fContent.innerHTML="");for(let e in u){if(!u.hasOwnProperty(e))continue;let _=u[e];if(cur.selection){let _=u[e].slice();_[5]=_[5].replace(cur.selection.re,cur.selection.val)}if(++l,++cur.shownFriends,!_)continue;let s="";const r=drawFriendTemplateOptions(_,{isInvite:c,section:a});E.push(Friends.drawFriend(_,s,r))}if(r)return'<div class="friends_list_bl">'+E.join("")+"</div>";cur.fContent.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:E.join(""),className:"friends_list_bl"})),l>=d?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(o),cur.pageEnd=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_end")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(o)},updateList:function(e,_){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("catalog_new_friends_search_nps_triggers")&&!cur.isFriendNpsTriggerSent&&((0,_shared_friends_friends_stats__WEBPACK_IMPORTED_MODULE_25__.sendSearchFriendEvent)(),cur.isFriendNpsTriggerSent=!0),e||(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.removeSearchPositionTracker)("friends"),cur.silent)return cur.onSilentLoad=function(){Friends.updateList(e,!0)},void((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.trim)(e)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(cur.showMore),cur.fContent.innerHTML='<div class="friends_wide_loading">'+(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_31__.getIcon32Spinner)().icon+"</div>"));clearTimeout(Friends.searchTimout),Friends.searchTimout=setTimeout(function(){cur.searchStr=e,e?("all"!=cur.section&&cur.section!=_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME&&(this.selectTab("all"),this.selectSection("all"),cur.curList=cur.section="all",nav.setLoc((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)(nav.objLoc,{section:"all"}))),this.search(e,cur.section),this.changeSummary()):cur.section!=cur.curList||_?(this.showSection(),this.changeSummary(),this.showMore()):(this.hideLoading(),cur.searchCount=0,this.showMore()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(cur.fSearchWrap,"ui_search_fixed")&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_5__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_search_input_wrap").offsetTop,0)}.bind(Friends),10)},showSection:function(e){if(cur.shownFriends=cur.shownSugg=0,cur.curList=cur.section=e||cur.section,vk.id==cur.oid){let e="requests"==cur.section||"all_requests"==cur.section||"out_requests"==cur.section;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)("friends","friends_phonebook"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)("friends","friends_requests"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(cur.fSearchFilterLnk,"friends_sort_control","friends_sort_control_list_header","friends_req_block",cur.fSearchExtSearchLink),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_REQUESTS_TO_SUBSCRIBERS_CLASSES.ROOT,"unshown"),e){("requests"==cur.section&&cur.requestsCount>50||"all_requests"==cur.section&&cur.allRequestsCount>10)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_sort_control"),!cur.isFollowersModeEnabled||"requests"!=cur.section&&"all_requests"!=cur.section||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_REQUESTS_TO_SUBSCRIBERS_CLASSES.ROOT,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_REQUESTS_TO_SUBSCRIBERS_CLASSES.DONE_STEP,"unshown"),cur.friendsList.requests&&cur.friendsList.requests.length>0?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_REQUESTS_TO_SUBSCRIBERS_CLASSES.DESCRIPTION_STEP,"unshown"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_REQUESTS_TO_SUBSCRIBERS_CLASSES.DESCRIPTION_STEP,"unshown")),cur.isFollowersModeEnabled&&("requests"===cur.section?Friends.showListHeader(cur.summaryLang.friend_tab_applications):"out_requests"===cur.section&&Friends.showListHeader(cur.summaryLang.friends_section_out_requests)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_search_input_wrap","friends_search_header"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_sugg_header");let e=(cur.requestsCount?1:0)+(cur.allRequestsCount?1:0)+(cur.outRequestsCount?1:0);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_section_requests","narrow_column"),cur.isFollowersModeEnabled?Boolean(cur.requestsCount):e>=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)("friends_tab_requests",cur.requestsCount>0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)("friends_tab_all_requests",cur.allRequestsCount>0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggle)("friends_tab_out_requests",cur.outRequestsCount>0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)("friends","friends_requests"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_friends_list","friends_req_block"),"")}else if(cur.isFollowersModeEnabled&&cur.section==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FOLLOWERS_SECTION_NAME)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_search_input_wrap"),cur.followersCount>10&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_sort_control_list_header"),Friends.showListHeader(cur.summaryLang.friends_tab_followers);else if(cur.section==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_search_input_wrap",cur.fSearchFilterLnk),Friends.showListHeader(cur.summaryLang.friends_filter_phonebook),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)("friends","friends_phonebook");else if("recent"==cur.section)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_search_input_wrap",cur.fSearchFilterLnk),Friends.showListHeader(cur.summaryLang.friends_tab_recently_added);else if("members"==cur.section)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_search_input_wrap",cur.fSearchExtSearchLink);else if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_sugg_header"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_search_input_wrap","friends_search_header",cur.fSearchFilterLnk),cur.requestsCount&&cur.friendsList.requests){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_req_block");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_friends_list",e).innerHTML=cur.commonTpl(cur.friendsList.requests[0],"requests"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(e)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_label",cur.showMore),e?cur.summaryLang.friends_show_more_requests:cur.summaryLang.friends_show_more_friends)}else cur.gid||("subscribers"==cur.section?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_search_input_wrap"),Friends.showListHeader(cur.summaryLang.friends_tab_subscribers)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_search_input_wrap"));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("friends_search_input_wrap")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.elfocus)(cur.fSearch),cur.filterIds&&(cur.curList+="_filter");let _,s=cur.friendsList[cur.curList];if(s||(_="recent"==e||e==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME||"requests"==e?e:"all",s=cur.friendsList[cur.curList]=this.filter(cur.friendsList[_],cur.section)),cur.sectionCount=s?s.length:0,cur.selection=!1,cur.filter&&!cur.filterIds)return Friends.changeFilter(),cur.searchStr||this.clearServerSearch(),!1;this.showMore(!0)},updateView:function(){cur.fContent.innerHTML=this.showMore(!1,0,cur.shownFriends,!0)},showLoading:function(){cur.isLoading=1,uiSearch&&uiSearch.showProgress("s_search")},hideLoading:function(){cur.isLoading=0,uiSearch&&uiSearch.hideProgress("s_search")},serverSearchMore:function(){"requests"!=cur.section?cur.serverLoadingMore||cur.searchFinished||(cur.serverLoadingMore=!0,ajax.post("friends",{act:"server_search",q:cur.searchStr,offset:cur.searchOffset,exclude:cur.excludeList.join(",")},{onDone:function(e,_,s,r,t){cur.searchFinished=s>=_||cur?.lastSearchOffset===s,cur.lastSearchOffset=s,cur.searchFinished&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_search_more"),cur.searchOffset=s,cur.serverLoadingMore=!1,e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_search_cont")?.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:e,className:"friends_list_bl"}))},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_search_more"),"load_more")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_search_more"),"load_more")}})):Friends.showMore()},serverSearch:function(e,_,s,r){cur.searchCount=0,Friends.showLoading(),cur.serverSearchStr=e,clearTimeout(cur.serverSearchTimeout);let t=[];for(let e in s)s.hasOwnProperty(e)&&t.push(s[e][0]);cur.excludeList=t,cur.serverSearchTimeout=setTimeout((()=>{ajax.post("friends",{act:"server_search",q:e,exclude:t.join(",")},{onDone:function(s,t,n,i,o){if((0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.saveSearchAttemptStats)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.serviceFriends,0,t,cur.serverSearchStr,r,i,o.query_duration,o.model_name,_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.blockNameSearch),cur.searchOffset=n,cur.searchFinished=!t,Friends.hideLoading(),cur.searchStr!=e)return;if(cur.searchCount=t,0==cur.shownFriends&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_search_wrap"),cur.fContent.innerHTML="",Friends.showMore()),(0,_shared_counters_updateCounters__WEBPACK_IMPORTED_MODULE_14__.updateCounters)(location.href,document.referrer),!t)return void Friends.changeSummary();cur.searchFinished?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_search_more"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_search_more");const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_search_cont");a&&(a.innerHTML='<div class="friends_list_bl">'+s+"</div>",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_search_wrap"),Friends.changeSummary(),_?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)("friends_not_found","friends_only_other"):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)("friends_not_found","friends_only_other"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)("friends_not_found","friends_search"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_not_found")))},onFail:Friends.hideLoading})}),300)},clearServerSearch:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_search_wrap"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_search_more"),cur.searchCount=0,cur.pageEnd=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("page_end")},goToSearch:function(e){nav.go("friends?act=find&c%5Bname%5D=1&c%5Bq%5D="+encodeURIComponent(cur.searchStr)+"&c%5Bsection%5D=people&c[per_page]=40")},search:function(e,_,s,r){const t=(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.generateQID)();let n,i,o;cur.shownFriends=0,cur.section=_;let a=0;const[d,l]=extractUserParameters(e);if(d?a=d:l&&cur.friendsDomains&&cur.friendsDomains[l]&&(a=Number(cur.friendsDomains[l]),Number.isNaN(a)&&(a=0)),e){if(i=_==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME?cur.phoneIndex:cur.friendsIndex,-1==e)n=_==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME?_:"all",o=this.filter(cur.friendsList[n],_),(e="")!=cur.searchStr&&this.clearServerSearch();else{if(a&&cur.friends){const e=cur.friends.hasOwnProperty(a)?cur.friends[a]:null;e&&(o=[e])}o||(o=i.search(e)),cur.filterIds&&(o=this.filter(o,_));let s=o.length;if(s&&(e==cur.serverSearchStr||cur.sectionCount||this.clearServerSearch()),e.trim()!==this.prevStr){const _=cur.oid==vk.id?_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.serviceFriends:_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.serviceUserFriends;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.saveSearchAttemptStats)(_,0,s,e,t,0,"0","",_web_lib_stats__WEBPACK_IMPORTED_MODULE_6__.blockNameOwn)}s<5&&cur.oid==vk.id&&!cur.gid&&_!=_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME&&e.trim()!==this.prevStr&&this.serverSearch(e,s,o,t),this.prevStr=e.trim()}let s=cur.section;if(cur.filterIds&&(s+="_filter"),e&&(s+="_search_"+e),cur.curList==s&&!r)return;cur.curList=s,cur.friendsList[cur.curList]=o;let d={all:1,online:1,common:1};if(""==e&&cur.filterIds&&d[_]){delete d[_];for(let e in d)cur.friendsList[e]&&(o=this.filter(cur.friendsList[n],e),cur.friendsList[e+"_filter"]=o)}e&&(e+=" "+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.parseLatin)(e)||""),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.trim)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.escapeRE)(e.replace(/[,]/g,""))),cur.selection={re:new RegExp("("+e.replace(i.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi"),val:'<em class="highlight">$1</em>'})}else cur.curList=cur.section,cur.selection=!1,cur.searchStr&&this.clearServerSearch();cur.sectionCount=cur.friendsList[cur.curList].length,this.searchTimout=setTimeout(function(){this.showMore(!0),s&&(Friends.onSectionChange(),s())}.bind(this),10)},changeSummary:function(e){let _={all:cur.allFriendsCount,common:cur.commonCount};if(cur.friendsList.online&&(_.online=cur.friendsList.online.length),cur.gid||vk.id!=cur.oid||(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)(_,{requests:cur.requestsCount?cur.requestsCount:"",all_requests:cur.allRequestsCount,out_requests:cur.outRequestsCount})),"list"==cur.curList.slice(0,4)||cur.curList.slice(0,9)==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_list_count").innerHTML=cur.sectionCount?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.langNumeric)(cur.sectionCount,"%s",!0):"";else if("subscribers"==cur.section)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_list_count").innerHTML=cur.subscribersCount?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.langNumeric)(cur.subscribersCount,"%s",!0):"";else if(cur.section==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FOLLOWERS_SECTION_NAME)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_list_count").innerHTML=cur.followersCount?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.langNumeric)(cur.followersCount,"%s",!0):"";else if("requests"==cur.section)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_list_count").innerHTML=cur.requestsCount?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.langNumeric)(cur.requestsCount,"%s",!0):"";else if("out_requests"==cur.section)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_list_count").innerHTML=cur.outRequestsCount?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.langNumeric)(cur.outRequestsCount,"%s",!0):"";else if(-1!=cur.curList.indexOf("_search_")||cur.filterIds){if("all"==cur.section){if(!cur.sectionCount&&!cur.searchCount&&cur.isLoading)return;_.all=cur.sectionCount}else _.all=cur.friendsList.all_filter.length;-1==cur.curList.indexOf("_search_")?(cur.friendsList.online_filter&&(_.online=cur.friendsList.online_filter.length),cur.friendsList.common_filter&&(_.common=cur.friendsList.common_filter.length)):_.online=_.common=""}if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.each)(_,(function(e,_){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_tab_"+e);if(!s)return;let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_tab_count",s);r&&(r.innerHTML=_?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.langNumeric)(_,"%s",!0):"")})),!cur.gid&&vk.id==cur.oid){let e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.intval)(_.requests);e=e?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.langNumeric)(e,"%s",!0):"",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_rmenu_count","ui_rmenu_requests"),e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("page_block_header_count","friends_req_block"),e),(e>1?_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_request_load_more")))}document.title=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.stripHTML)(cur.htitles[cur.section]||cur.htitles.all)),(["all","online"].includes(cur.section)||["requests","all_requests","out_requests"].includes(cur.section)&&!cur.isFollowersModeEnabled)&&(document.querySelector("#friends_list_title").innerHTML={all:cur.summaryLang.friends_filter_all_friends,online:cur.summaryLang.friend_tab_friends_online,requests:cur.summaryLang.friend_tab_applications,all_requests:cur.summaryLang.friend_tab_applications,out_requests:cur.summaryLang.friends_section_out_requests}[cur.section])},showListHeader:function(e,_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_list_title").innerHTML=e,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_list_count").innerHTML="",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_friends_header",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_tabs_wrap")),(function(){"friends_tab_list"===this.id?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(this,"visually-hidden"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(this,"unshown"),_?vk.id==cur.oid&&((_<25?_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_list_delete_btn"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_list_edit_btn")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_list_edit_btn","friends_list_delete_btn")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(this,"unshown")}))},selectTab:function(e){e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_tab","friends_tab_"+e);let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("ui_tabs",e);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("_friends_header",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_tabs_wrap")),(function(){this==_?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(this,"unshown"):"friends_tab_list"===this.id&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("friends-visible-hidden-header")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(this,"visually-hidden"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(this,"unshown")})),uiTabs.switchTab(e)},selectSection:function(e){let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_section_"+e,"narrow_column");_&&uiRightMenu.switchMenu(_)},selectTabAndSection:function(e){if("all"==e||"online"==e||"common"==e||"members"==e)this.selectTab(e),this.selectSection("all");else if("all_requests"==e||"requests"==e||"out_requests"==e)this.selectTab(e),(!cur.isFollowersModeEnabled||cur.isFollowersModeEnabled&&"out_requests"!==e)&&this.selectSection("requests"),cur.isFollowersModeEnabled&&("requests"===e?Friends.showListHeader(cur.summaryLang.friend_tab_applications):"out_requests"===e&&Friends.showListHeader(cur.summaryLang.friends_section_out_requests));else if("cleanup"==e)this.selectSection(e);else if("list"==e.substr(0,4)){let _=parseInt(e.substr(4)),s="";s=_>=25&&_<=29?cur.publicLists[_]:cur.userLists[_],this.showListHeader(s,_),this.selectSection(e)}else e==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FOLLOWERS_SECTION_NAME?(this.selectTab(e),this.selectSection(_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FOLLOWERS_SECTION_NAME)):(this.selectTab("all"),this.selectSection(e))},onSectionChange:function(){window.tooltips&&tooltips.hideAll()},section:function(e,_,s){if(Friends.clearServerSearch(),e||(e="all"),s||("online"!=e||cur.oid==vk.id)&&-1==e.indexOf("requests")&&"recent"!=e&&"members"!=e||"list"==e.substr(0,4)||(Friends.clearFilter(),Friends.updateCurFilters()),e||(e=cur.requestsCount&&cur.requestsCount>0&&cur.requestsCount<100?"requests":"all"),cur.requestsCount||cur.allRequestsCount||cur.outRequestsCount||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_section_requests","narrow_column")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_req_block"),e!=cur.section&&(cur.fSearch.setValue(""),cur.searchStr=""),this.selectTabAndSection(e),cur.silent&&("out_requests"!=e||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("friends_out_requests_loading_bugfix")))return cur.onSilentLoad=function(){Friends.section(e,_)},void(e!=cur.section&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(cur.showMore),cur.fContent.innerHTML='<div class="friends_wide_loading">'+(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_31__.getIcon32Spinner)().icon+"</div>"));if(cur.secData[e]||(cur.secData[e]={}),!s&&cur.friendsList[e]||"all"==e)return this.showSection(e),_(),Friends.onSectionChange(),void(cur.filter&&Friends.changeFilter());switch(e){case"online":case"common":this.search(-1,e,_);break;case _friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME:let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_section_phonebook","narrow_column");uiRightMenu.showProgress(s),ajax.post("/al_friends.php",{act:_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME,id:nav.objLoc.id},{onDone:function(r){if(!r)return;cur.shownFriends=0,cur.curList=cur.section=e;let t=cur.friendsList.all,n=[];if(t)for(let e=0,_=t.length;e<_;e++){let _=t[e],s=r[_[0]];s&&(_.push(s),n.push(_))}if(n.sort((function(e,_){return e[5].localeCompare(_[5],{sensitivity:"base"})})),cur.friendsList[cur.section]=n,cur.sectionCount=n.length,cur.fContent.innerHTML="",uiRightMenu.hideProgress(s),Friends.showSection(e),Friends.onSectionChange(),_(),Friends.indexPhone(),cur.filterIds)return cur.curList+="_filter",Friends.search(cur.searchStr||-1,cur.section,!1,!0),void Friends.changeSummary();this.showMore()}.bind(this)});break;case"recent":let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_section_recent","narrow_column");uiRightMenu.showProgress(r),ajax.post("/al_friends.php",{act:"recent"},{onDone:function(s){if(!s)return;cur.shownFriends=0,cur.curList=cur.section=e;let t=[];const n=s.length;for(let e=0;e<n;e++){let _=cur.friends[s[e]];_&&t.push(_)}cur.friendsList[cur.section]=t,cur.sectionCount=t.length,cur.fContent.innerHTML="",uiRightMenu.hideProgress(r),Friends.showSection(e),Friends.onSectionChange(),_(),this.showMore()}.bind(this)});break;case"out_requests":cur.fContent.innerHTML='<div class="friends_wide_loading">'+(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_31__.getIcon32Spinner)().icon+"</div>",(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackStartWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_OUT_REQUESTS_LOADING_MARK_START),ajax.post("/friends",{act:"out_requests"},{onDone:(s,r)=>{if(!s)return;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)(cur.occupations,r),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)(cur.friendsList,s),this.indexAll((function(){Friends.section(e,_)}));const t=(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackEndWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_OUT_REQUESTS_LOADING_MARK_START);(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.sendLoadingStats)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_STATLOG,t.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,outRequestsCount:window.cur.outRequestsCount,mode:_friends_utils__WEBPACK_IMPORTED_MODULE_23__.FriendsListLoadingMode.DEFAULT,httpStatus:200,section:window.cur.curList,errorMessage:"",loadingType:_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FriendsListLoadingType.OUT_REQUESTS_BLOCKING,userId:window.vk.id,hasError:"false"})},onFail:(e,_)=>{const s=(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.trackEndWithMarkName)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_OUT_REQUESTS_LOADING_MARK_START);let r="";r="string"==typeof e?e:e.message,(0,_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.sendLoadingStats)(_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FRIENDS_LIST_LOADING_STATLOG,s.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,outRequestsCount:window.cur.outRequestsCount,mode:_friends_utils__WEBPACK_IMPORTED_MODULE_23__.FriendsListLoadingMode.DEFAULT,httpStatus:_,section:window.cur.curList,errorMessage:r,loadingType:_web_friends_friends_stats__WEBPACK_IMPORTED_MODULE_24__.FriendsListLoadingType.OUT_REQUESTS_BLOCKING,hasError:"true",userId:window.vk.id})}});break;default:"list"==e.substr(0,4)&&this.search(-1,e,_)}},scrollResize:function(){if(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile)return;let e=document.documentElement,_=window.innerHeight||e.clientHeight||document.body.clientHeight,s=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_5__.scrollGetY)();cur.pageEnd&&(s+3*_>cur.pageEnd.offsetTop&&setTimeout((function(){Friends.showMore()}),0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.isVisible)("friends_search_input_wrap"))},drawFriend:(e,_,s={})=>0===e?.length?"":"requests"==cur.section||"all_requests"==cur.section||"out_requests"==cur.section||cur.section==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FOLLOWERS_SECTION_NAME?cur.commonTpl(e,_||cur.section):cur.friendsTpl(e,cur.section,s),inviteToGroup:function(e,_,s,r,t){let n=r=>{const n=(window.cur.friendsList[window.cur.curList]||[]).find((e=>Number(e[0])===s));let i,o;n?n[11]=r:console.warn("[invite to group] Friend is not found"),r?(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("friends_cancel_invite"),o=_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButtonAppearance.SECONDARY):(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("friends_send_invite"),o=_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButtonAppearance.PRIMARY),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.setLabel(e,i),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.setAppearance(e,o),e.removeAttribute("onclick"),e.onclick=()=>{Friends.inviteToGroup(e,_,s,r?1:0,t)}};return r?ajax.post("/al_page.php",{act:"a_cancel_invite",mid:s,gid:_,hash:t},{onDone:function(e){n(0)},showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.lock(e),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.unlock(e)}):ajax.post("/al_page.php",{act:"a_invite",mid:s,gid:_,hash:t},{onDone:function(_,r){_?n(1):((0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_7__.showMsg)("res"+s,r,"msg"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(e))},showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.lock(e),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.unlock(e)}),!1},acceptRequest:function(e,_,s){let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("request_controls_"+e);s||(r.innerHTML='<div class="progress_inline"></div>'),ajax.post("al_friends.php",{act:"add",mid:e,hash:_,request:1,select_list:1},{onDone:function(_,s){r.innerHTML=_,Friends.processRequest(e,!0,s),TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate()},onFail:function(e){if(e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),e),!0},showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.lock(s),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.unlock(s)})},deleteSubscriber:function(e,_,s){let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geById)("request_controls_"+e);s||(r.innerHTML='<div class="progress_inline"></div>'),ajax.post("al_friends.php",{act:"removeSubscriber",mid:e,hash:_},{onDone:function(_){r.innerHTML=_,Friends.processRequest(e,!1),TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate()},onFail:function(e){if(e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),e),!0},showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.lock(s),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.unlock(s)})},declineRequest:function(e,_,s){let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("request_controls_"+e);s||(r.innerHTML='<div class="progress_inline"></div>'),ajax.post("al_friends.php",{act:"remove",mid:e,hash:_,report_spam:1,from_section:cur.section},{onDone:function(_){if(cur.declinedRequestsCnt=cur.declinedRequestsCnt+1||1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("friends_user_row",r),"friends_user_request")&&cur.declinedRequestsCnt>=2&&cur.requestsCount>1){_+=_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.render({children:cur.summaryLang.friends_hide_all_requests,appearance:_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButtonAppearance.SECONDARY,size:_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButtonSize.S,className:"friends_decline_all",restAttrs:{onclick:`Friends.subscribeAllRequests(this, '${cur.declineAllHash}')`}}).outerHTML}r.innerHTML=_,Friends.processRequest(e,!1),TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate()},onFail:function(e){if(e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),e),!0},showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.lock(s),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.unlock(s)})},processRequest:function(e,_,s={}){if(!cur.friendsList)return;let r=cur.friendsList.requests||[],t=r.length,n=!1;for(;t--;)if(r[t][0]==e){const e=r.splice(t,1)[0],i=transformCommonFriendToFriend(e);--cur.requestsCount,Friends.changeSummary(),_?(n=!0,i.pop(),i[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_LIST_FRIEND_OPTIONS_INDEX]=s,cur.friendsList.all?cur.friendsList.all.push(i):cur.friendsList.all=[i],cur.friends[i[0]]=i):(cur.shownFriends--,cur.sectionCount--)}if(_){let _=cur.friendsList.all_requests||[],r=_.length;for(;r--;)if(_[r][0]==e){const e=_.splice(r,1)[0],t=transformCommonFriendToFriend(e);--cur.allRequestsCount,n||(n=!0,t.pop(),t[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_LIST_FRIEND_OPTIONS_INDEX]=s,cur.friendsList.all?cur.friendsList.all.push(t):cur.friendsList.all=[t],cur.friends[t[0]]=t)}delete cur.friendsList.recent,delete cur.friendsList.online,Friends.indexAll()}else{let _=cur.friendsList.out_requests||[],s=_.length;for(;s--;)_[s][0]==e&&--cur.outRequestsCount}if("all"===cur.section&&cur.friendsList.requests?.length){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("_friends_list","friends_req_block");if(e){let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)(cur.commonTpl(cur.friendsList.requests[0],"requests"));e.appendChild(_)}}if(cur.section===_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FOLLOWERS_SECTION_NAME){let r=cur.friendsList.followers||[],t=r.length;for(;t--;)if(r[t][0]==e){const e=r.splice(t,1)[0],i=transformCommonFriendToFriend(e);--cur.followersCount,Friends.changeSummary(),_&&!n&&(i.pop(),i[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_LIST_FRIEND_OPTIONS_INDEX]=s,cur.friendsList.all?cur.friendsList.all.push(i):cur.friendsList.all=[i],cur.friends[i[0]]=i)}}},actionFindUser:function(e,_,s,r){window.tooltips&&tooltips.hide(r);let t,n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("friends_find_user",r),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_find_user_result",n);return i.innerHTML='<div class="progress_inline"></div>',t=s?{act:"add",mid:e,hash:_,from:"possible"}:{act:"hide_possible",mid:e,hash:_},ajax.post("al_friends.php",t,{onDone:function(e,_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(n,"touched"),i.innerHTML=e,_&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(_)},onFail:function(e){if(e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),e),!0},showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass.pbind(n,"loading"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass.pbind(n,"loading")}),!1},actionFindUserCancel:function(e,_,s,r){let t,n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("friends_find_user",r);return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_find_user_result",n).innerHTML='<div class="progress_inline"></div>',(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(n,"touched"),t=s?{act:"remove",mid:e,hash:_}:{act:"cancel_hide_possible",mid:e,hash:_},ajax.post("al_friends.php",t,{onDone:function(e){},onFail:function(e){if(e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),e),!0},showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass.pbind(n,"loading"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass.pbind(n,"loading")}),!1},reportSpam:function(e,_,s){let r=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(s):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("request_controls_"+e);r||(r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("result_msg"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(r,"msg")),setTimeout(_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val.pbind(r,'<div class="progress_inline"></div>'),0),ajax.post("al_friends.php",{act:"report_spam",mid:e,hash:_},{onDone:function(e){r.innerHTML=e}})},restoreFriend:function(e,_){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_actions_menu",e);ajax.post("al_friends.php",{act:"add",mid:_,hash:cur.userHash,cats:cur.savedMasks[_]},{onDone:Friends.onRemoveFriend.pbind(_,!0),showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass.pbind(s,"action_progress"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass.pbind(s,"action_progress")})},deleteFriend:function(e,_,s){let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("_actions_menu",s);return ajax.post("al_friends.php",{act:"remove",mid:_,hash:cur.userHash},{onDone:Friends.onRemoveFriend.pbind(_,!1),showProgress:function(){uiActionsMenu.hide(r),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(r,"action_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(r,"action_progress")}}),!1},onRemoveFriend:function(e,_){for(let e in cur.friendsList)"all"!=e&&"requests"!=e&&"all_requests"!=e&&"out_requests"!=e&&e!==_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FOLLOWERS_SECTION_NAME&&delete cur.friendsList[e];e=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.positive)(e);let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_user_row"+e),r=cur.friends[e];r&&s?(_?(r[6]=cur.savedMasks[e],delete cur.savedMasks[e]):(cur.savedMasks[e]=r[6],r[6]=0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.toggleClass)(s,"deleted",!r[6])):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(s),Friends.indexAll((function(){}))},showCommonBox:function(e,_){return(0,_shared_friends_utils__WEBPACK_IMPORTED_MODULE_32__.showCommonFriendsBox)(e,_),!1},toList:function(e){let _="list"+e;return nav.change({0:"al_friends.php",section:_}),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_5__.scrollToTop)(0),!1},searchFriendToggle:function(e,_,s){let r=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_subsc"+e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_unsubsc"+e),t=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_unsubsc"+e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_subsc"+e);ajax.post("al_friends.php",{act:s?"add":"remove",mid:e,hash:_,from:"friends",ref:"friends_search_block"},{onDone:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(r),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(t)},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.lockButton)(r),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.unlockButton)(r)})},checkCat:function(e,_,s,r){let t,n;1==r?t=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.isChecked)(e):(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"checked"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("lists"+_));let i=cur.friends[_];if(!i)return!1;i[6]=parseInt(i[6]),t?(i[6]&1<<s&&(i[6]-=1<<s),n&&(n.innerHTML=Friends.getLists(i[6]))):(i[6]&1<<s||(i[6]+=1<<s),n&&(n.innerHTML=Friends.getLists(i[6]))),1==r?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.checkbox)(e):(t?_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass:_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(e,"checked"),cur.timeouts["list"+_]&&clearTimeout(cur.timeouts["list"+_]),delete cur.friendsList["list"+s],delete cur.friendsList["list"+i[6]],cur.timeouts["list"+_]=setTimeout((function(){ajax.post("al_friends.php",{act:"save_cats",uid:_,cats:i[6],hash:cur.userHash},{onDone:function(e){if(r){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_added_"+_);!cur["fr_add_text_"+_]&&s&&(cur["fr_add_text_"+_]=s.innerHTML),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__.fadeTo)(s,100,0,(function(){s.innerHTML=e,(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__.fadeTo)(s,100,1)})),clearTimeout(cur["fr_add_timeout_"+_]),cur["fr_add_timeout_"+_]=setTimeout((function(){(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__.fadeTo)(s,100,0,(function(){s.innerHTML=cur["fr_add_text_"+_],(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__.fadeTo)(s,100,1)}))}),2e3)}}})}))},getLists:function(e){let _=[];for(let s=29;s>=25;s--)1<<s&e&&cur.publicLists[s]&&_.push('<span class="friends_lists_group group',(s-1)%8+1,'" onmousedown="Friends.toList(',s,');">',cur.publicLists[s],"</span>");if(vk.id==cur.oid)for(let s in cur.userLists)1<<s&e&&!cur.publicLists[s]&&cur.userLists[s]&&_.push('<span class="friends_lists_group group',(s-1)%8+1,'" onmousedown="Friends.toList(',s,');">',cur.userLists[s],"</span>");return _.join("")},subscribeAllRequests:function(e,_){const s=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(cur.summaryLang.global_action_confirmation,cur.summaryLang.friends_confirm_subscribe_all_requests,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("box_yes"),(function(){ajax.post("al_friends.php",{act:"subscribe_all_requests",hash:_,once:1},{showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.lock(e),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.unlock(e)}),s.hide()}),_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("box_no"))},editList:function(e){if(cur.silent)return void(cur.onSilentLoad=function(){Friends.editList(e)});let _=[];if(-1==e&&(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.intval)(cur.curList.substr(4))),e){let e=Friends.filter(cur.friendsList.all,cur.curList),s=e.length;for(;s--;)_.push(e[s][0])}else e=0;(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showTabbedBox)("al_friends.php",{act:"select_friends_box",Checked:_.join(","),from:"list",list_name:e?(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.stripHTML)(cur.userLists[e])):"",list_id:e},{stat:[window.jsc("web/privacy.js"),"ui_controls.js","ui_controls.css"],cache:1,onFail:function(e){return setTimeout((0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),e).hide,3e3),!0}}),cur.onFlistSave=function(_,s,r,t){let n=[];for(let e in s)s.hasOwnProperty(e)&&n.push(parseInt(e));return ajax.post("al_friends.php",{act:"save_list",title:t,cat_id:e,Friends:n.join(","),hash:r},{onDone:function(_,s){Friends.editListClient(e,_,s,n)},onFail:function(e){return setTimeout((0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),e,_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_close")).hide,4e3),!0}}),Friends.clearFilter(),Friends.updateCurFilters(),!1}},editListClient:function(e,_,s,r){let t="list"+_;if(0==e){let n=`<div onclick="return Friends.switchMenu(this, 'list${_}', event);" class="ui_rmenu_subitem _ui_rmenu_subitem ui_rmenu_item_sel friends_section_list${_}"><span class="ui_rmenu_item_label">${s='<span className="ui_rmenu_label-text">'+s+"</span>"}</span></div>`;const i=document.querySelector('[data-section-ref="friends_create_list_button_item"]');if(!i){const _=new Error("Friends: Unable to find friends create list button");throw console.error(_,e,r),_}const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{innerHTML:n}).firstElementChild;i.before(o);let a=r.length,d=1<<parseInt(_);for(cur.friendsList[t]=[];a--;){let e=cur.friends[r[a]];e[6]=parseInt(e[6]),e[6]&d||(e[6]+=d,cur.friendsList[t].push(e))}return cur.userLists[_]=s,Friends.indexAll(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("main_class"),"no_lists"),nav.change({0:"friends",section:t})}{if(_<25){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_section_list"+_,"narrow_column");e=e.querySelector(".ui_rmenu_label-text"),e.innerHTML=s,cur.userLists[_]=s}let e=1<<_;cur.friendsList[t]=[];for(let _ in cur.friends)if(cur.friends.hasOwnProperty(_)){let s=cur.friends[_],n=-1!=r.indexOf(parseInt(s[0]));n&&cur.friendsList[t].push(s),s[6]=parseInt(s[6]),s[6]&e?n||(s[6]-=e):n&&(s[6]+=e)}return Friends.indexAll(),Friends.section(t,(function(){Friends.changeSummary(),nav.setLoc({0:"friends",section:t})}))}},createList:function(e){return Friends.editList(0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e)},deleteList:function(e){-1==e&&(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.intval)(cur.curList.substr(4))),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showBox)("al_friends.php",{act:"delete_list_box",list_id:e})},deleteListClient:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("friends_section_list"+e,"narrow_column"));let _=1<<e;for(let e in cur.friends)cur.friends[e][6]&_&&(cur.friends[e][6]-=_);delete cur.userLists[e];let s=0;for(let e in cur.userLists)cur.userLists.hasOwnProperty(e)&&s++;return s||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("main_class"),"no_lists"),nav.change({0:"friends",section:"all"})},selectList:function(e,_,s){Friends.ddShow(_,e,s)},showListsDD:function(e,_,s){let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("ui_actions_menu",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_actions_menu_sublist",r);if(t){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(t,"hidetimer");return clearTimeout(e),void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(t,"hidetimer",0)}let n=cur.friends[parseInt(e)];if(!n)return;let i=parseInt(n[6]),o=[],a=[28,29,27,25,26];for(let _,s=0;s<5;++s)_=a[s],cur.publicLists[_]&&o.push('<a class="ui_actions_menu_item'+(i&1<<parseInt(_)?" checked":"")+'" onclick="Friends.checkCat(this, '+e+", "+_+');">'+cur.publicLists[_]+"</a>");for(let _ in cur.userLists)if(_<25){let s=cur.userLists[_];s.length>20&&(s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.trim)(s.substr(0,18))+"..."),o.push('<a class="ui_actions_menu_item'+(i&1<<parseInt(_)?" checked":"")+'" onclick="Friends.checkCat(this, '+e+", "+_+');">'+s+"</a>")}o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.se)('<div class="ui_actions_menu_sublist shown" onmouseover="Friends.showListsDD('+e+', this, event);" onmouseout="Friends.hideListsDD(this);" onclick="Friends.showListsDD('+e+', this, event);">'+o.join("")+"</div>"),r.appendChild(o)},hideListsDD:function(e){let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.gpeByClass)("ui_actions_menu",e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("ui_actions_menu_sublist",_);s&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(s,"hidetimer")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(s,"hidetimer",setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.data)(s,"hidetimer",0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(s)}),150)))},getAgeFromData:function(e,_){return!(e=parseInt(e))>0&&(e=_.ageTo),Friends.getRangeData(_.ageFrom,e,1,_.langAgeFrom+" ",_.langAgeFromEmpty)},getAgeToData:function(e,_){return!(e=parseInt(e))>0&&(e=_.ageFrom),Friends.getRangeData(e,_.ageTo,1,_.langAgeTo+" ",_.langAgeToEmpty)},getRangeData:function(e,_,s,r,t){if(e>_)return!1;let n=[[0,t]];if(s<0)for(let t=_;t>=e;t+=s)n.push([t,r+t]);else if(s>0)for(let t=e;t<=_;t+=s)n.push([t,r+t]);return n},radioFilter:function(e,_,s){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.radiobtn)(e,_,"friends_radio_sex"),(s||null==s)&&Friends.changeFilter()},initFilters:function(e){window.stManager.add(["ui_controls.js","ui_controls.css"],(function(){cur.cityFilter=new Dropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_fltr_city"),e.cities,{big:1,zeroPlaceholder:!0,onChange:Friends.changeFilter,onShow:function(){cur.silent&&(cur.cityFilterOpened=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_fltr_progress"))}}),cur.ageFromFilter=new Dropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_age_from"),Friends.getAgeFromData(e.ageTo,e),{zeroPlaceholder:!0,big:1,onChange:function(_){cur.ageToFilter.setData(Friends.getAgeToData(_,e)),Friends.changeFilter()}}),cur.ageToFilter=new Dropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_age_to"),Friends.getAgeToData(e.ageFrom,e),{zeroPlaceholder:!0,big:1,onChange:function(_){cur.ageFromFilter.setData(Friends.getAgeFromData(_,e)),Friends.changeFilter()}}),window.radioBtns.friends_radio_sex={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_radio_sex"))),val:0}}))},clearFilter:function(e,_){cur.cityFilter&&(_&&"city"!=_||cur.cityFilter.selectItem(0,!1),_&&"age_from"!=_||cur.ageFromFilter.selectItem(0,!1),_&&"age_to"!=_||cur.ageToFilter.selectItem(0,!1),_&&"sex"!=_||Friends.radioFilter((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_radio_any"),0,!1),cur.filterIds=!1,cur.filter=!1,e&&Friends.changeFilter())},filterParams:function(){let e={city:parseInt(cur.cityFilter.val()),sex:parseInt(radioBtns.friends_radio_sex.val),age_from:parseInt(cur.ageFromFilter.val()),age_to:parseInt(cur.ageToFilter.val())};return!!(e.city||e.sex||e.age_from||e.age_to)&&e},changeFilter:function(){if(cur.silent)return cur.onSilentLoad=function(){Friends.changeFilter()},(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(cur.showMore),void(cur.fContent.innerHTML='<div class="friends_wide_loading">'+(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_31__.getIcon32Spinner)().icon+"</div>");if(cur.filter=Friends.filterParams(),cur.filter)ajax.post("friends",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)({act:"filter_friends",uid:cur.oid},cur.filter),{onDone:function(e){cur.filterIds={};for(let _ in e)e.hasOwnProperty(_)&&(cur.filterIds[e[_]]=1);for(let e in cur.friendsList)"filter"==e.split("_").pop()&&delete cur.friendsList[e];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.inArray)(cur.section,["all","online","common",_friends_constants__WEBPACK_IMPORTED_MODULE_13__.PHONEBOOK_SECTION_NAME])||(Friends.selectTab("all"),Friends.selectSection("all"),cur.curList=cur.section="all",nav.setLoc((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_10__.extend)(nav.objLoc,{section:"all"}))),Friends.search(cur.searchStr||-1,cur.section,!1,!0),Friends.changeSummary(),Friends.updateCurFilters()},progress:"friends_fltr_progress",cache:1});else{cur.filterIds&&(cur.filterIds=!1);let e=cur.searchStr||"";cur.searchStr="",Friends.updateList(e),Friends.updateCurFilters()}},updateCurFilters:function(){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_cur_filters");if(cur.filter){for(let _ in cur.filter){if(!cur.filter.hasOwnProperty(_))continue;let s=cur.filter[_],r="",t=!1,n=!1,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_filters_token_"+_);if(!s){i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.re)(i);continue}switch(_){case"city":r=cur.cityFilter.val_full()[1];break;case"age_from":r=cur.ageFromFilter.val_full()[1],t="age_to";break;case"age_to":r=cur.ageToFilter.val_full()[1],n="age_from";break;case"sex":r=2==s?_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("sex_m"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("sex_fm")}r=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.stripHTML)(r);let o=`<span class="label">${r}</span><span class="del_icon">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_33__.getIcon12Cancel)().icon}</span>`;if(i)i.innerHTML=o;else{let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ce)("div",{id:"friends_filters_token_"+_,className:"token",innerHTML:o,onclick:Friends.clearFilter.pbind(!0,_)});t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_filters_token_"+t)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertBefore)(s,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_filters_token_"+t)):n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_filters_token_"+n)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domInsertAfter)(s,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("friends_filters_token_"+n)):e.appendChild(s)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)(e)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)(e),e.innerHTML=""},changeFriendsOrder:function(e,_){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.domPN)(e);"date"===_&&"date"!==nav.objLoc.sort?(nav.change({sort:!1}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(s,"friends_sort_sel_date"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(s,"friends_sort_sel_common")):"common"===_&&"common"!==nav.objLoc.sort&&(nav.change({sort:"common"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(s,"friends_sort_sel_common"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(s,"friends_sort_sel_date"))},findAdd:function(e,_,s){ajax.post("al_friends.php",{act:"add",mid:e,hash:_,request:1,short_resp:1},{onDone:function(e){let _=s.parentNode;_.innerHTML='<div class="friends_imp_status" style="display: none;">'+e+"</div>",(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__.fadeIn)(_.firstChild,200)},onFail:function(e){if(e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),e),!0},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.lockButton)(s),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.unlockButton)(s)})},toggleFindFilters:function(e,_){let s=_?0:200;e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.ge)("search_filters_minimized"),_?searcher.toggleMinimizedFilters(e,!0,_):searcher.toggleMinimizedFilters(e)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hasClass)(e,"ui_rmenu_item_expanded")?((0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__.slideUp)("friends_import_block",s,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_import_stub")})),cur.disableAutoMore=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.geByClass1)("search_row","results")&&searcher.updResults()):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("friends_import_stub","friends_filters_header","results"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.show)("friends_import_header","friends_list_wrap"),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__.slideDown)("friends_import_block",s),nav.setLoc("friends?act=find"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.val)("search_query",""),cur.params&&(cur.params["c[q]"]=""),cur.disableAutoMore=!0,(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_5__.scrollToTop)())},extendedSearchQuery:function(){const e=document.querySelector("#search_filters_minimized");e&&!e?.classList?.contains("ui_rmenu_item_expanded")&&Friends.toggleFindFilters(!1,!0),searcher.onEnter()},clearFindParams:function(e,_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.hide)("search_clear_params"),uiSearch.reset(e,!1,_)},isInvitePage:()=>!!window.cur?.gid,toggleFriend:function(e,_,s,r,t){const n={act:t?"add":"remove",mid:s,hash:r},i=e?.closest(".friends_field_toggle_friend"),o="friends_field_toggle_friend--disabled";i?.classList.add(o),ajax.post("al_friends.php",n,{onDone:function(){if(i?.classList.remove(o),window.cur?.friends){const e=t?_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_STATUS_REQUEST_FROM_USER:_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_STATUS_NOT_FRIENDS;void 0!==typeof cur.friends[s]?.[_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_LIST_FRIEND_OPTIONS_INDEX]?.friendship_status&&(cur.friends[s][_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_LIST_FRIEND_OPTIONS_INDEX].friendship_status=e)}i?.classList.toggle("friends_field_toggle_friend--cancelVisible",t)},onFail:function(e){return i?.classList.remove(o),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e),!0}}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(_)},moveRequestsToFollowers:function(){cur.friendsList.requests&&(cur.friendsList.followers?cur.friendsList.followers.push(...cur.friendsList.requests):cur.friendsList.followers=[...cur.friendsList.requests],cur.friendsList.requests=[],cur.followersCount+=cur.requestsCount,cur.requestsCount=0,Friends.changeSummary(),cur.fContent.innerHTML="")},sendRequestsToFollowers:function(e,_){const s={act:"requests_to_followers",hash:_};ajax.post("al_friends.php",s,{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.addClass)(_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_REQUESTS_TO_SUBSCRIBERS_CLASSES.DESCRIPTION_STEP,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_8__.removeClass)(_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_REQUESTS_TO_SUBSCRIBERS_CLASSES.DONE_STEP,"unshown"),Friends.moveRequestsToFollowers()},onFail:function(){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_12__.getLang("global_error")})},showProgress:function(){_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.lock(e)},hideProgress:function(){_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_18__.FlatButton.unlock(e)}})},showAddFriendsReccomendationModal:function(){(0,_shared_utils_onDomReady__WEBPACK_IMPORTED_MODULE_27__.onDomReady)((0,_web_friends_components_AddNewFriendsModal_index__WEBPACK_IMPORTED_MODULE_26__.showAddNewFriendsModalBox)())},initCleanupTooltip:e=>{const{target:_,data:{content:s,helpHintHash:r,helpHintId:t}={}}=e.payload;if(!r||!t)return;const{tooltip:n}=(0,_web_components_ui_helpHintTooltip__WEBPACK_IMPORTED_MODULE_28__.helpHintTooltip)(_,{content:s,helpHintHash:r,helpHintId:t},{align:ElementTooltip.ALIGN_CENTER,appendToParent:!0,autoAdjustToViewport:!1,forceSide:"left",offset:[-10,0],width:230,withCloseButton:!1,noAutoHideOnWindowClick:!1,onWindowClick:()=>{n.hide()}});window.requestAnimationFrame((()=>{n.show()}));const i=()=>{n.hide(),window.removeEventListener("scroll",i)};window.addEventListener("scroll",i,{once:!0}),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_30__.pushNavDestroy)((()=>window.removeEventListener("scroll",i)))},initRightBlocks:e=>{(0,_web_friends_components_initFriendsRightBlocks__WEBPACK_IMPORTED_MODULE_22__.initFriendsRightBlocks)(e)}};function extractUserParameters(e){let _=0,s="";if("string"!=typeof e||!e)return[_,s];const r=/^id(\d+)$/.exec(e);if(null!==r&&([,_]=r,_=Number(_),Number.isNaN(_)&&(_=0)),!_){const r=String.raw`^(?:(?:(?:https?:\/\/)?(?:${_shared_lib_site__WEBPACK_IMPORTED_MODULE_16__.VK_HOST_REGEX_GROUP_UNSAFE.source})\/)|@)(?:(?:id(\d+))|(\w|.+))$`,t=new RegExp(r).exec(e);if(null!==t){const[,e,r]=t;_=Number(e),Number.isNaN(_)&&(_=0),_||(s=r)}}return[_,s]}function friendsNavHandler(e,_,s,r){const t=cur.isFollowersModeEnabled;if(e.section===_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_SECTIONS.CLEANUP||_.section===_friends_constants__WEBPACK_IMPORTED_MODULE_13__.FRIENDS_SECTIONS.CLEANUP)return!0;if("id"in e||"sort"in e||"act"in e||(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(e))return!0;if("friends"==s[0]||"al_friends.php"==s[0]&&e.section){let _=e.section;return"requests"!=_&&"all_requests"!=_&&"out_requests"!=_||cur.requestsCount||cur.allRequestsCount||cur.outRequestsCount?"requests"!=_||cur.requestsCount||t?"all_requests"!=_||cur.allRequestsCount?("out_requests"!=_||cur.outRequestsCount)&&("subscribers"!=_||cur.subscribersCount)?("all"!=_&&"online"!=_&&"requests"!=_&&"all_requests"!=_&&"out_requests"!=_||__adsUpdate("force"),"all_requests"!=_||"sort"in e||cur.sortByCommon||(delete s.sort,setTimeout(Friends.changeSummary,0)),Friends.section(s.section,(function(){Friends.changeSummary(),nav.setLoc(s)})),r?.onDone?.(),!1):nav.change({section:"all"},void 0,r):nav.change({section:cur.requestsCount?"requests":"out_requests"},void 0,r):nav.change({section:cur.allRequestsCount?"all_requests":"out_requests"},void 0,r):nav.change({section:"all"},void 0,r)}return"al_friends.php"==s[0]||"friends"==s[0]?(r?.onDone?.(),!1):void 0}function friendsGroupInviteNavHandler(e,_,s,r){if("friends"==s[0]||"al_friends.php"==s[0]&&e.section){if(!Friends.isInvitePage())return;return Friends.section(s.section,(()=>{Friends.changeSummary(),nav.setLoc(s)})),r?.onDone?.(),!1}}const __WEBPACK_DEFAULT_EXPORT__=Friends},911658:(e,_,s)=>{s.d(_,{friendsTemplate:()=>c});var r=s(226059),t=s(43129),n=s(636322),i=s(471828),o=s(70689),a=s(977053),d=s(505369),l=s(848009);function c({friendTemplate:e,actionsJs:_}){return(s,c,u)=>{const E=s[0];let f=[];if(u=u||{},c===d.PHONEBOOK_SECTION_NAME){let e=s[s.length-1];e[0]&&e[0].split("<br>").forEach(((e,_)=>{const s=_>0?"friends_phonebook_alt_phone":"friends_phonebook_phone";f.push(`<div class="friends_field ${s}">${e}</div>`)})),e[1]&&f.push(`<div class="friends_field friends_phonebook_alt_phone">${e[1]}</div>`),e[2]&&f.push(`<div class="friends_field friends_phonebook_skype"><a href="skype:${e[2]}?call">${e[2]}</a></div>`)}let b=(0,n.intval)(s[4]),m=(0,t.onlinePlatformClass)(b);s[8]=(0,n.intval)(s[8]);let D="";s[8]&&c!==d.PHONEBOOK_SECTION_NAME&&(D=-2e9==s[8]?s[10]:cur.occupations[s[8]]||"",D&&(D='<div class="friends_field">'+D+"</div>"));let O=cur.hasUnseenStories&&cur.hasUnseenStories[E],h=`<div id="lists${E}" class="friends_lists clear_fix">${window.Friends.getLists(s[6])}</div>`,p=(0,n.intval)(s[7])&&!O?' onmouseover="uiPhotoZoom.over(this, '+E+')"':"",M=s[6]?"":" deleted",w="";if(cur.gid){if("2"==s[11]){w=`<div class="friends_controls">${r.FlatButton.render({children:i.getLang("friends_invited"),appearance:r.FlatButtonAppearance.PRIMARY,size:r.FlatButtonSize.S,wide:!0,disabled:!0}).outerHTML}</div>`}else if((s[13]||{}).show_invite_btn){const e=Number(s[11]);w=`<div class="friends_controls">${r.FlatButton.render({children:e?i.getLang("friends_cancel_invite"):i.getLang("friends_send_invite"),appearance:e?r.FlatButtonAppearance.SECONDARY:r.FlatButtonAppearance.PRIMARY,size:r.FlatButtonSize.S,wide:!0,restAttrs:{onclick:`return Friends.inviteToGroup(this, ${cur.gid}, ${E}, ${e}, '${s[12]}')`}}).outerHTML}</div>`}}else w=_.replace(/%mid%/g,E);let g=(0,o.ce)("div",{innerHTML:s[5]});g=g.innerText||g.textContent;let P="";O&&(P=" friends_photo_stories_unseen friends_photo_stories_unseen"+E);let L="return nav.go(this, event);";O&&(L="if (!event.metaKey && !event.ctrlKey) { showStory('/owner_feed"+E+"', {source: 'avatar'}); return false; }");let C="";return(0,a.partConfigEnabled)("avatar_component_refactor_web")&&(C=(0,l.renderAvatarToString)(s[1],c===d.PHONEBOOK_SECTION_NAME?d.AVATAR_SIZES.small:d.AVATAR_SIZES.normal,s[2],"",b,L,O,E,g,s[d.FRIENDS_LIST_FRIEND_IS_NFT_INDEX])),(0,o.rs)(e,{add_class:M,friend_id:E,mouse_events:p,href:s[2],href_onclick:`onclick="${L}"`,stories_class:P,name:s[5],name_alt:(0,n.clean)(g),photo_src:s[1],online:m,image_status:s[9],university:D,info:f.join(""),lists:h,info_action:u.info_actions||"",actions:w,nft_overlay:s[d.FRIENDS_LIST_FRIEND_IS_NFT_INDEX]?" nft_avatar":"",avatar:C})}}},113348:(e,_,s)=>{s.d(_,{requestsTemplate:()=>c});var r=s(226059),t=s(43129),n=s(636322),i=s(471828),o=s(70689),a=s(977053),d=s(505369),l=s(848009);function c({requestTemplate:e,declineRequestLabel:_,confirmRequestLabel:s,unsubscribeUserLabel:c,removeFromFollowersLabel:u,addFollowerToFriendsLabel:E}){return(f,b)=>{const m=Number(f[0]);let D=(0,n.intval)(f[4]),O=(0,t.onlinePlatformClass)(D),h=f[f.length-1];const[p,M,w]=h,g=h[7];let P,L=h[5]?"friends_user_request":"",C=(0,n.intval)(f[9]),T=(0,n.intval)(f[7])&&!C?'onmouseover="uiPhotoZoom.over(this, '+m+')"':"";const A="followers"===b;if("out_requests"===b){P=r.FlatButton.render({children:1===Number(f[10])?i.getLang("friends_you_added_cancel"):i.getLang("friends_cancel_subscription"),appearance:r.FlatButtonAppearance.PRIMARY,size:r.FlatButtonSize.S,restAttrs:{id:`friends_deny_request${m}`,onclick:`Friends.declineRequest(${m}, '${M}', this)`}}).outerHTML}else{const e=r.FlatButton.render({children:A?E:s,appearance:r.FlatButtonAppearance.PRIMARY,size:r.FlatButtonSize.S,restAttrs:{id:`accept_request_${m}`,onclick:`Friends.acceptRequest(${m}, '${p}', this)`}}),t=r.FlatButton.render({children:_,appearance:r.FlatButtonAppearance.TERTIARY,size:r.FlatButtonSize.S,className:"friends_deny_request",restAttrs:{id:`friends_deny_request${m}`,onclick:`Friends.declineRequest(${m}, '${M}', this)`}});if(P=e.outerHTML+t.outerHTML,"all_requests"===b&&c){P+=r.FlatButton.render({children:c,appearance:r.FlatButtonAppearance.TERTIARY,size:r.FlatButtonSize.S,className:"friends_unsubscribe",restAttrs:{id:`friends_unsubscribe_${m}`,onclick:`Friends.deleteSubscriber(${m}, '${g}', this)`}}).outerHTML}if(A){P+=r.FlatButton.render({children:u,appearance:r.FlatButtonAppearance.TERTIARY,size:r.FlatButtonSize.S,className:"friends_unsubscribe",restAttrs:{id:`friends_unsubscribe_${m}`,onclick:`Friends.deleteSubscriber(${m}, '${g}', this)`}}).outerHTML}}let R="";C&&(R=" friends_photo_stories_unseen friends_photo_stories_unseen"+m);let I="return nav.go(this, event);";C&&(I="if (!event.metaKey && !event.ctrlKey) { showStory('/owner_feed"+m+"', {source: 'avatar'}); return false; }");let F="";return(0,a.partConfigEnabled)("avatar_component_refactor_web")&&(F=(0,l.renderAvatarToString)(f[1],d.AVATAR_SIZES.normal,f[2],"",D,I,Boolean(C),`${m}`,f[5],f[d.FRIENDS_REQUESTS_FRIEND_IS_NFT_INDEX])),(0,o.rs)(e,{add_class:L,attrs:"",friend_id:m,href:f[2],href_onclick:"return nav.go(this, event);",name:f[5],name_alt:(0,n.clean)(f[5]),photo:w,online:O,photo_onclick:I,image_status:f[8],request_info:h[3]+h[6]+h[4],controls:P,dont_show:"",mouse_events:T,stories_class:R,nft_overlay:f[d.FRIENDS_REQUESTS_FRIEND_IS_NFT_INDEX]?" nft_avatar":"",avatar:F})}}},50614:(e,_,s)=>{s.d(_,{useIsMounted:()=>t});var r=s(667294);const t=()=>{const e=(0,r.useRef)(!1);return(0,r.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,r.useCallback)((()=>e.current),[])}},4483:(e,_,s)=>{s.d(_,{useUniqId:()=>n});var r=s(667294),t=s(659397);function n(){return`:r${(0,r.useRef)((0,t.getRandomString)(6)).current}:`}},845679:(e,_,s)=>{s.d(_,{createFriendsAddFx:()=>a,createFriendsAddListFx:()=>E,createFriendsDeleteBulkFx:()=>l,createFriendsDeleteFx:()=>d,createFriendsDeleteListFx:()=>f,createFriendsDeleteSubscriberFx:()=>D,createFriendsEditListFx:()=>b,createFriendsGetCountersFx:()=>h,createFriendsGetFriendsDeletionSuggestionsFx:()=>i,createFriendsGetFx:()=>n,createFriendsGetListsFx:()=>t,createFriendsGetOnlineFx:()=>u,createFriendsGetRecentFx:()=>p,createFriendsGetRecommendationsFx:()=>o,createFriendsGetRequestsFx:()=>c,createFriendsRequestsToSubscribersFx:()=>O,createFriendsSearchFx:()=>m});var r=s(876354);const t=e=>(0,r.createApiEffect)("friends.getLists",e),n=e=>(0,r.createApiEffect)("friends.get",e),i=e=>(0,r.createApiEffect)("friends.getFriendsDeletionSuggestions",e),o=e=>(0,r.createApiEffect)("friends.getRecommendations",e),a=e=>(0,r.createApiEffect)("friends.add",e),d=e=>(0,r.createApiEffect)("friends.delete",e),l=e=>(0,r.createApiEffect)("friends.deleteBulk",e),c=e=>(0,r.createApiEffect)("friends.getRequests",e),u=e=>(0,r.createApiEffect)("friends.getOnline",e),E=e=>(0,r.createApiEffect)("friends.addList",e),f=e=>(0,r.createApiEffect)("friends.deleteList",e),b=e=>(0,r.createApiEffect)("friends.editList",e),m=e=>(0,r.createApiEffect)("friends.search",e),D=e=>(0,r.createApiEffect)("friends.deleteSubscriber",e),O=e=>(0,r.createApiEffect)("friends.requestsToSubscribers",e),h=e=>(0,r.createApiEffect)("friends.getCounters",e),p=e=>(0,r.createApiEffect)("friends.getRecent",e)},54438:(e,_,s)=>{s.d(_,{createEntitiesFriendsService:()=>t});var r=s(845679);const t=({domain:e})=>({friendsGetListsFx:(0,r.createFriendsGetListsFx)({domain:e}),friendsGetFx:(0,r.createFriendsGetFx)({domain:e}),friendsGetRecommendationsFx:(0,r.createFriendsGetRecommendationsFx)({domain:e}),friendsGetFriendsDeletionSuggestionsFx:(0,r.createFriendsGetFriendsDeletionSuggestionsFx)({domain:e}),friendsAddFx:(0,r.createFriendsAddFx)({domain:e}),friendsDeleteFx:(0,r.createFriendsDeleteFx)({domain:e}),friendsDeleteBulkFx:(0,r.createFriendsDeleteBulkFx)({domain:e}),friendsGetRequestsFx:(0,r.createFriendsGetRequestsFx)({domain:e}),friendsDeleteSubscriberFx:(0,r.createFriendsDeleteSubscriberFx)({domain:e}),friendsRequestsToSubscribersFx:(0,r.createFriendsRequestsToSubscribersFx)({domain:e}),friendsGetCountersFx:(0,r.createFriendsGetCountersFx)({domain:e}),friendsGetRecentFx:(0,r.createFriendsGetRecentFx)({domain:e})})},442794:(e,_,s)=>{s.d(_,{getUnixTimestamp:()=>r});const r=(e=new Date)=>Math.floor(e.getTime()/1e3)},146932:(e,_,s)=>{function r(e){return 17===e?.error_code}function t(e){return r(e)&&Boolean(e.redirect_uri?.includes("act=validate"))}function n(e){return!!e&&"object"==typeof e&&"error_code"in e}s.d(_,{isApiError:()=>n,isPhoneValidationError:()=>t})},572291:(e,_,s)=>{s.d(_,{createFriendsCleanupService:()=>l});var r=s(798116),t=s(54438),n=s(146427),i=s(687164),o=s(734539),a=s(835838),d=s(732422);const l=({domain:e=(0,r.createDomain)("friendsCleanupPage")})=>{const _=e.createEvent();e.onCreateStore((e=>e.reset(_)));const s=(0,o.createUserService)({domain:e}),l=e.createEvent("fire/deleteDeclineFriend"),c=e.createEvent("fire/addAcceptFriend"),u=e.createEvent("fire/deleteAllFriends"),E=e.createEvent("fire/deleteAllFriendsAndFollowers"),f=(0,t.createEntitiesFriendsService)({domain:e}),b=e.createEvent(),m=e.createStore([]),D=e.createStore(new Map),O=e.createStore(""),h=e.createStore(""),p=e.createStore(!1),M=e.createStore(!1),w=e.createStore(null),g=e.createStore(!1),P=e.createStore(!1),L=e.createStore(!1),C=(0,r.attach)({effect:s.fetchUserFx,mapParams:e=>({params:{user_ids:String(e.viewerId),fields:"is_closed"}})}),T=e.createEffect((async({controller:e,viewerId:_})=>Promise.all([f.friendsGetFriendsDeletionSuggestionsFx({query:{ref:a.FRIENDS_CLEANUP_PAGE_REF,fields:"friend_status,sex,online_info,descriptions,deactivated,is_friend,screen_name,mutual,first_name_acc,first_name_gen,last_name_acc,last_name_gen,occupation,verified,photo_50,photo_100,photo_200,is_nft"},controller:e}),C({viewerId:_,controller:e})]))),A=e.createEffect((()=>{window.nav.go(a.FRIENDS_SUCCESS_CLEANUP_PAGE,null,{replace:!0})})),R=e.createStore(!0).on(T.pending,((e,_)=>_));return(0,r.sample)({clock:C.doneData,fn:e=>{const[_]=e;return Boolean(_?.is_closed)},target:P}),(0,r.sample)({clock:l,fn:e=>({...e,query:{...e.query,ref:a.FRIENDS_CLEANUP_PAGE_REF}}),target:f.friendsDeleteFx}),(0,r.sample)({clock:c,fn:e=>({...e,query:{...e.query,ref:a.FRIENDS_CLEANUP_PAGE_REF}}),target:f.friendsAddFx}),(0,r.sample)({clock:[c,l],source:{friendsDeletionSuggestions:m},fn:({friendsDeletionSuggestions:e},{query:{user_id:_}})=>_?e.map((e=>e.id===_?{...e,isLoading:!0}:e)):e,target:m}),(0,r.sample)({clock:f.friendsAddFx.done,source:{friendsDeletionSuggestions:m},fn:({friendsDeletionSuggestions:e},{params:{query:_},result:s})=>e.map((e=>{if(e.id===_.user_id&&(2===s||1===s)){const _=e.friend_status===n.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST?n.FriendsFriendStatusStatusEnumNames.IS_FRIEND:n.FriendsFriendStatusStatusEnumNames.OUTCOMING_REQUEST;return(0,d.getUpdatedFriendStatus)(e,a.ARE_FRIENDS,_)}return e})),target:m}),(0,r.sample)({clock:f.friendsDeleteFx.done,source:{friendsDeletionSuggestions:m},fn:({friendsDeletionSuggestions:e},{params:{query:_},result:s})=>e.map((e=>{if(e.id===_.user_id&&s?.success){const s=_.remove_fan===a.REMOVE_ONLY_FROM_FRIENDS?n.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST:n.FriendsFriendStatusStatusEnumNames.NOT_A_FRIEND;return(0,d.getUpdatedFriendStatus)(e,a.NOT_FRIENDS,s)}return e})),target:m}),(0,r.sample)({clock:[f.friendsAddFx.fail,f.friendsDeleteFx.fail],source:{friendsDeletionSuggestions:m},fn:({friendsDeletionSuggestions:e},{params:{query:{user_id:_}}})=>e.map((e=>e.id===_?(0,d.getUpdatedFriendStatus)(e,e.is_friend):e)),target:m}),(0,r.sample)({clock:f.friendsDeleteBulkFx,fn:({query:{remove_fan:e}})=>e===a.REMOVE_ONLY_FROM_FRIENDS,target:M}),(0,r.sample)({clock:f.friendsDeleteBulkFx,fn:({query:{remove_fan:e}})=>e===a.REMOVE_FROM_FRIENDS_AND_FOLLOWERS,target:p}),(0,r.sample)({clock:u,source:{user_ids:h},fn:({user_ids:e})=>({query:{user_ids:e,ref:a.FRIENDS_CLEANUP_PAGE_REF,remove_fan:a.REMOVE_ONLY_FROM_FRIENDS},controller:new AbortController}),target:f.friendsDeleteBulkFx}),(0,r.sample)({clock:E,source:{user_ids:h},fn:({user_ids:e})=>({query:{user_ids:e,ref:a.FRIENDS_CLEANUP_PAGE_REF,remove_fan:a.REMOVE_FROM_FRIENDS_AND_FOLLOWERS},controller:new AbortController}),target:f.friendsDeleteBulkFx}),(0,r.sample)({clock:b,fn:e=>({...e,controller:new AbortController}),target:T}),(0,r.sample)({clock:f.friendsGetFriendsDeletionSuggestionsFx.doneData,fn:({text:e})=>e,target:O}),(0,r.sample)({clock:f.friendsGetFriendsDeletionSuggestionsFx.doneData,fn:({profiles:e})=>e.count,target:w}),(0,r.sample)({clock:f.friendsGetFriendsDeletionSuggestionsFx.doneData,fn:({profiles:e})=>0===e.count,target:L}),(0,r.sample)({clock:f.friendsGetFriendsDeletionSuggestionsFx.doneData,fn:({profiles:e})=>e.items.map((({id:e})=>e)).join(","),target:h}),(0,r.sample)({clock:[f.friendsAddFx.done,f.friendsDeleteFx.done],source:{count:w},fn:({count:e},{result:_})=>e?_===i.FriendsAddResponseEnumNames.APPROVED?e+1:(0,d.isFriendDeleteResponse)(_)&&_?.success?e-1:e:null,target:w}),(0,r.sample)({clock:w,source:{isCleanupCandidatesListEmpty:L},filter:({isCleanupCandidatesListEmpty:e},_)=>0===_&&!e,target:A}),(0,r.sample)({clock:f.friendsDeleteBulkFx.done,target:A}),(0,r.sample)({clock:f.friendsGetFriendsDeletionSuggestionsFx.doneData,fn:({mutuals:e})=>{const _=new Map;if(!e?.length)return _;for(const s of e)_.set(s.id,s);return _},target:D}),(0,r.sample)({clock:f.friendsGetFriendsDeletionSuggestionsFx.doneData,source:{mutuals:D},fn:d.initFriendsStoreItems,target:m}),(0,r.sample)({clock:f.friendsDeleteBulkFx.pending,target:g}),{fireDeleteDeclineFriend:l,fireAddAcceptFriend:c,fireDeleteAllFriends:u,fireDeleteAllFriendsAndFollowers:E,entitiesFriendsService:f,$profiles:m,$cleanupPageText:O,$mutuals:D,$count:w,$isPageLoading:R,initFriendsCleanupPage:b,resetPageEvent:_,$deleteAllFriendsLoading:M,$deleteAllFriendsAndFollowersLoading:p,$isDeletingAllFriendsLoading:g,$isCleanupCandidatesListEmpty:L,$isClosed:P}}},732422:(e,_,s)=>{s.d(_,{getUpdatedFriendStatus:()=>i,initFriendsStoreItems:()=>a,isFriendDeleteResponse:()=>o});var r=s(626863),t=s(593163),n=s(835838);function i(e,_,s){return{...e,is_friend:_,friend_status:s??e.friend_status,isLoading:!1}}function o(e){return void 0!==e.success}const a=({mutuals:e=new Map},{profiles:{items:_}})=>_.map((_=>{const s=_?.mutual?.users?.slice(0,n.MAX_MUTUAL_FRIENDS_TO_SHOW)||[],{mutualPhotos:i}=function({mutuals:e,mutualFriendsIds:_}){const s=[];for(const n of _){const _=e.get(n);if(!_)return{mutualPhotos:s};const i=_.photo_50||_.photo_100;if(i){const e={photo:i,link:(0,r.getOwnerUrl)(_),fullName:(0,t.getUserFullName)({first_name:_.first_name,last_name:_.last_name})};s.push(e)}}return{mutualPhotos:s}}({mutuals:e,mutualFriendsIds:s});return{..._,mutualPhotos:i,isLoading:!1}}))},547556:(e,_,s)=>{s.d(_,{createCacheService:()=>t});var r=s(204153);const t=e=>{const _=(0,r.getEffectorServiceDomain)(e),s=Object.create(null),t=_.createStore(Object.create(null)),n=_.createEvent("add"),i=_.createEvent("delete");return t.on(n,((e,{key:_,data:s})=>(e[_]=s,e))).on(i,((e,_)=>(delete e[_],e))),{$cache:t,add:n,delete:i,get:e=>t.getState()[e]||null,isWaited:e=>void 0!==s[e],getWaited:e=>s[e],setWaited:(e,_)=>{s[e]=_},deleteWaited:e=>{delete s[e]}}}},734539:(e,_,s)=>{s.d(_,{createOwnerService:()=>t.createOwnerService,createUserService:()=>r.createUserService});var r=s(79759),t=s(926003)},926003:(e,_,s)=>{s.d(_,{createOwnerService:()=>l});var r=s(798116),t=s(166695),n=s(184132),i=s(547556),o=s(204153),a=s(465451);const d=(0,i.createCacheService)(),l=e=>{const _=e.fields||[],s=(0,o.getEffectorServiceDomain)(e),i=s.createStore({id:0}),l=s.createEvent("initialize"),c=s.createEvent("reload"),u=s.createEffect({name:"initializeFx"}),E=u.pending,f=u.doneData;return u.use((({ownerId:e,useCache:s})=>{if(s){const s=d.get(e);if(s){if(_.every((e=>s.hasOwnProperty(e))))return Promise.resolve(s)}}if(d.isWaited(e)){const s=d.getWaited(e).find((e=>_.every((_=>Boolean(e.fields[_])))));if(s)return s.promise.finally((()=>{d.deleteWaited(e)})),s.promise}let r=n.Ranges.isGroupId(e)?(0,t.apiWithPrefetch)("groups.getById",{group_ids:String(e),fields:_.join(",")}).then((_=>_.groups?.[0]||{id:e})):(0,t.apiWithPrefetch)("users.get",{user_ids:String(e),fields:_.join(",")}).then((e=>e[0]));const i={fields:_.reduce(((e,_)=>(e[_]=!0,e)),{}),promise:r},o=d.isWaited(e)?[...d.getWaited(e),i]:[i];return d.setWaited(e,o),r})),(0,r.sample)({clock:l,source:i,filter:(e,_)=>e.id!==_,fn:(_,s)=>({ownerId:s,useCache:Boolean(e?.useCache)}),target:u}),(0,r.sample)({clock:c,source:i,fn:e=>({ownerId:e.id}),target:u}),(0,r.sample)({clock:u.doneData,target:i}),(0,r.sample)({clock:u.doneData,filter:()=>Boolean(e?.useCache),fn:e=>{const _=d.get(e.id);if(_){if((0,a.isOwnerUser)(_)&&(0,a.isOwnerUser)(e))return{key:e.id,data:{..._,...e}};if((0,a.isOwnerGroup)(_)&&(0,a.isOwnerGroup)(e))return{key:e.id,data:{..._,...e}}}return{key:e.id,data:e}},target:d.add}),{$isInitializing:E,$owner:i,initialize:l,onInitialized:f,reload:c}}},79759:(e,_,s)=>{s.d(_,{createUserService:()=>n});var r=s(798116),t=s(166695);const n=({domain:e})=>{const _=(e,_)=>!(!e||e.id!==_.userId),s=e.createStore(null),n=e.createEffect((({params:e})=>(0,t.apiWithPrefetch)("users.get",e))),i=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,t.api)("wall.subscribe",e.params)}))),o=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,t.api)("wall.unsubscribe",e.params)}))),a=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,t.api)("video.liveSubscribe",e.params)}))),d=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,t.api)("video.liveUnsubscribe",e.params)}))),l=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,t.api)("fave.addUser",e.params)}))),c=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,t.api)("fave.removeUser",e.params)}))),u=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,t.api)("account.ban",e.params)}))),E=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,t.api)("account.unban",e.params)}))),f=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,t.api)("bestFriends.add",e.params)}))),b=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,t.api)("bestFriends.delete",e.params)})));return(0,r.sample)({clock:n.doneData,fn:e=>e[0]||null,target:s}),(0,r.sample)({clock:i.doneData,source:s,filter:_,fn:e=>({...e,is_subscribed:1}),target:s}),(0,r.sample)({clock:o.doneData,source:s,filter:_,fn:e=>({...e,is_subscribed:0}),target:s}),(0,r.sample)({clock:a.doneData,source:s,filter:_,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:0}:void 0}),target:s}),(0,r.sample)({clock:d.doneData,source:s,filter:_,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:1}:void 0}),target:s}),(0,r.sample)({clock:l.doneData,source:s,filter:_,fn:e=>({...e,is_favorite:1}),target:s}),(0,r.sample)({clock:c.doneData,source:s,filter:_,fn:e=>({...e,is_favorite:0}),target:s}),(0,r.sample)({clock:u.doneData,source:s,filter:_,fn:e=>({...e,blacklisted_by_me:1}),target:s}),(0,r.sample)({clock:E.doneData,source:s,filter:_,fn:e=>({...e,blacklisted_by_me:0}),target:s}),(0,r.sample)({clock:f.doneData,source:s,filter:_,fn:e=>({...e,is_best_friend:!0}),target:s}),(0,r.sample)({clock:b.doneData,source:s,filter:_,fn:e=>({...e,is_best_friend:!1}),target:s}),{fetchUserFx:n,subscribeToPostsFx:i,unsubscribeFromPostsFx:o,subscribeToVideoLiveFx:a,unsubscribeFromVideoLiveFx:d,faveAddUserFx:l,faveRemoveUserFx:c,accountBanFx:u,accountUnbanFx:E,bestFriendAddFx:f,bestFriendDeleteFx:b,$user:s,domain:e}}},379036:(e,_,s)=>{s.d(_,{getEnvConfigValue:()=>n,isEnvConfigEnabled:()=>t});var r=s(977053);function t(e){return(0,r.partConfigEnabled)(e)}function n(e){return(0,r.getConfigValue)(e)}},369418:(e,_,s)=>{s.d(_,{isUserAuthorized:()=>t});var r=s(184132);function t(){const e=window?.vk?.id||0;return!r.Ranges.isZeroOwner(e)}},598381:(e,_,s)=>{s.d(_,{friendsAdd:()=>n,friendsHideSuggestion:()=>t});var r=s(166695);async function t(e){return(0,r.api)("friends.hideSuggestion",e)}async function n(e){return(0,r.api)("friends.add",e,{grouping:!1})}},835838:(e,_,s)=>{s.d(_,{ARE_FRIENDS:()=>n,FRIENDS_CLEANUP_PAGE_REF:()=>l,FRIENDS_SUCCESS_CLEANUP_PAGE:()=>c,MAX_MUTUAL_FRIENDS_TO_SHOW:()=>d,NOT_FRIENDS:()=>i,REMOVE_FROM_FRIENDS_AND_FOLLOWERS:()=>o,REMOVE_ONLY_FROM_FRIENDS:()=>a,SHOW_REC_MODAL_PARAM:()=>r,SHOW_REC_MODAL_PARAM_TRUE_VAL:()=>t});const r="show_rec_modal",t="1",n=1,i=0,o=1,a=0,d=3,l="friends_cleanup",c=`/friends?${r}=${t}`},379696:(e,_,s)=>{s.d(_,{sendSearchFriendEvent:()=>n,sendSearchFriendGlobalEvent:()=>i});var r=s(322695),t=s(324153);function n(){r.searchStatsCollector.logEvent({action:t.SearchClickActionMap.TAP,type:t.EventItemType.SEARCH_PEOPLE_FRIENDS,track_code:""})}function i(){r.searchStatsCollector.logEvent({action:t.SearchClickActionMap.TAP,type:t.EventItemType.SEARCH_PEOPLE_EXCEPT_FRIENDS,track_code:""})}},35227:(e,_,s)=>{s.d(_,{showCommonFriendsBox:()=>r});const r=(e,_)=>{window.showTabbedBox("al_page.php",{act:"box",oid:_,tab:"common"},{cache:1},e)}},622626:(e,_,s)=>{s.d(_,{useStateAndRef:()=>t});var r=s(667294);const t=e=>{const[_,s]=(0,r.useState)(e),t=(0,r.useRef)(e);return[_,t,e=>{t.current=e,s(e)}]}},97443:(e,_,s)=>{var r;s.d(_,{OnboardingCardId:()=>r}),function(e){e[e.PROFILE_PHOTO_ONBOARDING_CARD_ID=1]="PROFILE_PHOTO_ONBOARDING_CARD_ID",e[e.SEND_POST_ONBOARDING_CARD_ID=5]="SEND_POST_ONBOARDING_CARD_ID",e[e.DOWNLOAD_APP_CARD_ID=10]="DOWNLOAD_APP_CARD_ID"}(r||(r={}))},23812:(e,_,s)=>{s.d(_,{getEnabledMvkTabs:()=>E,getEnabledWebTabs:()=>c,getMainDataLoadParams:()=>o,getOwnerContentTabsDataRequestParams:()=>d,getSupportedMvkTabs:()=>u,getSupportedWebTabs:()=>l,getViewerDataLoadParams:()=>a});var r=s(379036),t=s(369418);function n(e){return e.join(",")}const i=n(["age_mark","is_sber_verified","is_tinkoff_verified","is_esia_verified","can_ban","can_see_gifts","followers_count","no_index","about","activities","activity","bdate","no_index","blacklisted","blacklisted_by_me","books","buttons","can_call","can_invite_to_chats","can_post","can_see_all_posts","can_see_wishes","can_send_friend_request","can_subscribe_stories","can_write_private_message","career","city","connections","counters","country","emoji_status","first_name_acc","first_name_dat","first_name_gen","first_name_ins","friend_status","games","gifts_tooltip","has_photo","home_town","image_status","interests","is_dead","is_favorite","is_hidden_from_feed","is_subscribed","is_subscribed_stories","last_name_acc","last_name_dat","last_name_gen","last_name_ins","last_seen","military","movies","music","mutual","occupation","online","online_info","owner_state","personal","quotes","relation","relatives","schools","screen_name","social_button_type","domain","sex","site","status","trending","tv","universities","verified","video_live","wall_default","bdate_visibility","contacts","photo_max","photo_medium_rec","photo_rec","can_ask_question","can_subscribe_posts","cover","first_name_nom","lists","maiden_name","nickname","photo_200","photo_400","photo_avg_color","photo_id","photo_max_size","profile_buttons","stories_archive_count","third_party_buttons","service_description","is_best_friend","is_nft","is_followers_mode_on","is_personal_ads_easy_promote_enabled","need_big_msg_btn_in_profile"]);function o(e,_,s){const r=e===_,t={"photos.get":{owner_id:e,album_id:"profile",rev:1,count:1},"users.getSubscriptions":{fields:n(["photo_200","photo_100","description","status","is_nft"]),count:5,extended:1,user_id:e},"users.getFollowers":{fields:n(["photo_200","photo_100","photo_50","is_friend","sex"]),count:r?8:3,user_id:e},"gifts.get":{user_id:e,count:6}};return _&&(s.withoutFriends||(t["friends.get"]={user_id:e,count:12,fields:n(["domain","photo_100","photo_200","online","is_nft"]),order:"hints"}),t["stories.get"]={owner_id:e}),r&&(t["friends.getRequests"]={need_count:1,count:3,need_viewed:0,fields:n(["photo_100","photo_200","sex"]),extended:1},s.withOnlineFriends&&(t["friends.getOnline"]={user_id:e,count:8,order:"hints"}),t["account.getPrivacySettings"]={privacy_keys:"friends_requests,audios,stories,gifts",need_default:0},t["account.getSilentModeStatus"]={}),s.withoutUser||(t["users.get"]={user_ids:e.toString(),fields:i}),t}function a(e){return{user_ids:String(e),fields:n(["is_followers_mode_on","social_button_type"])}}function d(e,_,s={}){const t={};return _.forEach((_=>{switch(_){case"photos":s.isPhotoFeedEnabled?t["photos.photoFeedGet"]={owner_id:e,extended:1,photo_sizes:1,count:6}:t["photos.getAll"]={owner_id:e,photo_sizes:1,extended:1,skip_hidden:1};break;case"videos":t["video.get"]={owner_id:e,need_privacy:1,count:9};break;case"music":t["audio.get"]={owner_id:e,photo_sizes:1,count:8},t["audio.getPlaylists"]={owner_id:e,photo_sizes:1,count:9};break;case"short_videos":t["shortVideo.getOwnerVideos"]={owner_id:e,count:9};break;case"articles":t["articles.getOwnerPublished"]={owner_id:e,count:3};break;case"narratives":t["narratives.getFromOwner"]={owner_id:e,limit:9};break;case"nfts":{const _=(0,r.getEnvConfigValue)("nft_profile_content_count"),s=_||9;(0,r.isEnvConfigEnabled)("nft_profile_market")?t["nftMarket.searchTokens"]={result_type:"model",search_type:"published",limit:s,props:JSON.stringify({owner_id:e}),fields:JSON.stringify(["collection"])}:t["nft.getCollection"]={owner_id:e,limit:s};break}case"albums":t["photos.getAlbums"]={owner_id:e,count:9,need_system:1,need_covers:1,photo_sizes:1}}})),t}function l(){const e=(0,t.isUserAuthorized)(),_=e?["photos","short_videos","videos","music","articles","narratives","nfts"]:["short_videos","articles"];return(0,r.isEnvConfigEnabled)("profile_enable_album_tabs")&&e&&_.push("albums"),_}function c(){const e=(0,t.isUserAuthorized)(),_=e?["photos","short_videos","music","articles","nfts"]:["short_videos","articles"];return(0,r.isEnvConfigEnabled)("profile_enable_album_tabs")&&e&&_.push("albums"),_}function u(){const e=(0,t.isUserAuthorized)(),_=e?["photos","short_videos","videos","music","narratives","articles","nfts"]:["short_videos"];return(0,r.isEnvConfigEnabled)("profile_enable_album_tabs")&&e&&_.push("albums"),_}function E(){const e=(0,t.isUserAuthorized)(),_=e?["photos","short_videos","videos","music","narratives","articles","nfts"]:["short_videos"];return(0,r.isEnvConfigEnabled)("profile_enable_album_tabs")&&e&&_.push("albums"),_}},960864:(e,_,s)=>{s.d(_,{execute:()=>E,loadMainData:()=>m});var r=s(166695),t=s(306529),n=s(304939),i=s(23812),o=s(835609),a=s(433830),d=s(977053),l=s(5603),c=s(184132),u=s(938346);function E(e,_){const s=[],t=[],i=Object.keys(e),l={},E=new Set;if(!(c.Ranges.isUserId(window.vk?.id)&&(0,d.partConfigEnabled)("web_api_fork"))){const _=(0,d.partConfigEnabled)("profile_unauth_prefetch_web_fix"),s=[];for(const t of i)if(_){try{l[t]=(0,o.loadPrefetchCache)(t,n.API_VERSION,e[t])}catch(e){E.add(t)}l[t]||E.has(t)||s.push((0,r.api)(t,e[t]))}else s.push((0,r.api)(t,e[t]));return _&&!s.length?Promise.resolve(l):Promise.allSettled(s).then((e=>{const s=_?{...l}:{};return e.forEach(((e,_)=>{const r=i[_];"fulfilled"===e.status?s[r]=e.value:((0,d.partConfigEnabled)("web_execute_empty_response_log")&&!(0,a.isMvk)()&&"profile"===window.cur?.module&&"users.get"===r&&(0,u.logProfileError)({error:e.reason,additionalText:"Empty response in fork fallback",extra:{method:r}}),s[r]=!1)})),s}))}for(const _ of i){try{l[_]=(0,o.loadPrefetchCache)(_,n.API_VERSION,e[_])}catch(e){E.add(_)}l[_]||E.has(_)||(s.push(`'${_}': fork(API.${_}(${JSON.stringify(e[_])}))`),t.push(`'${_}': wait(forks['${_}'])`))}if(!s.length)return Promise.resolve(l);const f=`\n    var forks = { ${s.join(",")} };\n\n    return { ${t.join(",")} };\n  `;return(0,r.api)("execute",{code:f},_).then((e=>{if((0,d.partConfigEnabled)("profile_fix_bad_execute_response")&&e.response){const _={...l,...e.response};return e.execute_errors&&(_.execute_errors=e.execute_errors),_}return{...l,...e}}))}const f=e=>new Promise((_=>{e?(0,r.apiWithPrefetch)("onboarding.getCards",{icon_sizes:"24,48",block_type:"multi"}).then((e=>{if(!e.count&&!(0,a.isMvk)())return(0,r.apiWithPrefetch)("onboarding.getCards",{icon_sizes:"24,48",block_type:"single"});_({onboardingCards:e})})).then((e=>{_({onboardingSingleCards:e})})).catch((()=>{console.error("error while loading onboarding"),_()})):_()})),b=(e,_)=>new Promise((s=>{e?(0,r.apiWithPrefetch)("users.get",(0,i.getViewerDataLoadParams)(e),_).then((e=>{s(e)})):s([{id:0}])}));function m(e,_,s,r){const n=e===_,c=(0,i.getMainDataLoadParams)(e,_,s),m=(0,o.startCacheMissLog)("profile_main_data"),D=[E(c,r),b(_,r),f(n)];return m(),Promise.all(D).then((([e,_,r])=>{if(!(s?.withoutUser||e["users.get"]&&e["users.get"].length)){const _=e.execute_errors;(0,d.partConfigEnabled)("web_execute_empty_response_log")&&!(0,a.isMvk)()&&_&&(0,u.logProfileError)({error:_,additionalText:"Empty response in users.get execute",extra:{method:"users.get"}});const s="something wrong with owner loading";throw console.error(s),new Error(s)}const i=e["users.get"]&&e["users.get"][0],o=_?.[0],c={viewer:o,owner:i||void 0};return e["friends.get"]&&(c.friends=e["friends.get"]),e["account.getSilentModeStatus"]&&(c.silentModeStatus=e["account.getSilentModeStatus"]),e["photos.get"]&&(c.avatar=e["photos.get"].items[0]),e["stories.get"]&&(c.stories=e["stories.get"]),e["users.getSubscriptions"]&&(c.subscriptions=e["users.getSubscriptions"]),e["users.getFollowers"]&&(c.followers=e["users.getFollowers"]),e["friends.getRequests"]&&(c.friendRequests=e["friends.getRequests"]),e["account.getPrivacySettings"]&&(c.viewerPrivacySettings=e["account.getPrivacySettings"]),e["gifts.get"]&&(c.gifts=e["gifts.get"]),e["friends.getOnline"]&&(c.onlineFriendIds=e["friends.getOnline"]),r&&(c.onboardingCards=r.onboardingCards,c.onboardingSingleCards=r.onboardingSingleCards),i&&(!n&&i.mutual?.count&&(c.mutual={status:t.LoadingStatus.initial}),n&&c.onlineFriendIds?.length&&(c.onlineFriends={status:t.LoadingStatus.initial}),!n&&i.gifts_tooltip&&(c.giftsCatalog={status:t.LoadingStatus.initial}),c.broadcastStatus=(0,l.getUserBroadcastStatus)(i)||void 0),c}))}},270885:(e,_,s)=>{s.d(_,{MaskIcon:()=>n});var r=s(785893),t=s(659397);function n({src:e,size:_,className:s,style:n,...i}){return(0,r.jsx)("div",{className:(0,t.classNames)("MaskIcon",`MaskIcon--${_}`,s),style:{...n,maskImage:`url("${e}")`,WebkitMaskImage:`url("${e}")`,width:`${_}px`,height:`${_}px`},...i})}},938346:(e,_,s)=>{s.d(_,{REQUEST_NAME:()=>r,logProfileError:()=>o,sendProfileApiRequestErrorStat:()=>i});var r,t=s(802130),n=s(322953);function i(e){(0,t.statlogsValueEvent)("profile_api_requests_error",e)}!function(e){e.MainData="main_data",e.AdditionalData="additional_data",e.UploadCover="upload_cover",e.FetchHelpHints="fetch_help_hints",e.FriendsRecommendations="friends.getRecommendations"}(r||(r={}));const o=(0,n.createSentryLogger)({debugPrefix:"[ProfileRedesign Sentry Logger]"})},306529:(e,_,s)=>{var r;s.d(_,{LoadingStatus:()=>r}),function(e){e[e.initial=0]="initial",e[e.pending=1]="pending",e[e.reloading=2]="reloading",e[e.loaded=3]="loaded",e[e.failed=4]="failed"}(r||(r={}))},66452:(e,_,s)=>{s.d(_,{friendsRecommLogAddVisited:()=>i,friendsRecommLogCheckVisited:()=>o,friendsRecommLogCleanVisited:()=>a});var r,t=s(180937),n=s(921175);function i(e,_,s){const r=d();r[e]={ref:_,trackCode:s,date:Date.now()},t.multiAccountLs.set("friends_recomm_visited",r),window.setTimeout((()=>a(e)),n.TIME_TO_SAVE_FRIENDS_VISITED)}function o(e){return d()[e]}function a(e){if(e){const _=d();delete _[e],t.multiAccountLs.set("friends_recomm_visited",_)}else t.multiAccountLs.remove("friends_recomm_visited")}function d(){const e=t.multiAccountLs.get("friends_recomm_visited")||{};return Object.keys(e).forEach((_=>{Date.now()-e[_]?.date>n.TIME_TO_SAVE_FRIENDS_VISITED&&(delete e[_],t.multiAccountLs.set("friends_recomm_visited",e))})),Object.keys(e).length||t.multiAccountLs.remove("friends_recomm_visited"),e}!function(e){e.friends_recomm_visited="friends_recomm_visited"}(r||(r={}))},5603:(e,_,s)=>{s.d(_,{getUserBroadcastStatus:()=>r});const r=e=>{if(!e.status_audio)return null;const _={text:`${e.status_audio.artist} — ${e.status_audio.title}`};return e.status_audio.owner_id&&e.status_audio.id&&(_.audioRawId=`${e.status_audio.owner_id}_${e.status_audio.id}`),_}},921175:(e,_,s)=>{var r;s.d(_,{FRIENDS_RECOM_VISITED:()=>t,TIME_TO_SAVE_FRIENDS_VISITED:()=>n,UsersRecomStatisticEvents:()=>r}),function(e){e.ShowUserRec="show_user_rec"}(r||(r={}));const t="friends_recomm_visited",n=36e5},826068:(e,_,s)=>{s.d(_,{isVKUserAnonymous:()=>t});var r=s(184132);const t=()=>r.Ranges.isZeroOwner(window.vk.id)},593163:(e,_,s)=>{s.d(_,{getUserFullName:()=>r});const r=e=>{const{first_name:_,last_name:s}=e;return`${_} ${s}`}},305174:(e,_,s)=>{s.d(_,{initReactApp:()=>t});var r=s(973935);function t(e,_,s){e&&(r.render(_,e),s||window.cur.destroy?.push((()=>{e&&r.unmountComponentAtNode(e)})))}},979637:(e,_,s)=>{s.d(_,{PageBlock:()=>i});var r=s(785893),t=s(806660),n=s(246164);const i=({children:e,..._})=>(0,r.jsx)(t.Group,{..._,padding:"m",mode:"card",children:(0,r.jsx)("div",{className:n.default.content,children:e})})},784584:(e,_,s)=>{s.d(_,{FriendsRecommendationsBlock:()=>u});var r=s(785893),t=s(249779),n=s(733552),i=s(584676),o=s(441430),a=s(979637),d=s(368895),l=s(42106),c=s(938056);const u=({href:e,limit:_,title:s,items:u,tooltip:E,button:f,isApiHandler:b=!1,source:m})=>{const D=(0,l.useRecommendations)(_,u);if(!D.items.length)return null;const O=e=>{e.preventDefault(),e.stopPropagation(),(0,d.goToPossibleFriends)(e)};return(0,r.jsxs)(a.PageBlock,{header:(0,r.jsx)(t.Header,{href:e,onClick:O,children:s}),children:[(0,r.jsx)(n.Spacing,{size:4}),(0,r.jsx)(c.FriendsRecommendationsList,{recommendationData:D,tooltip:E,isApiHandler:b,source:m}),(0,r.jsx)(i.Div,{children:(0,r.jsx)(o.Button,{mode:"secondary",size:"s",stretched:!0,href:e,onClick:O,children:f})})]})}},938056:(e,_,s)=>{s.d(_,{FriendsRecommendationsList:()=>C});var r=s(785893),t=s(804181),n=s(8820),i=s(311429),o=s(113788),a=s(152827),d=s(981284),l=s(849456),c=s(46131),u=s(96715),E=s(504190),f=s(977053),b=s(368895),m=s(42106),D=s(700897),O=s(598381),h=s(146932),p=s(456918),M=s(251087),w=s(471828),g=s(117854),P=s(468727),L=s(802124);const C=({recommendationData:e,tooltip:_,isApiHandler:s,source:C})=>{const T=(0,E.useStore)((0,P.sharedSeenStories)().$seenStories),A=(_,r,t,n)=>{if(_.preventDefault(),_.stopPropagation(),r){if(s)return(_=>{const s=e.items.find((e=>e.id===_));if(!s)return;e.updateLoaderById(_,m.LoaderStatus.LOADING);let r={user_id:s.id,source:C};C&&(r.source=C),s.track_code&&(r.track_code=s.track_code),(0,O.friendsAdd)(r).then((_=>{const r=(0,L.getSuccessfulAddingFriendsHtml)(s,_);r&&(0,M.showDoneBox)(r),e.updateLoaderById(s.id,m.LoaderStatus.LOADED)}),(({error:_})=>{(0,h.isPhoneValidationError)(_)?(0,p.showValidationError)(s):(0,M.showDoneBox)(w.getLang("global_unknown_error")),e.updateLoaderById(s.id,m.LoaderStatus.FAILED)}))})(r);if(n)return((_,s,r)=>{e.updateLoaderById(_,m.LoaderStatus.LOADING),(0,b.addAsFriendRequest)(_,s,!0,r).then((()=>{e.updateLoaderById(_,m.LoaderStatus.LOADED)})).catch((()=>{e.updateLoaderById(_,m.LoaderStatus.FAILED)}))})(r,n,t);throw new Error("Failed to add friend, hash is missing")}};return(0,r.jsx)(t.SpacedList,{spacing:2,children:e.items.map((s=>{const t=e.loaders[s.id]===m.LoaderStatus.LOADING,E=s.has_unseen_stories&&!T.has(s.id),b=(0,f.partConfigEnabled)("show_follow_button_as_add");return(0,r.jsx)(n.SimpleCell,{hrefparams:`_ref=${s.ref}`,href:s.href,before:(0,r.jsx)(i.RichAvatar,{size:48,src:s.photo,alt:s.title,nft:s.is_nft,onClick:E?e=>((e,_)=>{e.metaKey||e.ctrlKey||(e.preventDefault(),e.stopPropagation(),(0,D.showStory)(`/owner_feed${_}`,{source:"avatar"}))})(e,s.id):void 0,children:E&&(0,r.jsx)(i.RichAvatar.Outline,{appearance:"accent"})}),after:(0,r.jsx)(r.Fragment,{children:t?(0,r.jsx)(o.Spinner,{}):(0,r.jsx)(a.TextTooltip,{text:s.action_button_tooltip??_,placement:"top",children:(0,r.jsx)(d.IconButton,{"aria-label":_,onClick:e=>A(e,s.id,s.ref,s.hash),children:!s.is_allowed_to_send_friend_request&&b?(0,r.jsx)(l.Icon24AddSquareOutline,{}):(0,r.jsx)(c.Icon24UserAddOutline,{})})})}),badgeAfterTitle:s.is_verified&&(0,r.jsx)(u.Icon16Verified,{}),subtitle:(0,r.jsx)(g.FriendsRecommendationsSubtitle,{item:s}),children:s.title},s.id)}))})}},117854:(e,_,s)=>{s.d(_,{FriendsRecommendationsSubtitle:()=>a});var r=s(785893),t=s(667294),n=s(401014),i=s(800856),o=s(35227);const a=({item:e})=>{const _=(0,t.useCallback)((_=>{_.preventDefault(),_.stopPropagation(),(0,o.showCommonFriendsBox)(_,e.id)}),[]);if(!e.subtitle.label)return null;const s=e.subtitle.label;return e.subtitle.has_common_friends?(0,r.jsx)(i.Link,{mode:"secondary",onClick:_,children:s}):e.subtitle.group_id&&e.subtitle.group_href?(0,r.jsx)("object",{children:(0,r.jsx)(i.Link,{mention_id:"club"+e.subtitle.group_id,onMouseOver:e=>(0,n.mentionOver)(e.target),href:e.subtitle.group_href,onClick:e=>e.stopPropagation(),mode:"secondary",children:s})}):(0,r.jsx)(r.Fragment,{children:s})}},42106:(e,_,s)=>{s.d(_,{LoaderStatus:()=>r,useRecommendations:()=>o});var r,t=s(50614),n=s(667294),i=s(622626);!function(e){e.LOADING="loading",e.LOADED="loaded",e.FAILED="failed"}(r||(r={}));const o=(e,_)=>{const s=(0,n.useRef)(_),r=(0,n.useRef)(!1);s.current||!_?.length||r.current||(s.current=_,r.current=!0);const[o,a,d]=(0,i.useStateAndRef)({}),l=(0,t.useIsMounted)(),c=(e,_)=>{l()&&d({...a.current,[e]:_})};if(!_?.length||!s?.current)return{items:[],loaders:o,updateLoaderById:c};let u=[];const E=e=>u.find((_=>_.id===e.id)),f=()=>s.current?.filter((e=>{if("loaded"!==a.current[e.id]&&!E(e))return!0}));let b=f();for(let _=0;_<s.current.length&&b;_++)if("loaded"===a.current[s.current[_].id]){const _=b[e-1];_&&(u.push(_),b=f())}else{const e=s.current[_];E(e)||u.push(e)}return s.current=u,{items:u.slice(0,e),loaders:o,updateLoaderById:c}}},986018:(e,_,s)=>{var r=s(802130),t=s(234173),n=s(430228),i=s(736701);window.vk?.pe?.static_manager_dynamic_imports&&window.vk?.stDomain&&(s.p=window.vk.stDomain+"/dist/"),window.Friends=n.default,(0,t.tq)().setStartupHandler("Friends/cleanup_tooltip_hash",n.default.initCleanupTooltip),(0,t.tq)().setStartupHandler("Friends/show_add_rec_modal",n.default.initLoadAddFriendsModal),(0,t.tq)().setStartupHandler("Friends/init_friends_cleanup",i.initFriendsCleanupPage);try{window.stManager.done(window.jsc("web/friends.js"))}catch(e){}requestIdleCallback((()=>{try{(0,r.statlogsValueEvent)("entries_requests",1,"friends","web")}catch{}}),{timeout:5e3})},948035:(e,_,s)=>{s.d(_,{FriendsCleanupPage:()=>f});var r=s(785893),t=s(667294),n=s(504190),i=s(733552),o=s(806660),a=s(252797),d=s(107431),l=s(462473),c=s(977053),u=s(920455),E=s(250727);const f=()=>{const e=(0,n.useStore)(l.cleanupPageService.$isPageLoading),_=(0,n.useStore)(l.cleanupPageService.$isCleanupCandidatesListEmpty),s=(0,c.partConfigEnabled)("web_spa_router_friends");return(0,t.useEffect)((()=>(l.cleanupPageService.initFriendsCleanupPage({viewerId:window.vk.id}),()=>{l.cleanupPageService.resetPageEvent()})),[]),e?(0,r.jsxs)(r.Fragment,{children:[!s&&(0,r.jsx)(i.Spacing,{size:15}),(0,r.jsx)(u.MainContentSkeleton,{section:E.FRIENDS_SECTIONS.CLEANUP})]}):_?(0,r.jsxs)(r.Fragment,{children:[!s&&(0,r.jsx)(i.Spacing,{size:15}),(0,r.jsx)(o.Group,{children:(0,r.jsx)(d.FriendListRelevant,{})})]}):(0,r.jsxs)(r.Fragment,{children:[!s&&(0,r.jsx)(i.Spacing,{size:15}),(0,r.jsxs)(o.Group,{header:(0,r.jsx)(d.CleanupHeader,{}),children:[(0,r.jsx)(d.Subtitle,{}),(0,r.jsx)(a.SeparatorSpacing,{size:16}),(0,r.jsx)(d.UsersList,{})]})]})}},347595:(e,_,s)=>{s.d(_,{FriendsCleanupPage:()=>r.FriendsCleanupPage});var r=s(948035)},49188:(e,_,s)=>{s.d(_,{createCleanupPageService:()=>a});var r=s(785893),t=s(798116),n=s(284658),i=s(572291),o=s(540679);const a=()=>{const e=(0,t.createDomain)("friendsCleanupPage"),_=(0,i.createFriendsCleanupService)({domain:e}),{fireDeleteDeclineFriend:s,fireAddAcceptFriend:a,fireDeleteAllFriends:d,fireDeleteAllFriendsAndFollowers:l,$deleteAllFriendsLoading:c,$deleteAllFriendsAndFollowersLoading:u,$isDeletingAllFriendsLoading:E,$isCleanupCandidatesListEmpty:f,$isClosed:b,$profiles:m,$cleanupPageText:D,$mutuals:O,$count:h,$isPageLoading:p,initFriendsCleanupPage:M,entitiesFriendsService:w}=_,g=e.createEvent();e.onCreateStore((e=>e.reset(g)));const P=(0,t.createEffect)((({params:e})=>{const _=e.query.remove_fan?l:d;(0,n.showMessageBoxModal)((e=>(0,r.jsx)(o.DeleteAllFailedModal,{...e,deleteAllFriends:_})),{width:420})}));return(0,t.sample)({clock:w.friendsDeleteBulkFx.fail,target:P}),{fireDeleteDeclineFriend:s,fireAddAcceptFriend:a,fireDeleteAllFriends:d,fireDeleteAllFriendsAndFollowers:l,entitiesFriendsService:w,$profiles:m,$cleanupPageText:D,$mutuals:O,$count:h,$isPageLoading:p,initFriendsCleanupPage:M,resetPageEvent:g,$deleteAllFriendsLoading:c,$deleteAllFriendsAndFollowersLoading:u,$isDeletingAllFriendsLoading:E,$isCleanupCandidatesListEmpty:f,$isClosed:b}}},462473:(e,_,s)=>{s.d(_,{cleanupPageService:()=>r});const r=(0,s(49188).createCleanupPageService)()},813401:(e,_,s)=>{s.d(_,{CleanupHeader:()=>E});var r=s(785893),t=s(504190),n=s(800856),i=s(249779),o=s(471828),a=s(284658),d=s(462473),l=s(705853),c=s(39303);const u=({handleRemoveAllFriends:e})=>(0,r.jsx)(n.Link,{hasActive:!1,hasVisited:!1,onClick:e,children:(0,r.jsx)("div",{children:o.getLang("friends_cleanup_remove_all_button")})}),E=()=>{const e=(0,t.useStore)(d.cleanupPageService.$count),_=(0,t.useStore)(d.cleanupPageService.$isClosed);return(0,r.jsx)(i.Header,{indicator:e,size:"large",Component:"h1",aside:(0,r.jsx)(u,{handleRemoveAllFriends:()=>{_?(0,a.showMessageBoxModal)((_=>(0,r.jsx)(c.DeleteAllClosedProfileModal,{..._,deleteAllFriendsAndFollowers:d.cleanupPageService.fireDeleteAllFriendsAndFollowers,count:e})),{width:420}):(0,a.showMessageBoxModal)((_=>(0,r.jsx)(l.DeleteAllModal,{..._,deleteAllFriends:d.cleanupPageService.fireDeleteAllFriends,count:e,deleteAllFriendsAndFollowers:d.cleanupPageService.fireDeleteAllFriendsAndFollowers})),{width:420})}}),children:o.getLang("friends_cleanup_low_interaction_title")})}},756924:(e,_,s)=>{s.d(_,{Subtitle:()=>d});var r=s(785893),t=s(504190),n=s(86894),i=s(584676),o=s(130593),a=s(462473);const d=()=>{const e=(0,t.useStore)(a.cleanupPageService.$cleanupPageText);return(0,r.jsx)(i.Div,{paddingTop:0,paddingBottom:4,spacing:12,children:(0,r.jsx)(n.Footnote,{children:(0,r.jsx)("div",{className:(0,o.getColorClass)("color_text_secondary"),children:e})})})}},755851:(e,_,s)=>{s.d(_,{ConfirmModal:()=>d});var r=s(785893),t=s(60811),n=s(242453),i=s(49169),o=s(249580),a=s(471828);const d=({title:e=a.getLang("global_box_confirm_title"),confirmButton:_,cancelButton:s,text:d=a.getLang("market_confirm_text"),onClose:l})=>(0,r.jsxs)(t.ModalBox,{children:[(0,r.jsx)(n.ModalHeader,{onClose:l,closeAriaLabel:a.getLang("global_close"),children:e}),(0,r.jsx)(i.ModalBody,{insetLevel:2,children:d}),(0,r.jsx)(o.ModalFooter,{actionButtons:(0,r.jsxs)(r.Fragment,{children:[_,s]})})]})},39303:(e,_,s)=>{s.d(_,{DeleteAllClosedProfileModal:()=>d});var r=s(785893),t=s(471828),n=s(755851),i=s(441430),o=s(504190),a=s(462473);const d=({deleteAllFriendsAndFollowers:e,count:_,onClose:s})=>{const d=(0,o.useStore)(a.cleanupPageService.$deleteAllFriendsAndFollowersLoading);return(0,r.jsx)(n.ConfirmModal,{onClose:s,confirmButton:(0,r.jsx)(i.Button,{size:"m",mode:"primary",onClick:e,loading:d,children:t.getLang("friends_cleanup_remove")}),cancelButton:(0,r.jsx)(i.Button,{size:"m",mode:"secondary",onClick:s,children:t.getLang("friends_cleanup_cancel")}),title:t.getLang("friends_cleanup_delete_all_modal_title"),text:(0,t.langNumeric)(_||0,t.getLang("friends_cleanup_delete_all_modal_text","raw"))})}},540679:(e,_,s)=>{s.d(_,{DeleteAllFailedModal:()=>d});var r=s(785893),t=s(441430),n=s(471828),i=s(755851),o=s(462473),a=s(504190);const d=({deleteAllFriends:e,onClose:_})=>{const s=(0,a.useStore)(o.cleanupPageService.$isDeletingAllFriendsLoading);return(0,r.jsx)(i.ConfirmModal,{confirmButton:(0,r.jsx)(t.Button,{size:"m",mode:"primary",onClick:e,loading:s,children:n.getLang("friends_cleanup_delete_all_modal_failed_try_again_button")}),cancelButton:(0,r.jsx)(t.Button,{size:"m",mode:"secondary",onClick:_,children:n.getLang("friends_cleanup_cancel")}),title:n.getLang("friends_cleanup_delete_all_modal_failed_title"),text:n.getLang("friends_cleanup_delete_all_modal_failed_text"),onClose:_})}},705853:(e,_,s)=>{s.d(_,{DeleteAllModal:()=>d});var r=s(785893),t=s(504190),n=s(441430),i=s(471828),o=s(755851),a=s(462473);const d=({deleteAllFriends:e,deleteAllFriendsAndFollowers:_,count:s,onClose:d})=>{const l=(0,t.useStore)(a.cleanupPageService.$deleteAllFriendsLoading),c=(0,t.useStore)(a.cleanupPageService.$deleteAllFriendsAndFollowersLoading);return(0,r.jsx)(o.ConfirmModal,{onClose:d,confirmButton:(0,r.jsx)(n.Button,{size:"m",mode:"secondary",onClick:_,loading:c,children:i.getLang("friends_cleanup_delete_all_closed_modal_delete_button")}),cancelButton:(0,r.jsx)(n.Button,{size:"m",mode:"primary",onClick:e,loading:l,children:i.getLang("friends_cleanup_delete_all_closed_modal_leave_in_followers_button")}),title:i.getLang("friends_cleanup_delete_all_closed_modal_title"),text:(0,i.langNumeric)(s||0,i.getLang("friends_cleanup_delete_all_closed_modal_text","raw"))})}},853304:(e,_,s)=>{s.d(_,{DeleteFriendModal:()=>d});var r=s(785893),t=s(504190),n=s(441430),i=s(471828),o=s(755851),a=s(462473);const d=({onRemoveFriend:e,onRemoveFriendAndFollower:_,nameAcc:s,onClose:d,deactivated:l})=>{const c=(0,t.useStore)(a.cleanupPageService.$isClosed);return(0,r.jsx)(o.ConfirmModal,{onClose:d,confirmButton:(0,r.jsx)(n.Button,{size:"m",mode:"secondary",onClick:_,children:i.getLang("friends_cleanup_delete_all_closed_modal_delete_button")}),cancelButton:c||l?(0,r.jsx)(n.Button,{size:"m",mode:"secondary",onClick:d,children:i.getLang("friends_cleanup_cancel")}):(0,r.jsx)(n.Button,{size:"m",mode:"primary",onClick:e,children:i.getLang("friends_cleanup_delete_all_closed_modal_leave_in_followers_button")}),title:i.getLang("friends_cleanup_delete_all_modal_title"),text:(0,i.langReplace)(i.getLang("friends_cleanup_remove_from_friends_and_followers"),{name_acc:s})})}},312318:(e,_,s)=>{s.d(_,{FriendListRelevant:()=>l});var r=s(785893),t=s(249779),n=s(733552),i=s(258037),o=s(441430),a=s(471828),d=s(140271);const l=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.Header,{size:"large",separator:!0,children:a.getLang("friends_cleanup_low_interaction_title")}),(0,r.jsx)(n.Spacing,{size:8}),(0,r.jsx)(i.Placeholder,{icon:(0,r.jsx)(d.Icon56CheckCircleOutline,{}),header:a.getLang("friends_cleanup_relevant_title"),action:(0,r.jsx)(o.Button,{href:"/friends",size:"m",children:a.getLang("friends_cleanup_relevant_go_to_friend_list")}),children:a.getLang("friends_cleanup_relevant_text")})]})},216974:(e,_,s)=>{s.d(_,{UserButton:()=>D});var r=s(785893),t=s(504190),n=s(441430),i=s(471828),o=s(593163),a=s(977053),d=s(284658),l=s(835838),c=s(462473),u=s(853304),E=s(146427);const f=({isLoading:e,id:_})=>(0,r.jsx)(n.Button,{mode:"secondary",onClick:()=>{c.cleanupPageService.fireAddAcceptFriend({query:{user_id:_}})},loading:e,children:i.getLang("friends_cleanup_add")}),b=({isLoading:e,id:_})=>(0,r.jsx)(n.Button,{mode:"secondary",onClick:()=>{c.cleanupPageService.fireDeleteDeclineFriend({query:{user_id:_,remove_fan:l.REMOVE_FROM_FRIENDS_AND_FOLLOWERS}})},loading:e,children:i.getLang("friends_cleanup_you_subscribed")}),m=({friend:e})=>{const _=(0,t.useStore)(c.cleanupPageService.$isClosed),s=(0,o.getUserFullName)({first_name:e.first_name_acc,last_name:e.last_name_acc}),E=()=>{c.cleanupPageService.fireDeleteDeclineFriend({query:{user_id:e.id,remove_fan:l.REMOVE_ONLY_FROM_FRIENDS}})};return(0,r.jsx)(n.Button,{mode:"secondary",onClick:()=>{(0,a.partConfigEnabled)("cleanup_friends_show_delete_friends_modal")||_?(0,d.showMessageBoxModal)((_=>(0,r.jsx)(u.DeleteFriendModal,{..._,nameAcc:s,onRemoveFriend:()=>{E(),_.onClose()},onRemoveFriendAndFollower:()=>{c.cleanupPageService.fireDeleteDeclineFriend({query:{user_id:e.id,remove_fan:l.REMOVE_FROM_FRIENDS_AND_FOLLOWERS}}),_.onClose()},deactivated:Boolean(e.deactivated)})),{width:420}):E()},loading:e.isLoading,children:i.getLang("friends_cleanup_remove")})},D=({friend:e})=>{if((0,a.partConfigEnabled)("cleanup_friends_disable_follow_button"))return e.is_friend?(0,r.jsx)(m,{friend:e}):e.deactivated?null:(0,r.jsx)(f,{isLoading:e.isLoading,id:e.id});switch(e.friend_status){case E.FriendsFriendStatusStatusEnumNames.IS_FRIEND:return(0,r.jsx)(m,{friend:e});case E.FriendsFriendStatusStatusEnumNames.NOT_A_FRIEND:return e.deactivated?null:(0,r.jsx)(f,{isLoading:e.isLoading,id:e.id});case E.FriendsFriendStatusStatusEnumNames.OUTCOMING_REQUEST:return(0,r.jsx)(b,{isLoading:e.isLoading,id:e.id});case E.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST:return e.deactivated?null:(0,r.jsx)(f,{isLoading:e.isLoading,id:e.id});default:return null}}},926842:(e,_,s)=>{s.d(_,{UsersList:()=>w});var r=s(785893),t=s(504190),n=s(168145),i=s(990460),o=s(130593),a=s(942205),d=s(152827),l=s(800856),c=s(311429),u=s(96715),E=s(471828),f=s(626863),b=s(593163),m=s(462473),D=s(216974);const O=({occupation:e})=>(0,r.jsx)(n.UserRichCell.Status,{children:e}),h=({friend:e})=>e.mutual?.count?(0,r.jsx)(a.UsersStack,{photos:e.mutualPhotos,Wrapper:({photo:e,children:_})=>(0,r.jsx)(d.TextTooltip,{text:e?.fullName,children:(0,r.jsx)(l.Link,{href:e?.link,target:"_blank",rel:"noreferrer",children:_})}),children:(0,E.langNumeric)(e.mutual?.count,E.getLang("profile_mutual_label_short","raw"))}):(0,r.jsx)(i.Text,{className:(0,o.getColorClass)("color_text_secondary"),children:E.getLang("friends_no_common_friends")}),p=()=>(0,r.jsx)(n.UserRichCell.NameIcon,{children:(0,r.jsx)(u.Icon16Verified,{className:(0,o.getColorClass)("color_icon_accent")})}),M=({friend:e})=>{const _=e.verified?(0,r.jsx)(p,{}):void 0,s=(0,r.jsx)(h,{friend:e}),t=e?.descriptions?.[0]||e.occupation?.name,i=t?(0,r.jsx)(O,{occupation:t}):void 0;return(0,r.jsx)(n.UserRichCell,{href:(0,f.getOwnerUrl)(e),name:(0,b.getUserFullName)({first_name:e.first_name,last_name:e.last_name}),nameAfter:_,mutualFriends:s,avatar:(0,r.jsx)(c.RichAvatar,{src:e.photo_200||e.photo_100,nft:Boolean(e.is_nft),href:(0,f.getOwnerUrl)(e),target:"_blank"}),status:i,after:(0,r.jsx)(D.UserButton,{friend:e})})},w=()=>(0,t.useList)(m.cleanupPageService.$profiles,{fn:e=>(0,r.jsx)(M,{friend:e}),getKey:e=>e.id})},107431:(e,_,s)=>{s.d(_,{CleanupHeader:()=>r.CleanupHeader,FriendListRelevant:()=>i.FriendListRelevant,Subtitle:()=>t.Subtitle,UsersList:()=>n.UsersList});var r=s(813401),t=s(756924),n=s(926842),i=s(312318)},402666:(e,_,s)=>{s.d(_,{showAddNewFriendsModalBox:()=>i});var r=s(785893),t=s(661587),n=s(284658);function i(){const e=(0,t.asyncComponent)((()=>Promise.all([s.e(2067),s.e(20795),s.e(3301)]).then(s.bind(s,128303))),(({AddNewFriendsModal:e})=>e));(0,n.showMessageBoxModalSuspense)((_=>(0,r.jsx)(e,{..._})),{width:400})}},736701:(e,_,s)=>{s.d(_,{initFriendsCleanupPage:()=>l});var r=s(785893),t=s(973935),n=s(42374),i=s(347595),o=s(618418),a=s(977053);const d="friends_cleanup_page",l=()=>{(0,a.partConfigEnabled)("cleanup_friends_enabled")&&(0,n.registerReactApplication)(d,(()=>{const e=(0,n.getReactRootEl)(d);t.render((0,r.jsx)(i.FriendsCleanupPage,{}),e),(0,o.pushNavDestroy)((()=>{e&&t.unmountComponentAtNode(e)}))}))}},414284:(e,_,s)=>{s.d(_,{initFriendsRightBlocks:()=>d});var r=s(785893),t=s(659397),n=s(780891),i=s(733552),o=s(784584),a=s(305174);const d=e=>{e=(0,t.decodeHTMLEntitiesDeep)(e);const _=document.querySelector("#friends_right_blocks_root");(0,a.initReactApp)(_,(0,r.jsxs)(n.AppRootProvider,{children:[(0,r.jsx)(i.Spacing,{size:15}),(0,r.jsx)(o.FriendsRecommendationsBlock,{...e})]}))}},505369:(e,_,s)=>{s.d(_,{AVATAR_SIZES:()=>u,COMMON_FRIENDS_IMAGE_STATUS_INDEX:()=>o,FOLLOWERS_SECTION_NAME:()=>c,FRIENDS_IMAGE_STATUS_INDEX:()=>i,FRIENDS_LIMIT_PER_PAGE:()=>E,FRIENDS_LIST_FRIEND_IS_NFT_INDEX:()=>a,FRIENDS_LIST_FRIEND_OPTIONS_INDEX:()=>r,FRIENDS_REQUESTS_FRIEND_IS_NFT_INDEX:()=>d,FRIENDS_REQUESTS_TO_SUBSCRIBERS_CLASSES:()=>f,FRIENDS_SECTIONS:()=>b,FRIENDS_STATUS_NOT_FRIENDS:()=>t,FRIENDS_STATUS_REQUEST_FROM_USER:()=>n,PHONEBOOK_SECTION_NAME:()=>l});const r=13,t=0,n=1,i=9,o=8,a=14,d=11,l="phonebook",c="followers",u={normal:80,small:48},E=2e3,f={ROOT:"friends_requests_to_subscribers",DESCRIPTION_STEP:"friends_requests_to_subscribers_description_step",DONE_STEP:"friends_requests_to_subscribers_done_step"};var b;!function(e){e.ALL="all",e.ALL_REQUESTS="all_requests",e.OUT_REQUESTS="out_requests",e.REQUESTS="requests",e.CLEANUP="cleanup"}(b||(b={}))},890623:(e,_,s)=>{s.d(_,{FRIENDS_LIST_LOADING_MARK_START:()=>t,FRIENDS_LIST_LOADING_STATLOG:()=>o,FRIENDS_LOAD_MORE_MARK_START:()=>i,FRIENDS_OUT_REQUESTS_LOADING_MARK_START:()=>n,FriendsListLoadingType:()=>l,sendLoadingStats:()=>u,trackEndWithMarkName:()=>d,trackStartWithMarkName:()=>a});var r=s(762003);const t="FRIENDS_LIST_LOADING_MARK_START",n="FRIENDS_OUT_REQUESTS_LOADING_MARK_START",i="FRIENDS_LOAD_MORE_MARK_START",o="friends_list_loading";function a(e){window.cur.friendsPerformanceMarks||(window.cur.friendsPerformanceMarks={}),window.cur.friendsPerformanceMarks[e]=performance.now()}function d(e){return{duration:performance.now()-+window.cur.friendsPerformanceMarks[e]}}var l;!function(e){e.INIT_BLOCKING="init_blocking",e.INIT_PARALLEL="init_parallel",e.OUT_REQUESTS_BLOCKING="out_requests_blocking",e.LOAD_MORE="load_more"}(l||(l={}));const c=()=>({isSameUser:window.vk?.id===window.cur?.oid?"true":"false"});function u(e,_,s){const t={...s,...c()};(0,r.statlogsValueEvent)(e,_,t)}},944313:(e,_,s)=>{s.d(_,{FriendsListLoadingMode:()=>r,fillFriendsListWithDataFromServer:()=>m,isFriendsLoadingBugfixEnabled:()=>f,removeUnseenStories:()=>E});var r,t=s(143066),n=s(368076),i=s(558149),o=s(977053),a=s(505369),d=s(636322),l=s(851782),c=s(890623),u=s(468727);function E(e){window.cur&&window.cur.hasUnseenStories&&delete window.cur.hasUnseenStories[e];const _=document.querySelectorAll(".friends_photo_stories_unseen"+e);for(const s of _)s.classList.remove("friends_photo_stories_unseen","friends_photo_stories_unseen"+e),s.closest(".friends_photo")?.removeAttribute("onclick");(0,u.sharedSeenStories)().addSeenStories(e),(0,t.removeRichAvatarOutlineAtNode)(document.body,String(e),"stories_unseen")}function f(e=!1){return(0,o.partConfigEnabled)("friends_list_loading_bugfix")&&e}function b(e){return(_=0,s=e,Array.from(Array(s).keys()).map((e=>e+_))).map((e=>{return _={queryParams:{id:window.cur.oid??0,gid:window.cur.gid??0,sort:window.nav.objLoc.sort,platform_id:window.nav.objLoc.platform_id,section:window.cur.section,chunk_index:e,chunk_size:a.FRIENDS_LIMIT_PER_PAGE}},new Promise(((e,s)=>{l.ajax.post("al_friends.php",{act:"load_friends_silent",..._.queryParams},{onDone:(_,s,r)=>{e({friendsData:_,occupations:s,filters:r})},onFail:(e,_)=>{s({error:e,status:_})},local:1})}));var _}));var _,s}function m(e){const{showMore:_,filter:s,indexAll:r}=e.friendsMethods,t=function(e){const{icon:_}=(0,i.getIcon32Spinner)(),s=document.createElement("div");s.classList.add("friends_wide_loading");const r=(0,n.createElementFromHTML)(_);return r&&(s.append(r),e?.append(s)),()=>{s.remove()}}(document.querySelector("#list_content"));var o,l;let u=b((o=[window.cur.allFriendsCount,window.cur.allRequestsCount,window.cur.requestsCount,window.cur.followersCount],l=a.FRIENDS_LIMIT_PER_PAGE,Math.ceil(Math.max(...o)/l)));!function(){for(let e in window.cur.friendsList)window.cur.friendsList.hasOwnProperty(e)&&(window.cur.friendsList[e]=[])}(),Promise.allSettled(u).then((e=>{t(),window.cur.silent=!1;const n=[];let i=200,o="",a="false";for(let t of e){if("rejected"===t.status){i=t.reason?.status??"unknown",o=t.reason?.error?.message??"",a="true";continue}const{friendsData:e,occupations:l,filters:c}=t.value;if(e){window.cur.occupations=(0,d.extend)(window.cur.occupations||{},l);for(let _ in e)e.hasOwnProperty(_)&&(window.cur.friendsList[_]=Array.isArray(window.cur.friendsList[_])?window.cur.friendsList[_].concat(e[_]):e[_]);r((function(){"list"==window.cur.section.substr(0,4)&&(window.cur.friendsList[window.cur.section]=Array.isArray(window.cur.friendsList[window.cur.section])?window.cur.friendsList[window.cur.section].concat(s(window.cur.friendsList.all,window.cur.section)):s(window.cur.friendsList.all,window.cur.section)),(window.cur.onSilentLoad||_)()})),c.cities&&n.push(c.cities)}}const l=n.flat().reduce(((e,_)=>{const s=function(e){if("string"==typeof e)return e;return`${e[0]}_${e[1]}`}(_);return e[s]||(e[s]=_),e}),{});!function(e){window.stManager.add(["ui_controls.js","ui_controls.css"],(function(){if(window.cur.cityFilter.setData(e),window.cur.cityFilterOpened){const e=document.getElementById("friends_fltr_progress");e&&(e.style.display="none"),window.cur.cityFilter.showDefaultList()}}))}(Object.values(l));const u=(0,c.trackEndWithMarkName)(c.FRIENDS_LIST_LOADING_MARK_START);(0,c.sendLoadingStats)(c.FRIENDS_LIST_LOADING_STATLOG,u.duration,{allFriendsListCount:window.cur.allFriendsCount,fansCount:window.cur.allRequestsCount,requestsCount:window.cur.requestsCount,followersCount:window.cur.followersCount,outRequestsCount:window.cur.outRequestsCount,mode:"silent",httpStatus:i,section:window.cur.curList,errorMessage:o,loadingType:c.FriendsListLoadingType.INIT_PARALLEL,userId:window.vk.id,hasError:a})}))}!function(e){e.SILENT="silent",e.DEFAULT="default"}(r||(r={}))},468727:(e,_,s)=>{s.d(_,{sharedSeenStories:()=>o});var r=s(288824),t=s(798116);const n=(0,t.createEvent)(),i=(0,t.createStore)(new Set).on(n,((e,_)=>{const s=new Set(e);return s.add(_),s})),o=(0,r.makeSharedState)("seen-stories",(()=>({addSeenStories:n,$seenStories:i})),{version:0})},368895:(e,_,s)=>{s.d(_,{addAsFriendRequest:()=>o,goToPossibleFriends:()=>a});var r=s(251087),t=s(159663),n=s(471828),i=s(93367);function o(e,_,s,i){let o;return o=s?{act:"add",mid:e,hash:_,from:i,request:1}:{act:"hide_possible",mid:e,hash:_,from:i},new Promise(((e,_)=>{window.ajax.post("al_friends.php",o,{onDone:_=>{e(_),s&&(0,r.showDoneBox)(_)},onFail:e=>(_(e),!!e&&((0,t.showFastBox)(n.getLang("global_error"),e),!0))})}))}function a(e){if((0,i.checkEvent)(e))return!1;const _=document.querySelector("#narrow_column .friends_section_find");return _?(_.click(),!1):(window.nav.go("/friends?act=find"),!0)}},456918:(e,_,s)=>{s.d(_,{fetchDataOnAvatarEdit:()=>w,fetchDataOnCoverUpdate:()=>M,fetchDataOnWebProfileItemStat:()=>g,getOwnerCoverPhotoUploadServer:()=>D,removeFromFollowers:()=>m,removeFromFriends:()=>b,removeOwnerCoverPhoto:()=>h,saveOwnerCoverPhoto:()=>p,sendHideOnboardingCards:()=>O,showValidationError:()=>P});var r=s(166695),t=s(893682),n=s(585688),i=s(66452),o=s(762003),a=s(306529),d=s(960864),l=s(159663),c=s(471828),u=s(938346),E=s(322695),f=s(324153);function b(e){const _=e.id,s={user_id:_},t=(0,i.friendsRecommLogCheckVisited)(_);return t&&(s.ref=(0,n.getRef)(),t.trackCode&&(s.track_code=t.trackCode),(0,i.friendsRecommLogCleanVisited)(_)),(0,r.api)("friends.delete",s).then((e=>((0,o.tryLogOutOfSerpClick)(o.outOfSerpProfile,_,o.clickTypeRemoveFriendOut),E.searchStatsCollector.logOutOfSerpEvent({action:f.SearchClickActionMap.REMOVE_FRIEND_OUT,type:f.EventItemType.USER}),e)))}function m({id:e}){const _={subscriber_id:e};return(0,r.api)("friends.deleteSubscriber",_)}function D(e){return(0,r.api)("photos.getOwnerCoverPhotoUploadServer",e)}function O(){return(0,r.api)("onboarding.hideCardsBlock",{})}function h(){return(0,r.api)("photos.removeOwnerCoverPhoto",{})}function p(e){return(0,r.api)("photos.saveOwnerCoverPhoto",e)}function M(e){return(0,d.execute)({"users.get":{user_ids:String(e),fields:"cover,photo_avg_color"}}).then((e=>{if(!e["users.get"]){const e=new Error("something wrong with owner loading");throw(0,u.logProfileError)({error:e}),e}return{owner:e["users.get"][0]}}))}function w(e){return(0,d.execute)({"users.get":{user_ids:e.toString(),fields:"has_photo,image_status,photo_max,photo_medium_rec,photo_rec,photo_200,photo_400,photo_avg_color,photo_id,photo_max_size,is_nft"},"photos.get":{owner_id:e,album_id:"profile",rev:1,count:1},"photos.getAll":{owner_id:e,photo_sizes:1,extended:1,skip_hidden:1},"stories.get":{owner_id:e}}).then((e=>{const _={};return e["users.get"]&&(_.owner=e["users.get"][0]),e["photos.get"]&&(_.avatar=e["photos.get"].items[0]),e["stories.get"]&&(_.stories=e["stories.get"]),e["photos.getAll"]&&(_.photos={response:e["photos.getAll"],status:a.LoadingStatus.loaded}),_}))}function g(e){return(0,r.api)("users.get",{user_ids:e.toString(),fields:"id,cover,verified,image_status,has_photo,status,friend_status,profile_buttons,third_party_buttons"}).then((([e])=>e)).catch((e=>{(0,u.logProfileError)({error:e,additionalText:"something wrong with getting owner for stat"})}))}function P(e){(0,l.showFastBox)(c.getLang("friends_add_phone_validation_error_title"),(0,c.langSex)(e.sex||t.BaseSexEnumNames.UNKNOWN,c.getLang("friends_add_phone_validation_error","raw")).replace("{name}",e.first_name_dat||""),c.getLang("friends_add_phone_validation_error_action"),(()=>window.nav.go("/settings?validate=1")),c.getLang("global_cancel"))}},910963:(e,_,s)=>{s.d(_,{VKUIIconContainer:()=>t});var r=s(785893);function t({src:e,size:_=20,alt:s=""}){return(0,r.jsx)("img",{className:"vkuiIcon",src:e,alt:s,width:_,height:_})}},802124:(e,_,s)=>{s.d(_,{cleanTextSpaces:()=>g,formatTimespanToTimeMap:()=>U,getActionOnboardingAttrByUrl:()=>W,getCityIds:()=>R,getCountryIds:()=>I,getIconComponent:()=>L,getMaskIconComponent:()=>C,getPhotoOwner:()=>P,getSuccessfulAddingFriendsHtml:()=>k,getTextForUnavailableMessageBlock:()=>A,getThirdPartyButtonAppUrl:()=>T,getUserAvatarPhoto:()=>p,getUserFullName:()=>M,getUserHref:()=>w,isUserProfileHiddenFromAnonymousViewers:()=>K,mapArrayToMap:()=>F,stringToHtmlWithLinks:()=>S,transformVKAPIDateToTimeStamp:()=>B});var r=s(785893),t=s(893682),n=s(625492),i=s(687164),o=s(902947),a=s(659397),d=s(442794),l=s(216518),c=s(561530),u=s(464013),E=s(910963),f=s(471828),b=s(270885),m=s(97443),D=s(30655),O=s(826068),h=s(626863);function p(e,_){return _||e?(0,o.isRetina)()&&_?_:e||"":""}function M(e,_,s,r,n=!1){const i=[];e&&i.push((0,o.trim)(e)),_&&i.push((0,o.trim)(_)),s&&r===t.BaseSexEnumNames.FEMALE&&i.push(`(${(0,o.trim)(s)})`);const a=i.pop();return[i.join(" ")+" "+(n?"":a),a]}function w(e){const _=e.domain||e.screen_name;return`/${_||`id${e.id}`}`}function g(e){return e.replace(/\s\s+/g," ").replace(/\s/g," ")}function P(e){const _=e.photo_100||e.photo_50;return(0,o.isRetina)()&&e.photo_200||_}function L(e,_=28){if(e){const s=(0,a.getPhotoSize)(e,(0,o.isRetina)()?_*window.devicePixelRatio:_);if(s)return(0,r.jsx)(E.VKUIIconContainer,{src:s.url,size:_})}return null}function C(e,_=28){if(e){const s=(0,a.getPhotoSize)(e,(0,o.isRetina)()?_*window.devicePixelRatio:_);if(s)return(0,r.jsx)(b.MaskIcon,{src:s.url,size:_})}return null}function T(e,_){const s=new URLSearchParams({ref:"third_party_profile_buttons",vk_profile_id:String(_)});return`/app${e.id}?${s.toString()}`}function A(e){const _=e.service_description;if(_)return _;const s=e.owner_state;if(s){const _=s.description;if(!(s?.state===n.OwnerStateStateEnumNames.HIDDEN))return _;return K(e)?_:void 0}}function R({careers:e,schools:_}){const s=[];if(e?.length){const _=e.map((e=>e.city_id));s.push(..._)}if(_?.length){const e=_.map((e=>e.city));s.push(...e)}return(0,a.uniqueArray)(s.filter((e=>!!e)))}function I({military:e}){const _=[];if(e?.length){const s=e.map((e=>e.country_id));_.push(...s)}return(0,a.uniqueArray)(_.filter((e=>!!e)))}const F=e=>Array.isArray(e)?e.reduce(((e,_)=>(e[_.id]=_,e)),{}):{},S=e=>{let _=e||"";return _=(0,l.replaceHyperLinks)(_,l.linksReplacer),_=(0,u.replaceMentions)(_),_=(0,c.replaceEmailLinks)(_),_},B=e=>{if(!e)return 0;const _=e.split(".");if(3===_.length){const[e,s,r]=_,t=new Date(`${r}/${s}/${e}`);return(0,d.getUnixTimestamp)(t)}if(2===_.length){const[_,s]=e.split("."),r=new Date(`2000/${s}/${_}`);return(0,d.getUnixTimestamp)(r)}return 0};var v;function U(e,_){if(!(0,a.isNumber)(e))return{};const s=[[31536e3,_?f.getLang("global_years_accusative","raw"):f.getLang("global_age_years","raw"),"YEAR"],[2592e3,_?f.getLang("global_months_accusative","raw"):f.getLang("global_age_months","raw"),"MONTH"],[86400,_?f.getLang("global_days_accusative","raw"):f.getLang("global_age_days","raw"),"DAY"],[3600,_?f.getLang("global_hours_accusative","raw"):f.getLang("global_hours","raw"),"HOUR"],[60,_?f.getLang("global_minutes_accusative","raw"):f.getLang("global_minutes","raw"),"MINUTE"],[1,_?f.getLang("global_seconds_accusative","raw"):f.getLang("global_age_seconds","raw"),"SECOND"]];let r=e;return s.reduce(((e,[_,s,t])=>{const n=Math.floor(r/_),i=(0,f.langNumeric)(n,s);return r%=_,{...e,[t]:n>=1?{count:n,label:i}:void 0}}),{})}function W(e){const _=function(e){const _=[];_[m.OnboardingCardId.PROFILE_PHOTO_ONBOARDING_CARD_ID]={onClick:e.openAvatarUpload},_[m.OnboardingCardId.SEND_POST_ONBOARDING_CARD_ID]={onClick:e=>{const _=document.querySelector("#post_field");e.stopPropagation(),_?.focus()}},_[m.OnboardingCardId.DOWNLOAD_APP_CARD_ID]={onClick:()=>(0,D.showWiki)({w:"show_notification_for_install_app"})};const s=_[e.cardId];if(!s)return!1;return s}({...e});return!1!==_?_:{href:e.url}}function K(e){return(0,O.isVKUserAnonymous)()&&"vk_users_only"===e.no_index}function k(e,_){const s=(0,h.getOwnerUrl)(e);if(_===i.FriendsAddResponseEnumNames.APPROVED){const _=`<a href="${s}">${(0,a.encodeHTMLEntities)((0,a.escape)(e.first_name_gen||""))}</a>`;return f.getLang("global_friend_add_result_msg_are_friends").replace("{user_genetive}",_)}if(_===i.FriendsAddResponseEnumNames.SEND){const _=`<a href="${s}">${(0,a.encodeHTMLEntities)((0,a.escape)(e.first_name_acc||""))}</a>`,r=`<a href="${s}">${(0,a.encodeHTMLEntities)((0,a.escape)(e.first_name||""))}</a>`;let n="";return n=e.can_access_closed?(0,f.langSex)(e.sex||t.BaseSexEnumNames.UNKNOWN,f.getLang("global_friend_add_result_msg_subscribed")).replace("{user_nominative}",r).replace("{user_accusative}",_):f.getLang("global_closed_friend_request_sent_msg"),n.replace("{user_accusative}",_).replace("{user_nominative}",r)}return""}!function(e){e.SECOND="SECOND",e.MINUTE="MINUTE",e.HOUR="HOUR",e.DAY="DAY",e.WEEK="WEEK",e.MONTH="MONTH",e.YEAR="YEAR"}(v||(v={}))}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,loadStylesheet,installedCssChunks;function __webpack_require__(e){var _=__webpack_module_cache__[e];if(void 0!==_)return _.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(s.exports,s,s.exports,__webpack_require__),s.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,_,s,r)=>{if(!_){var t=1/0;for(a=0;a<deferred.length;a++){for(var[_,s,r]=deferred[a],n=!0,i=0;i<_.length;i++)(!1&r||t>=r)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](_[i])))?_.splice(i--,1):(n=!1,r<t&&(t=r));if(n){deferred.splice(a--,1);var o=s();void 0!==o&&(e=o)}}return e}r=r||0;for(var a=deferred.length;a>0&&deferred[a-1][2]>r;a--)deferred[a]=deferred[a-1];deferred[a]=[_,s,r]},__webpack_require__.n=e=>{var _=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(_,{a:_}),_},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,_){if(1&_&&(e=this(e)),8&_)return e;if("object"==typeof e&&e){if(4&_&&e.__esModule)return e;if(16&_&&"function"==typeof e.then)return e}var s=Object.create(null);__webpack_require__.r(s);var r={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var t=2&_&&e;"object"==typeof t&&!~leafPrototypes.indexOf(t);t=getProto(t))Object.getOwnPropertyNames(t).forEach((_=>r[_]=()=>e[_]));return r.default=()=>e,__webpack_require__.d(s,r),s},__webpack_require__.d=(e,_)=>{for(var s in _)__webpack_require__.o(_,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:_[s]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((_,s)=>(__webpack_require__.f[s](e,_),_)),[])),__webpack_require__.u=e=>24817===e?"web/chunks/hls.b496ce21.js":77794===e?"web/chunks/7bdfc282.async.758ca0aa.js":95040===e?"web/chunks/cf5562e5.async.b4aed2d1.js":40530===e?"web/chunks/5ef6139d.async.f064c195.js":69488===e?"web/chunks/a7aba191.async.c36a6a36.js":67498===e?"web/chunks/19b9f4a7.async.9c26c7dc.js":24328===e?"web/chunks/c4004e28.async.ea2a65ee.js":27370===e?"web/chunks/2c9432b5.async.5b90c7cd.js":5157===e?"web/chunks/unauth_action_box.111478de.js":25394===e?"web/chunks/AudioLongtapModal.ab967a4b.js":75980===e?"web/chunks/menu_settings.7bdcde07.js":89334===e?"web/chunks/a228276f.async.a4e26c75.js":40928===e?"web/chunks/fcbd3ef2.async.877aa898.js":9914===e?"web/chunks/52fa6987.async.94be31b8.js":59727===e?"web/chunks/VideoUpload.d33511cc.js":9375===e?"web/chunks/voice_message_player.faac3006.js":28762===e?"web/chunks/speech.3083d7af.js":57468===e?"web/chunks/SilentModeForms.d5a6e099.js":28872===e?"web/chunks/feed-client-nav-skeleton.73bce91a.js":35953===e?"web/chunks/feed-client-nav-async-right-block.f4069a0d.js":20424===e?"web/chunks/37c889f8.async.7581826d.js":45993===e?"web/chunks/e162e048.async.1c6235ad.js":88769===e?"web/chunks/vkcom-kit-dnd.35b2329d.js":3301===e?"web/chunks/AddNewFriendsModal.3b5802fa.js":85059===e?"web/chunks/059ba3af.async.1897b369.js":67724===e?"web/chunks/VideoEditorModal.eb979233.js":22854===e?"web/chunks/PublishClipToVideoModal.dae3ac0f.js":30271===e?"web/chunks/VideoUploadModal.b8d73da8.js":31286===e?"web/chunks/VideoExternalUploadModal.2c5830cb.js":969===e?"web/chunks/0dc980e6.async.f010f601.js":92846===e?"web/chunks/ClipUploadModal.8eff9d1c.js":59240===e?"web/chunks/performance-stats.b497cf49.js":378===e?"web/chunks/79f739a7.async.6dfc0f2b.js":72491===e?"web/chunks/story_blocks.dfab0b41.js":7308===e?"web/chunks/7308.e4292e75.js":1854===e?"chunks/1854.9b4b0c68.js":18254===e?"chunks/"+e+".0ac520ae.js":92398===e?"chunks/"+e+".18cb85f5.js":"web/chunks/videoplayer-interactive.c61a72cb.js",__webpack_require__.miniCssF=e=>({5157:1,59727:1}[e]?"web/chunks/b1037836.css":25394===e?"web/chunks/6a66a172.css":75980===e?"web/chunks/5bbee2c9.css":57468===e?"web/chunks/122e7a6e.css":67724===e?"web/chunks/3c048aa6.css":22854===e?"web/chunks/70c35bc4.css":{30271:1,31286:1}[e]?"web/chunks/f89919fd.css":92846===e?"web/chunks/83ceb5be.css":72491===e?"web/chunks/6b53e0ac.css":void 0),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,_)=>Object.prototype.hasOwnProperty.call(e,_),inProgress={},__webpack_require__.l=(e,_,s,r)=>{if(inProgress[e])inProgress[e].push(_);else{var t,n;if(void 0!==s)for(var i=document.getElementsByTagName("script"),o=0;o<i.length;o++){var a=i[o];if(a.getAttribute("src")==e||a.getAttribute("data-webpack")=="vk:"+s){t=a;break}}t||(n=!0,(t=document.createElement("script")).charset="utf-8",t.timeout=120,__webpack_require__.nc&&t.setAttribute("nonce",__webpack_require__.nc),t.setAttribute("data-webpack","vk:"+s),t.src=e),inProgress[e]=[_];var d=(_,s)=>{t.onerror=t.onload=null,clearTimeout(l);var r=inProgress[e];if(delete inProgress[e],t.parentNode&&t.parentNode.removeChild(t),r&&r.forEach((e=>e(s))),_)return _(s)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:t}),12e4);t.onerror=d.bind(null,t.onerror),t.onload=d.bind(null,t.onload),n&&document.head.appendChild(t)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/dist/",loadStylesheet=e=>new Promise(((_,s)=>{var r=__webpack_require__.miniCssF(e),t=__webpack_require__.p+r;if(((e,_)=>{for(var s=document.getElementsByTagName("link"),r=0;r<s.length;r++){var t=(i=s[r]).getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(t===e||t===_))return i}var n=document.getElementsByTagName("style");for(r=0;r<n.length;r++){var i;if((t=(i=n[r]).getAttribute("data-href"))===e||t===_)return i}})(r,t))return _();((e,_,s,r)=>{var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.onerror=t.onload=n=>{if(t.onerror=t.onload=null,"load"===n.type)s();else{var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.href||_,a=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");a.code="CSS_CHUNK_LOAD_FAILED",a.type=i,a.request=o,t.parentNode.removeChild(t),r(a)}},t.href=_,document.head.appendChild(t)})(e,t,_,s)})),installedCssChunks={69074:0},__webpack_require__.f.miniCss=(e,_)=>{installedCssChunks[e]?_.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{5157:1,22854:1,25394:1,30271:1,31286:1,57468:1,59727:1,67724:1,72491:1,75980:1,92846:1}[e]&&_.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(_=>{throw delete installedCssChunks[e],_})))},(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={69074:0};__webpack_require__.f.j=(_,s)=>{var r=__webpack_require__.o(e,_)?e[_]:void 0;if(0!==r)if(r)s.push(r[2]);else{var t=new Promise(((s,t)=>r=e[_]=[s,t]));s.push(r[2]=t);var n=__webpack_require__.p+__webpack_require__.u(_),i=new Error;__webpack_require__.l(n,(s=>{if(__webpack_require__.o(e,_)&&(0!==(r=e[_])&&(e[_]=void 0),r)){var t=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;i.message="Loading chunk "+_+" failed.\n("+t+": "+n+")",i.name="ChunkLoadError",i.type=t,i.request=n,r[1](i)}}),"chunk-"+_,_)}},__webpack_require__.O.j=_=>0===e[_];var _=(_,s)=>{var r,t,[n,i,o]=s,a=0;if(n.some((_=>0!==e[_]))){for(r in i)__webpack_require__.o(i,r)&&(__webpack_require__.m[r]=i[r]);if(o)var d=o(__webpack_require__)}for(_&&_(s);a<n.length;a++)t=n[a],__webpack_require__.o(e,t)&&e[t]&&e[t][0](),e[t]=0;return __webpack_require__.O(d)},s=self.webpackChunkvkweb=self.webpackChunkvkweb||[];s.forEach(_.bind(null,0)),s.push=_.bind(null,s.push.bind(s))})();var __webpack_exports__=__webpack_require__.O(void 0,[213,83737,2067,20795,57451,5038,95167],(()=>__webpack_require__(986018)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();